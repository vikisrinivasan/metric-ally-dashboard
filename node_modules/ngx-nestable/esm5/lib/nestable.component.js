/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { ChangeDetectionStrategy, ChangeDetectorRef, Component, ElementRef, EventEmitter, Input, NgZone, Output, Renderer2, ViewContainerRef, ViewEncapsulation } from '@angular/core';
import * as helper from './nestable.helper';
import { defaultSettings, DRAG_START, EXPAND_COLLAPSE, mouse, REGISTER_HANDLE } from './nestable.constant';
/** @type {?} */
import * as ɵngcc0 from '@angular/core';
import * as ɵngcc1 from '@angular/common';

function NestableComponent_ng_container_0_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainer(0);
} }
function NestableComponent_ng_template_1_li_1_ng_container_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainer(0);
} }
function NestableComponent_ng_template_1_li_1_ng_container_2_ng_container_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainer(0);
} }
var _c0 = function (a0, a1) { return { nestable: a0, depth: a1 }; };
function NestableComponent_ng_template_1_li_1_ng_container_2_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵtemplate(1, NestableComponent_ng_template_1_li_1_ng_container_2_ng_container_1_Template, 1, 0, "ng-container", 0);
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    var item_r8 = ɵngcc0.ɵɵnextContext().$implicit;
    var depth_r6 = ɵngcc0.ɵɵnextContext().depth;
    ɵngcc0.ɵɵnextContext();
    var _r1 = ɵngcc0.ɵɵreference(2);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngTemplateOutlet", _r1)("ngTemplateOutletContext", ɵngcc0.ɵɵpureFunction2(2, _c0, item_r8.children, depth_r6 + 1));
} }
var _c1 = function (a0, a1, a2) { return { nestable: a0, item: a1, depth: a2 }; };
function NestableComponent_ng_template_1_li_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "li", 4);
    ɵngcc0.ɵɵtemplate(1, NestableComponent_ng_template_1_li_1_ng_container_1_Template, 1, 0, "ng-container", 0);
    ɵngcc0.ɵɵtemplate(2, NestableComponent_ng_template_1_li_1_ng_container_2_Template, 2, 5, "ng-container", 5);
    ɵngcc0.ɵɵelement(3, "ul");
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    var item_r8 = ctx.$implicit;
    var ctx_r14 = ɵngcc0.ɵɵnextContext();
    var nestable_r5 = ctx_r14.nestable;
    var depth_r6 = ctx_r14.depth;
    var ctx_r7 = ɵngcc0.ɵɵnextContext();
    var _r3 = ɵngcc0.ɵɵreference(4);
    ɵngcc0.ɵɵclassMap(ctx_r7.options.itemClass);
    ɵngcc0.ɵɵproperty("id", item_r8.$$id);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngTemplateOutlet", _r3)("ngTemplateOutletContext", ɵngcc0.ɵɵpureFunction3(10, _c1, nestable_r5, item_r8, depth_r6));
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", item_r8.children && item_r8.$$expanded);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵclassMap(ctx_r7.options.listClass);
    ɵngcc0.ɵɵstyleProp("padding-left", ctx_r7.options.threshold, "px");
} }
function NestableComponent_ng_template_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "ul");
    ɵngcc0.ɵɵtemplate(1, NestableComponent_ng_template_1_li_1_Template, 4, 14, "li", 3);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    var nestable_r5 = ctx.nestable;
    var depth_r6 = ctx.depth;
    var ctx_r2 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵclassMap(ctx_r2.options.listClass);
    ɵngcc0.ɵɵstyleProp("padding-left", depth_r6 ? ctx_r2.options.threshold : 0, "px");
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngForOf", nestable_r5);
} }
function NestableComponent_ng_template_3_ng_container_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainer(0);
} }
var _c2 = function (a0, a1) { return { item: a0, parentList: a1 }; };
var _c3 = function (a0, a1) { return { $implicit: a0, depth: a1 }; };
function NestableComponent_ng_template_3_Template(rf, ctx) { if (rf & 1) {
    var _r20 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementStart(0, "div", 6);
    ɵngcc0.ɵɵlistener("mousedown", function NestableComponent_ng_template_3_Template_div_mousedown_0_listener($event) { ɵngcc0.ɵɵrestoreView(_r20); var item_r16 = ctx.item; var parentList_r15 = ctx.nestable; var ctx_r19 = ɵngcc0.ɵɵnextContext(); return ctx_r19.dragStartFromItem($event, item_r16, parentList_r15); });
    ɵngcc0.ɵɵtemplate(1, NestableComponent_ng_template_3_ng_container_1_Template, 1, 0, "ng-container", 0);
    ɵngcc0.ɵɵelement(2, "div", 7);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    var parentList_r15 = ctx.nestable;
    var item_r16 = ctx.item;
    var depth_r17 = ctx.depth;
    var ctx_r4 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngTemplateOutlet", ctx_r4.template)("ngTemplateOutletContext", ɵngcc0.ɵɵpureFunction2(5, _c3, ɵngcc0.ɵɵpureFunction2(2, _c2, item_r16, parentList_r15), depth_r17));
} }
var _c4 = function (a0) { return { nestable: a0, depth: 0 }; };
var PX = 'px';
var ɵ0 = /**
 * @return {?}
 */
function () {
    /** @type {?} */
    var el = document.createElement('div');
    /** @type {?} */
    var docEl = document.documentElement;
    if (!('pointerEvents' in el.style)) {
        return false;
    }
    el.style.pointerEvents = 'auto';
    el.style.pointerEvents = 'x';
    docEl.appendChild(el);
    /** @type {?} */
    var supports = window.getComputedStyle &&
        window.getComputedStyle(el, '').pointerEvents === 'auto';
    docEl.removeChild(el);
    return !!supports;
};
/** @type {?} */
var hasPointerEvents = ((ɵ0))();
var NestableComponent = /** @class */ (function () {
    function NestableComponent(ref, renderer, el, zone) {
        this.ref = ref;
        this.renderer = renderer;
        this.el = el;
        this.zone = zone;
        this.listChange = new EventEmitter();
        this.drop = new EventEmitter();
        this.drag = new EventEmitter();
        this.disclosure = new EventEmitter();
        this.options = defaultSettings;
        this.disableDrag = false;
        this.dragRootEl = null;
        this.dragEl = null;
        this.dragModel = null;
        this.moving = false;
        /**
         * Dragged element contains children, and those children contain other children and so on...
         * This property gives you the number of generations contained within the dragging item.
         */
        this.dragDepth = 0;
        /**
         * The depth of dragging item relative to element root (ngx-nestable)
         */
        this.relativeDepth = 0;
        this.hasNewRoot = false;
        this.pointEl = null;
        this.items = [];
        this._componentActive = false;
        this._mouse = Object.assign({}, mouse);
        this._list = [];
        this._itemId = 0;
        this._registerHandleDirective = false;
    }
    Object.defineProperty(NestableComponent.prototype, "list", {
        get: /**
         * @return {?}
         */
        function () {
            return this._list;
        },
        set: /**
         * @param {?} list
         * @return {?}
         */
        function (list) {
            this._list = list;
            this._generateItemIds();
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    NestableComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var e_1, _a;
        // set/extend default options
        this._componentActive = true;
        /** @type {?} */
        var optionKeys = Object.keys(defaultSettings);
        try {
            for (var optionKeys_1 = tslib_1.__values(optionKeys), optionKeys_1_1 = optionKeys_1.next(); !optionKeys_1_1.done; optionKeys_1_1 = optionKeys_1.next()) {
                var key = optionKeys_1_1.value;
                if (typeof this.options[key] === 'undefined') {
                    this.options[key] = defaultSettings[key];
                }
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (optionKeys_1_1 && !optionKeys_1_1.done && (_a = optionKeys_1.return)) _a.call(optionKeys_1);
            }
            finally { if (e_1) throw e_1.error; }
        }
        this._generateItemIds();
        this._generateItemExpanded();
        this._createHandleListener();
    };
    /**
     * @return {?}
     */
    NestableComponent.prototype.ngOnDestroy = /**
     * @return {?}
     */
    function () { };
    /**
     * @private
     * @return {?}
     */
    NestableComponent.prototype._generateItemIds = /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        helper._traverseChildren(this._list, (/**
         * @param {?} item
         * @return {?}
         */
        function (item) {
            item['$$id'] = _this._itemId++;
        }));
    };
    /**
     * @private
     * @return {?}
     */
    NestableComponent.prototype._generateItemExpanded = /**
     * @private
     * @return {?}
     */
    function () {
        helper._traverseChildren(this._list, (/**
         * @param {?} item
         * @return {?}
         */
        function (item) {
            if (typeof item.expanded === 'undefined') {
                item['$$expanded'] = true;
            }
            else {
                item['$$expanded'] = item.expanded;
            }
        }));
    };
    /**
     * @private
     * @return {?}
     */
    NestableComponent.prototype._createHandleListener = /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        this.renderer.listen(this.el.nativeElement, REGISTER_HANDLE, (/**
         * @return {?}
         */
        function () {
            _this._registerHandleDirective = true;
        }));
        this.renderer.listen(this.el.nativeElement, DRAG_START, (/**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            _this.dragStart(data.detail.event, data.detail.param.item, data.detail.param.parentList);
        }));
        this.renderer.listen(this.el.nativeElement, EXPAND_COLLAPSE, (/**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            _this.disclosure.emit({
                item: data.detail.item,
                expanded: data.detail.item['$$expanded']
            });
        }));
    };
    /**
     * @private
     * @param {?} event
     * @param {?} dragItem
     * @return {?}
     */
    NestableComponent.prototype._createDragClone = /**
     * @private
     * @param {?} event
     * @param {?} dragItem
     * @return {?}
     */
    function (event, dragItem) {
        this._mouseStart(event, dragItem);
        if (!this._registerHandleDirective) {
            this._mouse.offsetY = dragItem.nextElementSibling
                ? dragItem.nextElementSibling.clientHeight / 2
                : dragItem.clientHeight / 2;
        }
        // create drag clone
        this.dragEl = document.createElement(this.options.listNodeName);
        document.body.appendChild(this.dragEl);
        this.renderer.addClass(this.dragEl, this.options.dragClass);
        // add drag clone to body and set css
        this.renderer.setStyle(this.dragEl, 'left', event.pageX - this._mouse.offsetX + PX);
        this.renderer.setStyle(this.dragEl, 'top', event.pageY - this._mouse.offsetY + PX);
        this.renderer.setStyle(this.dragEl, 'position', 'absolute');
        this.renderer.setStyle(this.dragEl, 'z-index', 9999);
        this.renderer.setStyle(this.dragEl, 'pointer-events', 'none');
    };
    /**
     * @private
     * @param {?} event
     * @param {?} dragItem
     * @return {?}
     */
    NestableComponent.prototype._createPlaceholder = /**
     * @private
     * @param {?} event
     * @param {?} dragItem
     * @return {?}
     */
    function (event, dragItem) {
        this._placeholder = document.createElement('div');
        this._placeholder.classList.add(this.options.placeClass);
        helper._insertAfter(this._placeholder, dragItem);
        dragItem.parentNode.removeChild(dragItem);
        this.dragEl.appendChild(dragItem);
        this.dragRootEl = dragItem;
    };
    /**
     * Sets depth proerties (relative and drag)
     */
    /**
     * Sets depth proerties (relative and drag)
     * @private
     * @return {?}
     */
    NestableComponent.prototype._calculateDepth = /**
     * Sets depth proerties (relative and drag)
     * @private
     * @return {?}
     */
    function () {
        // total depth of dragging item
        /** @type {?} */
        var depth;
        /** @type {?} */
        var items = this.dragEl.querySelectorAll(this.options.itemNodeName);
        for (var i = 0; i < items.length; i++) {
            depth = helper._getParents(items[i], this.dragEl).length;
            if (depth > this.dragDepth) {
                this.dragDepth = depth;
            }
        }
        // depth relative to root
        this.relativeDepth = helper._getParents(this._placeholder, this.el.nativeElement.querySelector(this.options.listNodeName)).length;
    };
    /**
     * @private
     * @param {?} event
     * @param {?} dragItem
     * @return {?}
     */
    NestableComponent.prototype._mouseStart = /**
     * @private
     * @param {?} event
     * @param {?} dragItem
     * @return {?}
     */
    function (event, dragItem) {
        this._mouse.offsetX = event.pageX - helper._offset(dragItem).left;
        this._mouse.offsetY = event.pageY - helper._offset(dragItem).top;
        this._mouse.startX = this._mouse.lastX = event.pageX;
        this._mouse.startY = this._mouse.lastY = event.pageY;
    };
    /**
     * @private
     * @param {?} event
     * @return {?}
     */
    NestableComponent.prototype._mouseUpdate = /**
     * @private
     * @param {?} event
     * @return {?}
     */
    function (event) {
        // mouse position last events
        this._mouse.lastX = this._mouse.nowX;
        this._mouse.lastY = this._mouse.nowY;
        // mouse position this events
        this._mouse.nowX = event.pageX;
        this._mouse.nowY = event.pageY;
        // distance mouse moved between events
        this._mouse.distX = this._mouse.nowX - this._mouse.lastX;
        this._mouse.distY = this._mouse.nowY - this._mouse.lastY;
        // direction mouse was moving
        this._mouse.lastDirX = this._mouse.dirX;
        this._mouse.lastDirY = this._mouse.dirY;
        // direction mouse is now moving (on both axis)
        this._mouse.dirX =
            this._mouse.distX === 0 ? 0 : this._mouse.distX > 0 ? 1 : -1;
        this._mouse.dirY =
            this._mouse.distY === 0 ? 0 : this._mouse.distY > 0 ? 1 : -1;
    };
    /**
     * @private
     * @return {?}
     */
    NestableComponent.prototype._showMasks = /**
     * @private
     * @return {?}
     */
    function () {
        /** @type {?} */
        var masks = this.el.nativeElement.getElementsByClassName('nestable-item-mask');
        for (var i = 0; i < masks.length; i++) {
            masks[i].style.display = 'block';
        }
    };
    /**
     * @private
     * @return {?}
     */
    NestableComponent.prototype._hideMasks = /**
     * @private
     * @return {?}
     */
    function () {
        /** @type {?} */
        var masks = this.el.nativeElement.getElementsByClassName('nestable-item-mask');
        for (var i = 0; i < masks.length; i++) {
            masks[i].style.display = 'none';
        }
    };
    /**
     * calc mouse traverse distance on axis
     * @param m - mouse
     */
    /**
     * calc mouse traverse distance on axis
     * @private
     * @param {?} m - mouse
     * @return {?}
     */
    NestableComponent.prototype._calcMouseDistance = /**
     * calc mouse traverse distance on axis
     * @private
     * @param {?} m - mouse
     * @return {?}
     */
    function (m) {
        m.distAxX += Math.abs(m.distX);
        if (m.dirX !== 0 && m.dirX !== m.lastDirX) {
            m.distAxX = 0;
        }
        m.distAxY += Math.abs(m.distY);
        if (m.dirY !== 0 && m.dirY !== m.lastDirY) {
            m.distAxY = 0;
        }
    };
    /**
     * @private
     * @param {?} event
     * @return {?}
     */
    NestableComponent.prototype._move = /**
     * @private
     * @param {?} event
     * @return {?}
     */
    function (event) {
        /** @type {?} */
        var depth;
        /** @type {?} */
        var list;
        /** @type {?} */
        var dragRect = this.dragEl.getBoundingClientRect();
        this.renderer.setStyle(this.dragEl, 'left', event.pageX - this._mouse.offsetX + PX);
        this.renderer.setStyle(this.dragEl, 'top', event.pageY - this._mouse.offsetY + PX);
        this._mouseUpdate(event);
        // axis mouse is now moving on
        /** @type {?} */
        var newAx = Math.abs(this._mouse.distX) > Math.abs(this._mouse.distY) ? 1 : 0;
        // do nothing on first move
        if (!this._mouse.moving) {
            this._mouse.dirAx = newAx;
            this._mouse.moving = 1;
            return;
        }
        // calc distance moved on this axis (and direction)
        if (this._mouse.dirAx !== newAx) {
            this._mouse.distAxX = 0;
            this._mouse.distAxY = 0;
        }
        else {
            this._calcMouseDistance(this._mouse);
        }
        this._mouse.dirAx = newAx;
        // find list item under cursor
        if (!hasPointerEvents) {
            this.dragEl.style.visibility = 'hidden';
        }
        /** @type {?} */
        var pointEl = document.elementFromPoint(event.pageX - document.body.scrollLeft, event.pageY - (window.pageYOffset || document.documentElement.scrollTop));
        if (!hasPointerEvents) {
            this.dragEl.style.visibility = 'visible';
        }
        if (pointEl &&
            (pointEl.classList.contains('nestable-item-mask') ||
                pointEl.classList.contains(this.options.placeClass))) {
            this.pointEl = pointEl.parentElement.parentElement;
        }
        else {
            return;
        }
        /**
         * move horizontal
         */
        if (!this.options.fixedDepth &&
            this._mouse.dirAx &&
            this._mouse.distAxX >= this.options.threshold) {
            // reset move distance on x-axis for new phase
            this._mouse.distAxX = 0;
            /** @type {?} */
            var previous = this._placeholder.previousElementSibling;
            // increase horizontal level if previous sibling exists, is not collapsed, and can have children
            if (this._mouse.distX > 0 && previous) {
                list = previous.querySelectorAll(this.options.listNodeName);
                list = list[list.length - 1];
                // check if depth limit has reached
                depth = helper._getParents(this._placeholder, this.el.nativeElement.querySelector(this.options.listNodeName)).length;
                if (depth + this.dragDepth <= this.options.maxDepth) {
                    // create new sub-level if one doesn't exist
                    if (!list) {
                        list = document.createElement(this.options.listNodeName);
                        list.style.paddingLeft = this.options.threshold + PX;
                        list.appendChild(this._placeholder);
                        previous.appendChild(list);
                        // this.setParent(previous);
                    }
                    else {
                        // else append to next level up
                        list = previous.querySelector(":scope > " + this.options.listNodeName);
                        list.appendChild(this._placeholder);
                    }
                }
            }
            // decrease horizontal level
            if (this._mouse.distX < 0) {
                // we can't decrease a level if an item preceeds the current one
                /** @type {?} */
                var next = document.querySelector("." + this.options.placeClass + " + " + this.options.itemNodeName);
                /** @type {?} */
                var parentElement = this._placeholder.parentElement;
                if (!next && parentElement) {
                    /** @type {?} */
                    var closestItem = helper._closest(this._placeholder, this.options.itemNodeName);
                    if (closestItem) {
                        parentElement.removeChild(this._placeholder);
                        helper._insertAfter(this._placeholder, closestItem);
                    }
                }
            }
        }
        if (!pointEl.classList.contains('nestable-item-mask')) {
            return;
        }
        // find root list of item under cursor
        /** @type {?} */
        var pointElRoot = helper._closest(this.pointEl, "." + this.options.rootClass);
        /** @type {?} */
        var isNewRoot = pointElRoot
            ? this.dragRootEl.dataset['nestable-id'] !==
                pointElRoot.dataset['nestable-id']
            : false;
        /**
         * move vertical
         */
        if (!this._mouse.dirAx || isNewRoot) {
            // check if groups match if dragging over new root
            if (isNewRoot &&
                this.options.group !== pointElRoot.dataset['nestable-group']) {
                return;
            }
            // check depth limit
            depth =
                this.dragDepth -
                    1 +
                    helper._getParents(this.pointEl, this.el.nativeElement.querySelector(this.options.listNodeName)).length;
            if (depth > this.options.maxDepth) {
                return;
            }
            /** @type {?} */
            var before = event.pageY <
                helper._offset(this.pointEl).top + this.pointEl.clientHeight / 2;
            /** @type {?} */
            var placeholderParent = this._placeholder.parentNode;
            // get point element depth
            /** @type {?} */
            var pointRelativeDepth = void 0;
            pointRelativeDepth = helper._getParents(this.pointEl, this.el.nativeElement.querySelector(this.options.listNodeName)).length;
            if (this.options.fixedDepth) {
                if (pointRelativeDepth === this.relativeDepth - 1) {
                    /** @type {?} */
                    var childList = this.pointEl.querySelector(this.options.listNodeName);
                    if (!childList.children.length) {
                        childList.appendChild(this._placeholder);
                    }
                }
                else if (pointRelativeDepth === this.relativeDepth) {
                    if (before) {
                        this.pointEl.parentElement.insertBefore(this._placeholder, this.pointEl);
                    }
                    else {
                        helper._insertAfter(this._placeholder, this.pointEl);
                    }
                    if (Array.prototype.indexOf.call(this.pointEl.parentElement.children, this.pointEl) ===
                        this.pointEl.parentElement.children.length - 1) {
                        helper._insertAfter(this._placeholder, this.pointEl);
                    }
                }
            }
            else if (before) {
                this.pointEl.parentElement.insertBefore(this._placeholder, this.pointEl);
            }
            else {
                helper._insertAfter(this._placeholder, this.pointEl);
            }
        }
    };
    /**
     * @return {?}
     */
    NestableComponent.prototype.reset = /**
     * @return {?}
     */
    function () {
        var e_2, _a;
        /** @type {?} */
        var keys = Object.keys(this._mouse);
        try {
            for (var keys_1 = tslib_1.__values(keys), keys_1_1 = keys_1.next(); !keys_1_1.done; keys_1_1 = keys_1.next()) {
                var key = keys_1_1.value;
                this._mouse[key] = 0;
            }
        }
        catch (e_2_1) { e_2 = { error: e_2_1 }; }
        finally {
            try {
                if (keys_1_1 && !keys_1_1.done && (_a = keys_1.return)) _a.call(keys_1);
            }
            finally { if (e_2) throw e_2.error; }
        }
        this._itemId = 0;
        this.moving = false;
        this.dragEl = null;
        this.dragRootEl = null;
        this.dragDepth = 0;
        this.relativeDepth = 0;
        this.hasNewRoot = false;
        this.pointEl = null;
    };
    /**
     * @param {?} event
     * @param {?} item
     * @param {?} parentList
     * @return {?}
     */
    NestableComponent.prototype.dragStartFromItem = /**
     * @param {?} event
     * @param {?} item
     * @param {?} parentList
     * @return {?}
     */
    function (event, item, parentList) {
        if (!this._registerHandleDirective) {
            this.dragStart(event, item, parentList);
        }
    };
    /**
     * @private
     * @param {?} event
     * @param {?} item
     * @param {?} parentList
     * @return {?}
     */
    NestableComponent.prototype.dragStart = /**
     * @private
     * @param {?} event
     * @param {?} item
     * @param {?} parentList
     * @return {?}
     */
    function (event, item, parentList) {
        this._oldListLength = this.list.length;
        if (!this.options.disableDrag) {
            event.stopPropagation();
            event.preventDefault();
            if (event.originalEvent) {
                event = event.originalEvent;
            }
            // allow only first mouse button
            if (event.type.indexOf('mouse') === 0) {
                if (event.button !== 0) {
                    return;
                }
            }
            else {
                if (event.touches.length !== 1) {
                    return;
                }
            }
            this.ref.detach();
            this._dragIndex = parentList.indexOf(item);
            this.dragModel = parentList.splice(parentList.indexOf(item), 1)[0];
            /** @type {?} */
            var dragItem = helper._closest(event.target, this.options.itemNodeName);
            if (dragItem === null) {
                return;
            }
            this._parentDragId = Number.parseInt(dragItem.parentElement.parentElement.id);
            /** @type {?} */
            var dragRect = dragItem.getBoundingClientRect();
            this._showMasks();
            this._createDragClone(event, dragItem);
            this.renderer.setStyle(this.dragEl, 'width', dragRect.width + PX);
            this._createPlaceholder(event, dragItem);
            this.renderer.setStyle(this._placeholder, 'height', dragRect.height + PX);
            this._calculateDepth();
            this.drag.emit({
                originalEvent: event,
                item: item
            });
            this._cancelMouseup = this.renderer.listen(document, 'mouseup', this.dragStop.bind(this));
            this._cancelMousemove = this.renderer.listen(document, 'mousemove', this.dragMove.bind(this));
        }
    };
    /**
     * @param {?} event
     * @return {?}
     */
    NestableComponent.prototype.dragStop = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        this._cancelMouseup();
        this._cancelMousemove();
        this._hideMasks();
        if (this.dragEl) {
            /** @type {?} */
            var draggedId = Number.parseInt(this.dragEl.firstElementChild.id);
            /** @type {?} */
            var placeholderContainer = helper._closest(this._placeholder, this.options.itemNodeName);
            /** @type {?} */
            var changedElementPosition = this._dragIndex !==
                Array.prototype.indexOf.call(this._placeholder.parentElement.children, this._placeholder);
            /** @type {?} */
            var index = Array.prototype.indexOf.call(this._placeholder.parentElement.children, this._placeholder);
            if ((this._dragIndex === index) && (this._oldListLength === this.list.length)) {
                changedElementPosition = true;
            }
            // placeholder in root
            if (placeholderContainer === null) {
                this.list.splice(Array.prototype.indexOf.call(this._placeholder.parentElement.children, this._placeholder), 0, tslib_1.__assign({}, this.dragModel));
            }
            else {
                // palceholder nested
                placeholderContainer = helper._findObjectInTree(this.list, Number.parseInt(placeholderContainer.id));
                if (!placeholderContainer.children) {
                    placeholderContainer.children = [];
                    placeholderContainer.children.push(tslib_1.__assign({}, this.dragModel));
                }
                else {
                    placeholderContainer.children.splice(Array.prototype.indexOf.call(this._placeholder.parentElement.children, this._placeholder), 0, tslib_1.__assign({}, this.dragModel));
                }
                if (index === this._dragIndex) {
                    changedElementPosition = false;
                }
                if (!changedElementPosition) {
                    changedElementPosition =
                        placeholderContainer['$$id'] !== this._parentDragId;
                }
            }
            this._placeholder.parentElement.removeChild(this._placeholder);
            this.dragEl.parentNode.removeChild(this.dragEl);
            this.dragEl.remove();
            this.reset();
            this.listChange.emit(this.list);
            this.drop.emit({
                originalEvent: event,
                destination: placeholderContainer,
                item: this.dragModel,
                changedElementPosition: changedElementPosition
            });
            this.ref.reattach();
        }
    };
    /**
     * @param {?} event
     * @return {?}
     */
    NestableComponent.prototype.dragMove = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        if (this.dragEl) {
            event.preventDefault();
            if (event.originalEvent) {
                event = event.originalEvent;
            }
            this._move(event.type.indexOf('mouse') === 0 ? event : event.touches[0]);
        }
    };
    /**
     * @return {?}
     */
    NestableComponent.prototype.expandAll = /**
     * @return {?}
     */
    function () {
        helper._traverseChildren(this._list, (/**
         * @param {?} item
         * @return {?}
         */
        function (item) {
            item['$$expanded'] = true;
        }));
        this.ref.markForCheck();
    };
    /**
     * @return {?}
     */
    NestableComponent.prototype.collapseAll = /**
     * @return {?}
     */
    function () {
        helper._traverseChildren(this._list, (/**
         * @param {?} item
         * @return {?}
         */
        function (item) {
            item['$$expanded'] = false;
        }));
        this.ref.markForCheck();
    };
    /** @nocollapse */
    NestableComponent.ctorParameters = function () { return [
        { type: ChangeDetectorRef },
        { type: Renderer2 },
        { type: ElementRef },
        { type: NgZone }
    ]; };
    NestableComponent.propDecorators = {
        listChange: [{ type: Output }],
        drop: [{ type: Output }],
        drag: [{ type: Output }],
        disclosure: [{ type: Output }],
        template: [{ type: Input }],
        options: [{ type: Input }],
        disableDrag: [{ type: Input }],
        list: [{ type: Input }]
    };
NestableComponent.ɵfac = function NestableComponent_Factory(t) { return new (t || NestableComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ChangeDetectorRef), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.Renderer2), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ElementRef), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.NgZone)); };
NestableComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: NestableComponent, selectors: [["ngx-nestable"]], inputs: { options: "options", disableDrag: "disableDrag", list: "list", template: "template" }, outputs: { listChange: "listChange", drop: "drop", drag: "drag", disclosure: "disclosure" }, decls: 5, vars: 4, consts: [[4, "ngTemplateOutlet", "ngTemplateOutletContext"], ["nestableList", ""], ["nestableItem", ""], [3, "class", "id", 4, "ngFor", "ngForOf"], [3, "id"], [4, "ngIf"], [1, "nestable-item-container", "mat-list-item", 3, "mousedown"], [1, "nestable-item-mask"]], template: function NestableComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵtemplate(0, NestableComponent_ng_container_0_Template, 1, 0, "ng-container", 0);
        ɵngcc0.ɵɵtemplate(1, NestableComponent_ng_template_1_Template, 2, 5, "ng-template", null, 1, ɵngcc0.ɵɵtemplateRefExtractor);
        ɵngcc0.ɵɵtemplate(3, NestableComponent_ng_template_3_Template, 3, 8, "ng-template", null, 2, ɵngcc0.ɵɵtemplateRefExtractor);
    } if (rf & 2) {
        var _r1 = ɵngcc0.ɵɵreference(2);
        ɵngcc0.ɵɵproperty("ngTemplateOutlet", _r1)("ngTemplateOutletContext", ɵngcc0.ɵɵpureFunction1(2, _c4, ctx.list));
    } }, directives: [ɵngcc1.NgTemplateOutlet, ɵngcc1.NgForOf, ɵngcc1.NgIf], styles: ["@import url(https://fonts.googleapis.com/css?family=Roboto);ul .dd-placeholder{margin:5px 0;padding:0;min-height:30px;background:#f2fbff;border:1px dashed #b6bcbf;box-sizing:border-box}ul li .nestable-item-mask{display:none;position:absolute;top:0;bottom:0;right:0;left:0;z-index:9998}ul li .nestable-expand-button{display:block;position:relative;cursor:pointer;float:left;width:25px;height:14px;padding:0;white-space:nowrap;overflow:hidden;border:0;background:0 0;font-size:18px;line-height:1;text-align:center;font-weight:700;outline:0}ul li .nestable-item-container{position:relative;display:flex;flex-direction:row;align-items:center;color:rgba(0,0,0,.87);min-height:32px;font-size:16px;font-family:Roboto,sans-serif;cursor:pointer;outline:0;margin-bottom:2px;padding-left:8px}ul li .nestable-item-container:hover{background:rgba(0,0,0,.04)}ol,ul{list-style:none}"], encapsulation: 2, changeDetection: 0 });
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(NestableComponent, [{
        type: Component,
        args: [{
                selector: 'ngx-nestable',
                template: "<ng-container *ngTemplateOutlet=\"nestableList; context:{nestable: list, depth: 0}\">\n</ng-container>\n\n<ng-template #nestableList let-nestable=\"nestable\" let-depth=\"depth\">\n    <ul [style.padding-left.px]=\"depth ? options.threshold : 0\"\n        [class]=\"options.listClass\">\n        <li [class]=\"options.itemClass\" [id]=\"item.$$id\" *ngFor=\"let item of nestable\">\n\n            <ng-container *ngTemplateOutlet=\"nestableItem; context:{nestable: nestable, item: item, depth: depth}\">\n            </ng-container>\n\n            <ng-container *ngIf=\"item.children && item.$$expanded\">\n                <ng-container *ngTemplateOutlet=\"nestableList; context:{nestable: item.children, depth: depth + 1}\">\n                </ng-container>\n            </ng-container>\n\n            <ul [class]=\"options.listClass\" [style.padding-left.px]=\"options.threshold\"></ul>\n        </li>\n    </ul>\n</ng-template>\n\n<ng-template #nestableItem let-parentList=\"nestable\" let-item=\"item\" let-depth=\"depth\">\n    <div class=\"nestable-item-container mat-list-item\" (mousedown)=\"dragStartFromItem($event, item, parentList)\">\n        <ng-container\n            *ngTemplateOutlet=\"template; context:{$implicit: {item: item, parentList: parentList}, depth: depth}\">\n        </ng-container>\n\n        <div class=\"nestable-item-mask\"></div>\n    </div>\n</ng-template>\n",
                encapsulation: ViewEncapsulation.None,
                changeDetection: ChangeDetectionStrategy.OnPush,
                styles: ["@import url(https://fonts.googleapis.com/css?family=Roboto);ul .dd-placeholder{margin:5px 0;padding:0;min-height:30px;background:#f2fbff;border:1px dashed #b6bcbf;box-sizing:border-box}ul li .nestable-item-mask{display:none;position:absolute;top:0;bottom:0;right:0;left:0;z-index:9998}ul li .nestable-expand-button{display:block;position:relative;cursor:pointer;float:left;width:25px;height:14px;padding:0;white-space:nowrap;overflow:hidden;border:0;background:0 0;font-size:18px;line-height:1;text-align:center;font-weight:700;outline:0}ul li .nestable-item-container{position:relative;display:flex;flex-direction:row;align-items:center;color:rgba(0,0,0,.87);min-height:32px;font-size:16px;font-family:Roboto,sans-serif;cursor:pointer;outline:0;margin-bottom:2px;padding-left:8px}ul li .nestable-item-container:hover{background:rgba(0,0,0,.04)}ol,ul{list-style:none}"]
            }]
    }], function () { return [{ type: ɵngcc0.ChangeDetectorRef }, { type: ɵngcc0.Renderer2 }, { type: ɵngcc0.ElementRef }, { type: ɵngcc0.NgZone }]; }, { listChange: [{
            type: Output
        }], drop: [{
            type: Output
        }], drag: [{
            type: Output
        }], disclosure: [{
            type: Output
        }], options: [{
            type: Input
        }], disableDrag: [{
            type: Input
        }], list: [{
            type: Input
        }], template: [{
            type: Input
        }] }); })();
    return NestableComponent;
}());
export { NestableComponent };
if (false) {
    /** @type {?} */
    NestableComponent.prototype.listChange;
    /** @type {?} */
    NestableComponent.prototype.drop;
    /** @type {?} */
    NestableComponent.prototype.drag;
    /** @type {?} */
    NestableComponent.prototype.disclosure;
    /** @type {?} */
    NestableComponent.prototype.template;
    /** @type {?} */
    NestableComponent.prototype.options;
    /** @type {?} */
    NestableComponent.prototype.disableDrag;
    /** @type {?} */
    NestableComponent.prototype.dragRootEl;
    /** @type {?} */
    NestableComponent.prototype.dragEl;
    /** @type {?} */
    NestableComponent.prototype.dragModel;
    /** @type {?} */
    NestableComponent.prototype.moving;
    /**
     * Dragged element contains children, and those children contain other children and so on...
     * This property gives you the number of generations contained within the dragging item.
     * @type {?}
     */
    NestableComponent.prototype.dragDepth;
    /**
     * The depth of dragging item relative to element root (ngx-nestable)
     * @type {?}
     */
    NestableComponent.prototype.relativeDepth;
    /** @type {?} */
    NestableComponent.prototype.hasNewRoot;
    /** @type {?} */
    NestableComponent.prototype.pointEl;
    /** @type {?} */
    NestableComponent.prototype.items;
    /**
     * @type {?}
     * @private
     */
    NestableComponent.prototype._componentActive;
    /**
     * @type {?}
     * @private
     */
    NestableComponent.prototype._mouse;
    /**
     * @type {?}
     * @private
     */
    NestableComponent.prototype._list;
    /**
     * @type {?}
     * @private
     */
    NestableComponent.prototype._cancelMousemove;
    /**
     * @type {?}
     * @private
     */
    NestableComponent.prototype._cancelMouseup;
    /**
     * @type {?}
     * @private
     */
    NestableComponent.prototype._placeholder;
    /**
     * @type {?}
     * @private
     */
    NestableComponent.prototype._itemId;
    /**
     * @type {?}
     * @private
     */
    NestableComponent.prototype._registerHandleDirective;
    /**
     * @type {?}
     * @private
     */
    NestableComponent.prototype._dragIndex;
    /**
     * @type {?}
     * @private
     */
    NestableComponent.prototype._parentDragId;
    /**
     * @type {?}
     * @private
     */
    NestableComponent.prototype._oldListLength;
    /**
     * @type {?}
     * @private
     */
    NestableComponent.prototype.ref;
    /**
     * @type {?}
     * @private
     */
    NestableComponent.prototype.renderer;
    /**
     * @type {?}
     * @private
     */
    NestableComponent.prototype.el;
    /**
     * @type {?}
     * @private
     */
    NestableComponent.prototype.zone;
}
export { ɵ0 };

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmVzdGFibGUuY29tcG9uZW50LmpzIiwic291cmNlcyI6WyJuZ3gtbmVzdGFibGUvbGliL25lc3RhYmxlLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUFBLE9BQU8sRUFDSCx1QkFBdUIsRUFDdkIsaUJBQWlCLEVBQ2pCLFNBQVMsRUFDVCxVQUFVLEVBQ1YsWUFBWSxFQUNaLEtBQUssRUFDTCxNQUFNLEVBR04sTUFBTSxFQUNOLFNBQVMsRUFDVCxnQkFBZ0IsRUFDaEIsaUJBQWlCLEVBQ3BCLE1BQU0sZUFBZSxDQUFDO0FBRXZCLE9BQU8sS0FBSyxNQUFNLE1BQU0sbUJBQW1CLENBQUM7QUFFNUMsT0FBTyxFQUFFLGVBQWUsRUFBRSxVQUFVLEVBQUUsZUFBZSxFQUFFLEtBQUssRUFBRSxlQUFlLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUMzRzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQ2dCLElBQVYsRUFBRSxHQUFHLElBQUk7QUFDZjtBQUFhO0FBQWU7QUFBRjtBQUMxQjtBQUFxQixRQUFYLEVBQUUsR0FBRyxRQUFRLENBQUMsYUFBYSxDQUFDLEtBQUssQ0FBQztBQUM1QztBQUFxQixRQUFiLEtBQUssR0FBRyxRQUFRLENBQUMsZUFBZTtBQUN4QyxJQUNJLElBQUksQ0FBQyxDQUFDLGVBQWUsSUFBSSxFQUFFLENBQUMsS0FBSyxDQUFDLEVBQUU7QUFDeEMsUUFBUSxPQUFPLEtBQUssQ0FBQztBQUNyQixLQUFLO0FBQ0wsSUFDSSxFQUFFLENBQUMsS0FBSyxDQUFDLGFBQWEsR0FBRyxNQUFNLENBQUM7QUFDcEMsSUFBSSxFQUFFLENBQUMsS0FBSyxDQUFDLGFBQWEsR0FBRyxHQUFHLENBQUM7QUFDakMsSUFBSSxLQUFLLENBQUMsV0FBVyxDQUFDLEVBQUUsQ0FBQyxDQUFDO0FBQzFCO0FBQ0EsUUFEVSxRQUFRLEdB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QixJQUFoQix1Q0FBMEI7QUFDOUI7QUFBcUIsSUFBakIsb0NBQXNCO0FBQzFCO0FBQXFCLElBQWpCLGtDQUFrQjtBQUN0QjtBQUNPO0FBQWlCO0FBQ3RCO0FBQVEsSUFETiw2Q0FBaUM7QUFDckM7QUFBUTtBQUFpQjtBQUFnQjtBQUN2QyxJQURFLG1DQUEwQztBQUM5QztBQUFRO0FBQ1A7QUFBZ0I7QUFBUSxJQURyQixrQ0FBbUI7QUFDdkI7QUFBUTtBQUFpQjtBQUFnQjtBQUFRLElBQzdDLDZDQUFtQztBQUN2QztBQUFRO0FBQWlCO0FBQ3RCO0FBQVEsSUFEUCwyQ0FBaUM7QUFDckM7QUFBUTtBQUFpQjtBQUNWO0FBQVEsSUFEbkIseUNBQXFCO0FBQ3pCO0FBQVE7QUFDUjtBQUFnQjtBQUFRLElBRHBCLG9DQUFvQjtBQUN4QjtBQUFRO0FBQWlCO0FBQWdCO0FBQ3RDLElBREMscURBQXlDO0FBQzdDO0FBQVE7QUFDUDtBQUFnQjtBQUFRLElBRHJCLHVDQUFtQjtBQUN2QjtBQUFRO0FBQWlCO0FBQ1g7QUFBUSxJQURsQiwwQ0FBc0I7QUFDMUI7QUFBUTtBQUFpQjtBQUVsQjtBQUFRLElBRlgsMkNBQTRCO0FBQ2hDO0FBQ087QUFDQTtBQUFnQjtBQUFRLElBQXZCLGdDQUE4QjtBQUFDO0FBQ2hDO0FBQWlCO0FBQ3JCO0FBQVEsSUFESCxxQ0FBMkI7QUFBQztBQUM3QjtBQUFpQjtBQUNoQjtBQUFRLElBRFIsK0JBQXNCO0FBQUM7QUFDeEI7QUFBaUI7QUFHdkI7QUFBUSxJQUhELGlDQUFvQjtBQUM1QjtBQUFFO0FBRUsiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICAgIENoYW5nZURldGVjdGlvblN0cmF0ZWd5LFxuICAgIENoYW5nZURldGVjdG9yUmVmLFxuICAgIENvbXBvbmVudCxcbiAgICBFbGVtZW50UmVmLFxuICAgIEV2ZW50RW1pdHRlcixcbiAgICBJbnB1dCxcbiAgICBOZ1pvbmUsXG4gICAgT25EZXN0cm95LFxuICAgIE9uSW5pdCxcbiAgICBPdXRwdXQsXG4gICAgUmVuZGVyZXIyLFxuICAgIFZpZXdDb250YWluZXJSZWYsXG4gICAgVmlld0VuY2Fwc3VsYXRpb25cbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5cbmltcG9ydCAqIGFzIGhlbHBlciBmcm9tICcuL25lc3RhYmxlLmhlbHBlcic7XG5cbmltcG9ydCB7IGRlZmF1bHRTZXR0aW5ncywgRFJBR19TVEFSVCwgRVhQQU5EX0NPTExBUFNFLCBtb3VzZSwgUkVHSVNURVJfSEFORExFIH0gZnJvbSAnLi9uZXN0YWJsZS5jb25zdGFudCc7XG5cbmNvbnN0IFBYID0gJ3B4JztcbmNvbnN0IGhhc1BvaW50ZXJFdmVudHMgPSAoZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JyksXG4gICAgICAgIGRvY0VsID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50O1xuXG4gICAgaWYgKCEoJ3BvaW50ZXJFdmVudHMnIGluIGVsLnN0eWxlKSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgZWwuc3R5bGUucG9pbnRlckV2ZW50cyA9ICdhdXRvJztcbiAgICBlbC5zdHlsZS5wb2ludGVyRXZlbnRzID0gJ3gnO1xuICAgIGRvY0VsLmFwcGVuZENoaWxkKGVsKTtcbiAgICBjb25zdCBzdXBwb3J0cyA9XG4gICAgICAgIHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlICYmXG4gICAgICAgIHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKGVsLCAnJykucG9pbnRlckV2ZW50cyA9PT0gJ2F1dG8nO1xuICAgIGRvY0VsLnJlbW92ZUNoaWxkKGVsKTtcbiAgICByZXR1cm4gISFzdXBwb3J0cztcbn0pKCk7XG5cbkBDb21wb25lbnQoe1xuICAgIHNlbGVjdG9yOiAnbmd4LW5lc3RhYmxlJyxcbiAgICB0ZW1wbGF0ZVVybDogJy4vbmVzdGFibGUuY29tcG9uZW50Lmh0bWwnLFxuICAgIHN0eWxlVXJsczogWycuL25lc3RhYmxlLmNvbXBvbmVudC5zY3NzJ10sXG4gICAgZW5jYXBzdWxhdGlvbjogVmlld0VuY2Fwc3VsYXRpb24uTm9uZSxcbiAgICBjaGFuZ2VEZXRlY3Rpb246IENoYW5nZURldGVjdGlvblN0cmF0ZWd5Lk9uUHVzaFxufSlcbmV4cG9ydCBjbGFzcyBOZXN0YWJsZUNvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgT25EZXN0cm95IHtcbiAgICBAT3V0cHV0KCkgcHVibGljIGxpc3RDaGFuZ2UgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gICAgQE91dHB1dCgpIHB1YmxpYyBkcm9wID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICAgIEBPdXRwdXQoKSBwdWJsaWMgZHJhZyA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcbiAgICBAT3V0cHV0KCkgcHVibGljIGRpc2Nsb3N1cmUgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG5cbiAgICBASW5wdXQoKSBwdWJsaWMgdGVtcGxhdGU6IFZpZXdDb250YWluZXJSZWY7XG4gICAgQElucHV0KCkgcHVibGljIG9wdGlvbnMgPSBkZWZhdWx0U2V0dGluZ3M7XG4gICAgQElucHV0KCkgcHVibGljIGRpc2FibGVEcmFnID0gZmFsc2U7XG5cbiAgICBASW5wdXQoKVxuICAgIHB1YmxpYyBnZXQgbGlzdCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2xpc3Q7XG4gICAgfVxuXG4gICAgcHVibGljIHNldCBsaXN0KGxpc3QpIHtcbiAgICAgICAgdGhpcy5fbGlzdCA9IGxpc3Q7XG4gICAgICAgIHRoaXMuX2dlbmVyYXRlSXRlbUlkcygpO1xuICAgIH1cblxuICAgIHB1YmxpYyBkcmFnUm9vdEVsID0gbnVsbDtcbiAgICBwdWJsaWMgZHJhZ0VsID0gbnVsbDtcbiAgICBwdWJsaWMgZHJhZ01vZGVsID0gbnVsbDtcbiAgICBwdWJsaWMgbW92aW5nID0gZmFsc2U7XG5cbiAgICAvKipcbiAgICAgKiBEcmFnZ2VkIGVsZW1lbnQgY29udGFpbnMgY2hpbGRyZW4sIGFuZCB0aG9zZSBjaGlsZHJlbiBjb250YWluIG90aGVyIGNoaWxkcmVuIGFuZCBzbyBvbi4uLlxuICAgICAqIFRoaXMgcHJvcGVydHkgZ2l2ZXMgeW91IHRoZSBudW1iZXIgb2YgZ2VuZXJhdGlvbnMgY29udGFpbmVkIHdpdGhpbiB0aGUgZHJhZ2dpbmcgaXRlbS5cbiAgICAgKi9cbiAgICBwdWJsaWMgZHJhZ0RlcHRoID0gMDtcblxuICAgIC8qKlxuICAgICAqIFRoZSBkZXB0aCBvZiBkcmFnZ2luZyBpdGVtIHJlbGF0aXZlIHRvIGVsZW1lbnQgcm9vdCAobmd4LW5lc3RhYmxlKVxuICAgICAqL1xuICAgIHB1YmxpYyByZWxhdGl2ZURlcHRoID0gMDtcblxuICAgIHB1YmxpYyBoYXNOZXdSb290ID0gZmFsc2U7XG4gICAgcHVibGljIHBvaW50RWwgPSBudWxsO1xuICAgIHB1YmxpYyBpdGVtcyA9IFtdO1xuXG4gICAgcHJpdmF0ZSBfY29tcG9uZW50QWN0aXZlID0gZmFsc2U7XG4gICAgcHJpdmF0ZSBfbW91c2UgPSBPYmplY3QuYXNzaWduKHt9LCBtb3VzZSk7XG4gICAgcHJpdmF0ZSBfbGlzdCA9IFtdO1xuICAgIC8vIHByaXZhdGUgX29wdGlvbnMgPSBPYmplY3QuYXNzaWduKHt9LCBkZWZhdWx0U2V0dGluZ3MpIGFzIE5lc3RhYmxlU2V0dGluZ3M7XG4gICAgcHJpdmF0ZSBfY2FuY2VsTW91c2Vtb3ZlOiBGdW5jdGlvbjtcbiAgICBwcml2YXRlIF9jYW5jZWxNb3VzZXVwOiBGdW5jdGlvbjtcbiAgICBwcml2YXRlIF9wbGFjZWhvbGRlcjtcbiAgICBwcml2YXRlIF9pdGVtSWQgPSAwO1xuICAgIHByaXZhdGUgX3JlZ2lzdGVySGFuZGxlRGlyZWN0aXZlID0gZmFsc2U7XG4gICAgcHJpdmF0ZSBfZHJhZ0luZGV4O1xuICAgIHByaXZhdGUgX3BhcmVudERyYWdJZDtcbiAgICBwcml2YXRlIF9vbGRMaXN0TGVuZ3RoOiBhbnk7XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHJpdmF0ZSByZWY6IENoYW5nZURldGVjdG9yUmVmLFxuICAgICAgICBwcml2YXRlIHJlbmRlcmVyOiBSZW5kZXJlcjIsXG4gICAgICAgIHByaXZhdGUgZWw6IEVsZW1lbnRSZWYsXG4gICAgICAgIHByaXZhdGUgem9uZTogTmdab25lXG4gICAgKSB7fVxuXG4gICAgbmdPbkluaXQoKTogdm9pZCB7XG4gICAgICAgIC8vIHNldC9leHRlbmQgZGVmYXVsdCBvcHRpb25zXG4gICAgICAgIHRoaXMuX2NvbXBvbmVudEFjdGl2ZSA9IHRydWU7XG4gICAgICAgIGNvbnN0IG9wdGlvbktleXMgPSBPYmplY3Qua2V5cyhkZWZhdWx0U2V0dGluZ3MpO1xuICAgICAgICBmb3IgKGNvbnN0IGtleSBvZiBvcHRpb25LZXlzKSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIHRoaXMub3B0aW9uc1trZXldID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgICAgIHRoaXMub3B0aW9uc1trZXldID0gZGVmYXVsdFNldHRpbmdzW2tleV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLl9nZW5lcmF0ZUl0ZW1JZHMoKTtcbiAgICAgICAgdGhpcy5fZ2VuZXJhdGVJdGVtRXhwYW5kZWQoKTtcbiAgICAgICAgdGhpcy5fY3JlYXRlSGFuZGxlTGlzdGVuZXIoKTtcbiAgICB9XG5cbiAgICBuZ09uRGVzdHJveSgpOiB2b2lkIHt9XG5cbiAgICBwcml2YXRlIF9nZW5lcmF0ZUl0ZW1JZHMoKSB7XG4gICAgICAgIGhlbHBlci5fdHJhdmVyc2VDaGlsZHJlbih0aGlzLl9saXN0LCBpdGVtID0+IHtcbiAgICAgICAgICAgIGl0ZW1bJyQkaWQnXSA9IHRoaXMuX2l0ZW1JZCsrO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBwcml2YXRlIF9nZW5lcmF0ZUl0ZW1FeHBhbmRlZCgpIHtcbiAgICAgICAgaGVscGVyLl90cmF2ZXJzZUNoaWxkcmVuKHRoaXMuX2xpc3QsIGl0ZW0gPT4ge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBpdGVtLmV4cGFuZGVkID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgICAgIGl0ZW1bJyQkZXhwYW5kZWQnXSA9IHRydWU7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGl0ZW1bJyQkZXhwYW5kZWQnXSA9IGl0ZW0uZXhwYW5kZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHByaXZhdGUgX2NyZWF0ZUhhbmRsZUxpc3RlbmVyKCkge1xuICAgICAgICB0aGlzLnJlbmRlcmVyLmxpc3Rlbih0aGlzLmVsLm5hdGl2ZUVsZW1lbnQsIFJFR0lTVEVSX0hBTkRMRSwgKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5fcmVnaXN0ZXJIYW5kbGVEaXJlY3RpdmUgPSB0cnVlO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLnJlbmRlcmVyLmxpc3Rlbih0aGlzLmVsLm5hdGl2ZUVsZW1lbnQsIERSQUdfU1RBUlQsIGRhdGEgPT4ge1xuICAgICAgICAgICAgdGhpcy5kcmFnU3RhcnQoXG4gICAgICAgICAgICAgICAgZGF0YS5kZXRhaWwuZXZlbnQsXG4gICAgICAgICAgICAgICAgZGF0YS5kZXRhaWwucGFyYW0uaXRlbSxcbiAgICAgICAgICAgICAgICBkYXRhLmRldGFpbC5wYXJhbS5wYXJlbnRMaXN0XG4gICAgICAgICAgICApO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLnJlbmRlcmVyLmxpc3Rlbih0aGlzLmVsLm5hdGl2ZUVsZW1lbnQsIEVYUEFORF9DT0xMQVBTRSwgZGF0YSA9PiB7XG4gICAgICAgICAgICB0aGlzLmRpc2Nsb3N1cmUuZW1pdCh7XG4gICAgICAgICAgICAgICAgaXRlbTogZGF0YS5kZXRhaWwuaXRlbSxcbiAgICAgICAgICAgICAgICBleHBhbmRlZDogZGF0YS5kZXRhaWwuaXRlbVsnJCRleHBhbmRlZCddXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBfY3JlYXRlRHJhZ0Nsb25lKGV2ZW50LCBkcmFnSXRlbSkge1xuICAgICAgICB0aGlzLl9tb3VzZVN0YXJ0KGV2ZW50LCBkcmFnSXRlbSk7XG5cbiAgICAgICAgaWYgKCF0aGlzLl9yZWdpc3RlckhhbmRsZURpcmVjdGl2ZSkge1xuICAgICAgICAgICAgdGhpcy5fbW91c2Uub2Zmc2V0WSA9IGRyYWdJdGVtLm5leHRFbGVtZW50U2libGluZ1xuICAgICAgICAgICAgICAgID8gZHJhZ0l0ZW0ubmV4dEVsZW1lbnRTaWJsaW5nLmNsaWVudEhlaWdodCAvIDJcbiAgICAgICAgICAgICAgICA6IGRyYWdJdGVtLmNsaWVudEhlaWdodCAvIDI7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBjcmVhdGUgZHJhZyBjbG9uZVxuICAgICAgICB0aGlzLmRyYWdFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQodGhpcy5vcHRpb25zLmxpc3ROb2RlTmFtZSk7XG4gICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQodGhpcy5kcmFnRWwpO1xuXG4gICAgICAgIHRoaXMucmVuZGVyZXIuYWRkQ2xhc3ModGhpcy5kcmFnRWwsIHRoaXMub3B0aW9ucy5kcmFnQ2xhc3MpO1xuXG4gICAgICAgIC8vIGFkZCBkcmFnIGNsb25lIHRvIGJvZHkgYW5kIHNldCBjc3NcbiAgICAgICAgdGhpcy5yZW5kZXJlci5zZXRTdHlsZShcbiAgICAgICAgICAgIHRoaXMuZHJhZ0VsLFxuICAgICAgICAgICAgJ2xlZnQnLFxuICAgICAgICAgICAgZXZlbnQucGFnZVggLSB0aGlzLl9tb3VzZS5vZmZzZXRYICsgUFhcbiAgICAgICAgKTtcbiAgICAgICAgdGhpcy5yZW5kZXJlci5zZXRTdHlsZShcbiAgICAgICAgICAgIHRoaXMuZHJhZ0VsLFxuICAgICAgICAgICAgJ3RvcCcsXG4gICAgICAgICAgICBldmVudC5wYWdlWSAtIHRoaXMuX21vdXNlLm9mZnNldFkgKyBQWFxuICAgICAgICApO1xuICAgICAgICB0aGlzLnJlbmRlcmVyLnNldFN0eWxlKHRoaXMuZHJhZ0VsLCAncG9zaXRpb24nLCAnYWJzb2x1dGUnKTtcbiAgICAgICAgdGhpcy5yZW5kZXJlci5zZXRTdHlsZSh0aGlzLmRyYWdFbCwgJ3otaW5kZXgnLCA5OTk5KTtcbiAgICAgICAgdGhpcy5yZW5kZXJlci5zZXRTdHlsZSh0aGlzLmRyYWdFbCwgJ3BvaW50ZXItZXZlbnRzJywgJ25vbmUnKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIF9jcmVhdGVQbGFjZWhvbGRlcihldmVudCwgZHJhZ0l0ZW0pIHtcbiAgICAgICAgdGhpcy5fcGxhY2Vob2xkZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgdGhpcy5fcGxhY2Vob2xkZXIuY2xhc3NMaXN0LmFkZCh0aGlzLm9wdGlvbnMucGxhY2VDbGFzcyk7XG4gICAgICAgIGhlbHBlci5faW5zZXJ0QWZ0ZXIodGhpcy5fcGxhY2Vob2xkZXIsIGRyYWdJdGVtKTtcbiAgICAgICAgZHJhZ0l0ZW0ucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChkcmFnSXRlbSk7XG4gICAgICAgIHRoaXMuZHJhZ0VsLmFwcGVuZENoaWxkKGRyYWdJdGVtKTtcbiAgICAgICAgdGhpcy5kcmFnUm9vdEVsID0gZHJhZ0l0ZW07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2V0cyBkZXB0aCBwcm9lcnRpZXMgKHJlbGF0aXZlIGFuZCBkcmFnKVxuICAgICAqL1xuICAgIHByaXZhdGUgX2NhbGN1bGF0ZURlcHRoKCkge1xuICAgICAgICAvLyB0b3RhbCBkZXB0aCBvZiBkcmFnZ2luZyBpdGVtXG4gICAgICAgIGxldCBkZXB0aDtcbiAgICAgICAgY29uc3QgaXRlbXMgPSB0aGlzLmRyYWdFbC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMub3B0aW9ucy5pdGVtTm9kZU5hbWUpO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGl0ZW1zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBkZXB0aCA9IGhlbHBlci5fZ2V0UGFyZW50cyhpdGVtc1tpXSwgdGhpcy5kcmFnRWwpLmxlbmd0aDtcbiAgICAgICAgICAgIGlmIChkZXB0aCA+IHRoaXMuZHJhZ0RlcHRoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kcmFnRGVwdGggPSBkZXB0aDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGRlcHRoIHJlbGF0aXZlIHRvIHJvb3RcbiAgICAgICAgdGhpcy5yZWxhdGl2ZURlcHRoID0gaGVscGVyLl9nZXRQYXJlbnRzKFxuICAgICAgICAgICAgdGhpcy5fcGxhY2Vob2xkZXIsXG4gICAgICAgICAgICB0aGlzLmVsLm5hdGl2ZUVsZW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLm9wdGlvbnMubGlzdE5vZGVOYW1lKVxuICAgICAgICApLmxlbmd0aDtcbiAgICB9XG5cbiAgICBwcml2YXRlIF9tb3VzZVN0YXJ0KGV2ZW50LCBkcmFnSXRlbSkge1xuICAgICAgICB0aGlzLl9tb3VzZS5vZmZzZXRYID0gZXZlbnQucGFnZVggLSBoZWxwZXIuX29mZnNldChkcmFnSXRlbSkubGVmdDtcbiAgICAgICAgdGhpcy5fbW91c2Uub2Zmc2V0WSA9IGV2ZW50LnBhZ2VZIC0gaGVscGVyLl9vZmZzZXQoZHJhZ0l0ZW0pLnRvcDtcbiAgICAgICAgdGhpcy5fbW91c2Uuc3RhcnRYID0gdGhpcy5fbW91c2UubGFzdFggPSBldmVudC5wYWdlWDtcbiAgICAgICAgdGhpcy5fbW91c2Uuc3RhcnRZID0gdGhpcy5fbW91c2UubGFzdFkgPSBldmVudC5wYWdlWTtcbiAgICB9XG5cbiAgICBwcml2YXRlIF9tb3VzZVVwZGF0ZShldmVudCkge1xuICAgICAgICAvLyBtb3VzZSBwb3NpdGlvbiBsYXN0IGV2ZW50c1xuICAgICAgICB0aGlzLl9tb3VzZS5sYXN0WCA9IHRoaXMuX21vdXNlLm5vd1g7XG4gICAgICAgIHRoaXMuX21vdXNlLmxhc3RZID0gdGhpcy5fbW91c2Uubm93WTtcbiAgICAgICAgLy8gbW91c2UgcG9zaXRpb24gdGhpcyBldmVudHNcbiAgICAgICAgdGhpcy5fbW91c2Uubm93WCA9IGV2ZW50LnBhZ2VYO1xuICAgICAgICB0aGlzLl9tb3VzZS5ub3dZID0gZXZlbnQucGFnZVk7XG4gICAgICAgIC8vIGRpc3RhbmNlIG1vdXNlIG1vdmVkIGJldHdlZW4gZXZlbnRzXG4gICAgICAgIHRoaXMuX21vdXNlLmRpc3RYID0gdGhpcy5fbW91c2Uubm93WCAtIHRoaXMuX21vdXNlLmxhc3RYO1xuICAgICAgICB0aGlzLl9tb3VzZS5kaXN0WSA9IHRoaXMuX21vdXNlLm5vd1kgLSB0aGlzLl9tb3VzZS5sYXN0WTtcbiAgICAgICAgLy8gZGlyZWN0aW9uIG1vdXNlIHdhcyBtb3ZpbmdcbiAgICAgICAgdGhpcy5fbW91c2UubGFzdERpclggPSB0aGlzLl9tb3VzZS5kaXJYO1xuICAgICAgICB0aGlzLl9tb3VzZS5sYXN0RGlyWSA9IHRoaXMuX21vdXNlLmRpclk7XG4gICAgICAgIC8vIGRpcmVjdGlvbiBtb3VzZSBpcyBub3cgbW92aW5nIChvbiBib3RoIGF4aXMpXG4gICAgICAgIHRoaXMuX21vdXNlLmRpclggPVxuICAgICAgICAgICAgdGhpcy5fbW91c2UuZGlzdFggPT09IDAgPyAwIDogdGhpcy5fbW91c2UuZGlzdFggPiAwID8gMSA6IC0xO1xuICAgICAgICB0aGlzLl9tb3VzZS5kaXJZID1cbiAgICAgICAgICAgIHRoaXMuX21vdXNlLmRpc3RZID09PSAwID8gMCA6IHRoaXMuX21vdXNlLmRpc3RZID4gMCA/IDEgOiAtMTtcbiAgICB9XG5cbiAgICBwcml2YXRlIF9zaG93TWFza3MoKSB7XG4gICAgICAgIGNvbnN0IG1hc2tzID0gdGhpcy5lbC5uYXRpdmVFbGVtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXG4gICAgICAgICAgICAnbmVzdGFibGUtaXRlbS1tYXNrJ1xuICAgICAgICApO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG1hc2tzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBtYXNrc1tpXS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgX2hpZGVNYXNrcygpIHtcbiAgICAgICAgY29uc3QgbWFza3MgPSB0aGlzLmVsLm5hdGl2ZUVsZW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcbiAgICAgICAgICAgICduZXN0YWJsZS1pdGVtLW1hc2snXG4gICAgICAgICk7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbWFza3MubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIG1hc2tzW2ldLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBjYWxjIG1vdXNlIHRyYXZlcnNlIGRpc3RhbmNlIG9uIGF4aXNcbiAgICAgKiBAcGFyYW0gbSAtIG1vdXNlXG4gICAgICovXG4gICAgcHJpdmF0ZSBfY2FsY01vdXNlRGlzdGFuY2UobSkge1xuICAgICAgICBtLmRpc3RBeFggKz0gTWF0aC5hYnMobS5kaXN0WCk7XG4gICAgICAgIGlmIChtLmRpclggIT09IDAgJiYgbS5kaXJYICE9PSBtLmxhc3REaXJYKSB7XG4gICAgICAgICAgICBtLmRpc3RBeFggPSAwO1xuICAgICAgICB9XG5cbiAgICAgICAgbS5kaXN0QXhZICs9IE1hdGguYWJzKG0uZGlzdFkpO1xuICAgICAgICBpZiAobS5kaXJZICE9PSAwICYmIG0uZGlyWSAhPT0gbS5sYXN0RGlyWSkge1xuICAgICAgICAgICAgbS5kaXN0QXhZID0gMDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgX21vdmUoZXZlbnQpIHtcbiAgICAgICAgbGV0IGRlcHRoLCBsaXN0O1xuXG4gICAgICAgIGNvbnN0IGRyYWdSZWN0ID0gdGhpcy5kcmFnRWwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICAgIHRoaXMucmVuZGVyZXIuc2V0U3R5bGUoXG4gICAgICAgICAgICB0aGlzLmRyYWdFbCxcbiAgICAgICAgICAgICdsZWZ0JyxcbiAgICAgICAgICAgIGV2ZW50LnBhZ2VYIC0gdGhpcy5fbW91c2Uub2Zmc2V0WCArIFBYXG4gICAgICAgICk7XG4gICAgICAgIHRoaXMucmVuZGVyZXIuc2V0U3R5bGUoXG4gICAgICAgICAgICB0aGlzLmRyYWdFbCxcbiAgICAgICAgICAgICd0b3AnLFxuICAgICAgICAgICAgZXZlbnQucGFnZVkgLSB0aGlzLl9tb3VzZS5vZmZzZXRZICsgUFhcbiAgICAgICAgKTtcblxuICAgICAgICB0aGlzLl9tb3VzZVVwZGF0ZShldmVudCk7XG5cbiAgICAgICAgLy8gYXhpcyBtb3VzZSBpcyBub3cgbW92aW5nIG9uXG4gICAgICAgIGNvbnN0IG5ld0F4ID1cbiAgICAgICAgICAgIE1hdGguYWJzKHRoaXMuX21vdXNlLmRpc3RYKSA+IE1hdGguYWJzKHRoaXMuX21vdXNlLmRpc3RZKSA/IDEgOiAwO1xuXG4gICAgICAgIC8vIGRvIG5vdGhpbmcgb24gZmlyc3QgbW92ZVxuICAgICAgICBpZiAoIXRoaXMuX21vdXNlLm1vdmluZykge1xuICAgICAgICAgICAgdGhpcy5fbW91c2UuZGlyQXggPSBuZXdBeDtcbiAgICAgICAgICAgIHRoaXMuX21vdXNlLm1vdmluZyA9IDE7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICAvLyBjYWxjIGRpc3RhbmNlIG1vdmVkIG9uIHRoaXMgYXhpcyAoYW5kIGRpcmVjdGlvbilcbiAgICAgICAgaWYgKHRoaXMuX21vdXNlLmRpckF4ICE9PSBuZXdBeCkge1xuICAgICAgICAgICAgdGhpcy5fbW91c2UuZGlzdEF4WCA9IDA7XG4gICAgICAgICAgICB0aGlzLl9tb3VzZS5kaXN0QXhZID0gMDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX2NhbGNNb3VzZURpc3RhbmNlKHRoaXMuX21vdXNlKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9tb3VzZS5kaXJBeCA9IG5ld0F4O1xuXG4gICAgICAgIC8vIGZpbmQgbGlzdCBpdGVtIHVuZGVyIGN1cnNvclxuICAgICAgICBpZiAoIWhhc1BvaW50ZXJFdmVudHMpIHtcbiAgICAgICAgICAgIHRoaXMuZHJhZ0VsLnN0eWxlLnZpc2liaWxpdHkgPSAnaGlkZGVuJztcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHBvaW50RWwgPSBkb2N1bWVudC5lbGVtZW50RnJvbVBvaW50KFxuICAgICAgICAgICAgZXZlbnQucGFnZVggLSBkb2N1bWVudC5ib2R5LnNjcm9sbExlZnQsXG4gICAgICAgICAgICBldmVudC5wYWdlWSAtICh3aW5kb3cucGFnZVlPZmZzZXQgfHwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcClcbiAgICAgICAgKTtcblxuICAgICAgICBpZiAoIWhhc1BvaW50ZXJFdmVudHMpIHtcbiAgICAgICAgICAgIHRoaXMuZHJhZ0VsLnN0eWxlLnZpc2liaWxpdHkgPSAndmlzaWJsZSc7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoXG4gICAgICAgICAgICBwb2ludEVsICYmXG4gICAgICAgICAgICAocG9pbnRFbC5jbGFzc0xpc3QuY29udGFpbnMoJ25lc3RhYmxlLWl0ZW0tbWFzaycpIHx8XG4gICAgICAgICAgICAgICAgcG9pbnRFbC5jbGFzc0xpc3QuY29udGFpbnModGhpcy5vcHRpb25zLnBsYWNlQ2xhc3MpKVxuICAgICAgICApIHtcbiAgICAgICAgICAgIHRoaXMucG9pbnRFbCA9IHBvaW50RWwucGFyZW50RWxlbWVudC5wYXJlbnRFbGVtZW50O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIG1vdmUgaG9yaXpvbnRhbFxuICAgICAgICAgKi9cbiAgICAgICAgaWYgKFxuICAgICAgICAgICAgIXRoaXMub3B0aW9ucy5maXhlZERlcHRoICYmXG4gICAgICAgICAgICB0aGlzLl9tb3VzZS5kaXJBeCAmJlxuICAgICAgICAgICAgdGhpcy5fbW91c2UuZGlzdEF4WCA+PSB0aGlzLm9wdGlvbnMudGhyZXNob2xkXG4gICAgICAgICkge1xuICAgICAgICAgICAgLy8gcmVzZXQgbW92ZSBkaXN0YW5jZSBvbiB4LWF4aXMgZm9yIG5ldyBwaGFzZVxuICAgICAgICAgICAgdGhpcy5fbW91c2UuZGlzdEF4WCA9IDA7XG4gICAgICAgICAgICBjb25zdCBwcmV2aW91cyA9IHRoaXMuX3BsYWNlaG9sZGVyLnByZXZpb3VzRWxlbWVudFNpYmxpbmc7XG5cbiAgICAgICAgICAgIC8vIGluY3JlYXNlIGhvcml6b250YWwgbGV2ZWwgaWYgcHJldmlvdXMgc2libGluZyBleGlzdHMsIGlzIG5vdCBjb2xsYXBzZWQsIGFuZCBjYW4gaGF2ZSBjaGlsZHJlblxuICAgICAgICAgICAgaWYgKHRoaXMuX21vdXNlLmRpc3RYID4gMCAmJiBwcmV2aW91cykge1xuICAgICAgICAgICAgICAgIGxpc3QgPSBwcmV2aW91cy5xdWVyeVNlbGVjdG9yQWxsKHRoaXMub3B0aW9ucy5saXN0Tm9kZU5hbWUpO1xuICAgICAgICAgICAgICAgIGxpc3QgPSBsaXN0W2xpc3QubGVuZ3RoIC0gMV07XG5cbiAgICAgICAgICAgICAgICAvLyBjaGVjayBpZiBkZXB0aCBsaW1pdCBoYXMgcmVhY2hlZFxuICAgICAgICAgICAgICAgIGRlcHRoID0gaGVscGVyLl9nZXRQYXJlbnRzKFxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9wbGFjZWhvbGRlcixcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5lbC5uYXRpdmVFbGVtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5vcHRpb25zLmxpc3ROb2RlTmFtZSlcbiAgICAgICAgICAgICAgICApLmxlbmd0aDtcblxuICAgICAgICAgICAgICAgIGlmIChkZXB0aCArIHRoaXMuZHJhZ0RlcHRoIDw9IHRoaXMub3B0aW9ucy5tYXhEZXB0aCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBjcmVhdGUgbmV3IHN1Yi1sZXZlbCBpZiBvbmUgZG9lc24ndCBleGlzdFxuICAgICAgICAgICAgICAgICAgICBpZiAoIWxpc3QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpc3QgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KHRoaXMub3B0aW9ucy5saXN0Tm9kZU5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGlzdC5zdHlsZS5wYWRkaW5nTGVmdCA9IHRoaXMub3B0aW9ucy50aHJlc2hvbGQgKyBQWDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpc3QuYXBwZW5kQ2hpbGQodGhpcy5fcGxhY2Vob2xkZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJldmlvdXMuYXBwZW5kQ2hpbGQobGlzdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGlzLnNldFBhcmVudChwcmV2aW91cyk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBlbHNlIGFwcGVuZCB0byBuZXh0IGxldmVsIHVwXG4gICAgICAgICAgICAgICAgICAgICAgICBsaXN0ID0gcHJldmlvdXMucXVlcnlTZWxlY3RvcihcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBgOnNjb3BlID4gJHsgdGhpcy5vcHRpb25zLmxpc3ROb2RlTmFtZSB9YFxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpc3QuYXBwZW5kQ2hpbGQodGhpcy5fcGxhY2Vob2xkZXIpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gZGVjcmVhc2UgaG9yaXpvbnRhbCBsZXZlbFxuICAgICAgICAgICAgaWYgKHRoaXMuX21vdXNlLmRpc3RYIDwgMCkge1xuICAgICAgICAgICAgICAgIC8vIHdlIGNhbid0IGRlY3JlYXNlIGEgbGV2ZWwgaWYgYW4gaXRlbSBwcmVjZWVkcyB0aGUgY3VycmVudCBvbmVcbiAgICAgICAgICAgICAgICBjb25zdCBuZXh0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgICAgICAgICAgICAgICAgYC4keyB0aGlzLm9wdGlvbnMucGxhY2VDbGFzcyB9ICsgJHsgdGhpcy5vcHRpb25zLml0ZW1Ob2RlTmFtZSB9YFxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgY29uc3QgcGFyZW50RWxlbWVudCA9IHRoaXMuX3BsYWNlaG9sZGVyLnBhcmVudEVsZW1lbnQ7XG4gICAgICAgICAgICAgICAgaWYgKCFuZXh0ICYmIHBhcmVudEVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY2xvc2VzdEl0ZW0gPSBoZWxwZXIuX2Nsb3Nlc3QoXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9wbGFjZWhvbGRlcixcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub3B0aW9ucy5pdGVtTm9kZU5hbWVcbiAgICAgICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoY2xvc2VzdEl0ZW0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudEVsZW1lbnQucmVtb3ZlQ2hpbGQodGhpcy5fcGxhY2Vob2xkZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaGVscGVyLl9pbnNlcnRBZnRlcih0aGlzLl9wbGFjZWhvbGRlciwgY2xvc2VzdEl0ZW0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFwb2ludEVsLmNsYXNzTGlzdC5jb250YWlucygnbmVzdGFibGUtaXRlbS1tYXNrJykpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGZpbmQgcm9vdCBsaXN0IG9mIGl0ZW0gdW5kZXIgY3Vyc29yXG4gICAgICAgIGNvbnN0IHBvaW50RWxSb290ID0gaGVscGVyLl9jbG9zZXN0KFxuICAgICAgICAgICAgdGhpcy5wb2ludEVsLFxuICAgICAgICAgICAgYC4keyB0aGlzLm9wdGlvbnMucm9vdENsYXNzIH1gXG4gICAgICAgICAgICApLFxuICAgICAgICAgICAgaXNOZXdSb290ID0gcG9pbnRFbFJvb3RcbiAgICAgICAgICAgICAgICA/IHRoaXMuZHJhZ1Jvb3RFbC5kYXRhc2V0WyduZXN0YWJsZS1pZCddICE9PVxuICAgICAgICAgICAgICAgIHBvaW50RWxSb290LmRhdGFzZXRbJ25lc3RhYmxlLWlkJ11cbiAgICAgICAgICAgICAgICA6IGZhbHNlO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBtb3ZlIHZlcnRpY2FsXG4gICAgICAgICAqL1xuICAgICAgICBpZiAoIXRoaXMuX21vdXNlLmRpckF4IHx8IGlzTmV3Um9vdCkge1xuICAgICAgICAgICAgLy8gY2hlY2sgaWYgZ3JvdXBzIG1hdGNoIGlmIGRyYWdnaW5nIG92ZXIgbmV3IHJvb3RcbiAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgICBpc05ld1Jvb3QgJiZcbiAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbnMuZ3JvdXAgIT09IHBvaW50RWxSb290LmRhdGFzZXRbJ25lc3RhYmxlLWdyb3VwJ11cbiAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gY2hlY2sgZGVwdGggbGltaXRcbiAgICAgICAgICAgIGRlcHRoID1cbiAgICAgICAgICAgICAgICB0aGlzLmRyYWdEZXB0aCAtXG4gICAgICAgICAgICAgICAgMSArXG4gICAgICAgICAgICAgICAgaGVscGVyLl9nZXRQYXJlbnRzKFxuICAgICAgICAgICAgICAgICAgICB0aGlzLnBvaW50RWwsXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZWwubmF0aXZlRWxlbWVudC5xdWVyeVNlbGVjdG9yKHRoaXMub3B0aW9ucy5saXN0Tm9kZU5hbWUpXG4gICAgICAgICAgICAgICAgKS5sZW5ndGg7XG5cbiAgICAgICAgICAgIGlmIChkZXB0aCA+IHRoaXMub3B0aW9ucy5tYXhEZXB0aCkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3QgYmVmb3JlID1cbiAgICAgICAgICAgICAgICBldmVudC5wYWdlWSA8XG4gICAgICAgICAgICAgICAgaGVscGVyLl9vZmZzZXQodGhpcy5wb2ludEVsKS50b3AgKyB0aGlzLnBvaW50RWwuY2xpZW50SGVpZ2h0IC8gMjtcbiAgICAgICAgICAgIGNvbnN0IHBsYWNlaG9sZGVyUGFyZW50ID0gdGhpcy5fcGxhY2Vob2xkZXIucGFyZW50Tm9kZTtcblxuICAgICAgICAgICAgLy8gZ2V0IHBvaW50IGVsZW1lbnQgZGVwdGhcbiAgICAgICAgICAgIGxldCBwb2ludFJlbGF0aXZlRGVwdGg7XG4gICAgICAgICAgICBwb2ludFJlbGF0aXZlRGVwdGggPSBoZWxwZXIuX2dldFBhcmVudHMoXG4gICAgICAgICAgICAgICAgdGhpcy5wb2ludEVsLFxuICAgICAgICAgICAgICAgIHRoaXMuZWwubmF0aXZlRWxlbWVudC5xdWVyeVNlbGVjdG9yKHRoaXMub3B0aW9ucy5saXN0Tm9kZU5hbWUpXG4gICAgICAgICAgICApLmxlbmd0aDtcblxuICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5maXhlZERlcHRoKSB7XG4gICAgICAgICAgICAgICAgaWYgKHBvaW50UmVsYXRpdmVEZXB0aCA9PT0gdGhpcy5yZWxhdGl2ZURlcHRoIC0gMSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBjaGlsZExpc3QgPSB0aGlzLnBvaW50RWwucXVlcnlTZWxlY3RvcihcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub3B0aW9ucy5saXN0Tm9kZU5hbWVcbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFjaGlsZExpc3QuY2hpbGRyZW4ubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjaGlsZExpc3QuYXBwZW5kQ2hpbGQodGhpcy5fcGxhY2Vob2xkZXIpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChwb2ludFJlbGF0aXZlRGVwdGggPT09IHRoaXMucmVsYXRpdmVEZXB0aCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoYmVmb3JlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBvaW50RWwucGFyZW50RWxlbWVudC5pbnNlcnRCZWZvcmUoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fcGxhY2Vob2xkZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wb2ludEVsXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgaGVscGVyLl9pbnNlcnRBZnRlcih0aGlzLl9wbGFjZWhvbGRlciwgdGhpcy5wb2ludEVsKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgICAgICAgICAgIEFycmF5LnByb3RvdHlwZS5pbmRleE9mLmNhbGwoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wb2ludEVsLnBhcmVudEVsZW1lbnQuY2hpbGRyZW4sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wb2ludEVsXG4gICAgICAgICAgICAgICAgICAgICAgICApID09PVxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wb2ludEVsLnBhcmVudEVsZW1lbnQuY2hpbGRyZW4ubGVuZ3RoIC0gMVxuICAgICAgICAgICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGhlbHBlci5faW5zZXJ0QWZ0ZXIodGhpcy5fcGxhY2Vob2xkZXIsIHRoaXMucG9pbnRFbCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGJlZm9yZSkge1xuICAgICAgICAgICAgICAgIHRoaXMucG9pbnRFbC5wYXJlbnRFbGVtZW50Lmluc2VydEJlZm9yZShcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcGxhY2Vob2xkZXIsXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucG9pbnRFbFxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGhlbHBlci5faW5zZXJ0QWZ0ZXIodGhpcy5fcGxhY2Vob2xkZXIsIHRoaXMucG9pbnRFbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwdWJsaWMgcmVzZXQoKSB7XG4gICAgICAgIGNvbnN0IGtleXMgPSBPYmplY3Qua2V5cyh0aGlzLl9tb3VzZSk7XG4gICAgICAgIGZvciAoY29uc3Qga2V5IG9mIGtleXMpIHtcbiAgICAgICAgICAgIHRoaXMuX21vdXNlW2tleV0gPSAwO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5faXRlbUlkID0gMDtcbiAgICAgICAgdGhpcy5tb3ZpbmcgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5kcmFnRWwgPSBudWxsO1xuICAgICAgICB0aGlzLmRyYWdSb290RWwgPSBudWxsO1xuICAgICAgICB0aGlzLmRyYWdEZXB0aCA9IDA7XG4gICAgICAgIHRoaXMucmVsYXRpdmVEZXB0aCA9IDA7XG4gICAgICAgIHRoaXMuaGFzTmV3Um9vdCA9IGZhbHNlO1xuICAgICAgICB0aGlzLnBvaW50RWwgPSBudWxsO1xuICAgIH1cblxuICAgIHB1YmxpYyBkcmFnU3RhcnRGcm9tSXRlbShldmVudCwgaXRlbSwgcGFyZW50TGlzdCkge1xuICAgICAgICBpZiAoIXRoaXMuX3JlZ2lzdGVySGFuZGxlRGlyZWN0aXZlKSB7XG4gICAgICAgICAgICB0aGlzLmRyYWdTdGFydChldmVudCwgaXRlbSwgcGFyZW50TGlzdCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIGRyYWdTdGFydChldmVudCwgaXRlbSwgcGFyZW50TGlzdCkge1xuXG4gICAgICAgIHRoaXMuX29sZExpc3RMZW5ndGggPSB0aGlzLmxpc3QubGVuZ3RoO1xuXG4gICAgICAgIGlmICghdGhpcy5vcHRpb25zLmRpc2FibGVEcmFnKSB7XG4gICAgICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgICAgICAgIGlmIChldmVudC5vcmlnaW5hbEV2ZW50KSB7XG4gICAgICAgICAgICAgICAgZXZlbnQgPSBldmVudC5vcmlnaW5hbEV2ZW50O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBhbGxvdyBvbmx5IGZpcnN0IG1vdXNlIGJ1dHRvblxuICAgICAgICAgICAgaWYgKGV2ZW50LnR5cGUuaW5kZXhPZignbW91c2UnKSA9PT0gMCkge1xuICAgICAgICAgICAgICAgIGlmIChldmVudC5idXR0b24gIT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKGV2ZW50LnRvdWNoZXMubGVuZ3RoICE9PSAxKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMucmVmLmRldGFjaCgpO1xuICAgICAgICAgICAgdGhpcy5fZHJhZ0luZGV4ID0gcGFyZW50TGlzdC5pbmRleE9mKGl0ZW0pO1xuICAgICAgICAgICAgdGhpcy5kcmFnTW9kZWwgPSBwYXJlbnRMaXN0LnNwbGljZShwYXJlbnRMaXN0LmluZGV4T2YoaXRlbSksIDEpWzBdO1xuXG4gICAgICAgICAgICBjb25zdCBkcmFnSXRlbSA9IGhlbHBlci5fY2xvc2VzdChldmVudC50YXJnZXQsIHRoaXMub3B0aW9ucy5pdGVtTm9kZU5hbWUpO1xuICAgICAgICAgICAgaWYgKGRyYWdJdGVtID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5fcGFyZW50RHJhZ0lkID0gTnVtYmVyLnBhcnNlSW50KFxuICAgICAgICAgICAgICAgIGRyYWdJdGVtLnBhcmVudEVsZW1lbnQucGFyZW50RWxlbWVudC5pZFxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgY29uc3QgZHJhZ1JlY3QgPSBkcmFnSXRlbS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblxuICAgICAgICAgICAgdGhpcy5fc2hvd01hc2tzKCk7XG4gICAgICAgICAgICB0aGlzLl9jcmVhdGVEcmFnQ2xvbmUoZXZlbnQsIGRyYWdJdGVtKTtcbiAgICAgICAgICAgIHRoaXMucmVuZGVyZXIuc2V0U3R5bGUodGhpcy5kcmFnRWwsICd3aWR0aCcsIGRyYWdSZWN0LndpZHRoICsgUFgpO1xuXG4gICAgICAgICAgICB0aGlzLl9jcmVhdGVQbGFjZWhvbGRlcihldmVudCwgZHJhZ0l0ZW0pO1xuICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5zZXRTdHlsZSh0aGlzLl9wbGFjZWhvbGRlciwgJ2hlaWdodCcsIGRyYWdSZWN0LmhlaWdodCArIFBYKTtcblxuICAgICAgICAgICAgdGhpcy5fY2FsY3VsYXRlRGVwdGgoKTtcbiAgICAgICAgICAgIHRoaXMuZHJhZy5lbWl0KHtcbiAgICAgICAgICAgICAgICBvcmlnaW5hbEV2ZW50OiBldmVudCxcbiAgICAgICAgICAgICAgICBpdGVtXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgdGhpcy5fY2FuY2VsTW91c2V1cCA9IHRoaXMucmVuZGVyZXIubGlzdGVuKFxuICAgICAgICAgICAgICAgIGRvY3VtZW50LFxuICAgICAgICAgICAgICAgICdtb3VzZXVwJyxcbiAgICAgICAgICAgICAgICB0aGlzLmRyYWdTdG9wLmJpbmQodGhpcylcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICB0aGlzLl9jYW5jZWxNb3VzZW1vdmUgPSB0aGlzLnJlbmRlcmVyLmxpc3RlbihcbiAgICAgICAgICAgICAgICBkb2N1bWVudCxcbiAgICAgICAgICAgICAgICAnbW91c2Vtb3ZlJyxcbiAgICAgICAgICAgICAgICB0aGlzLmRyYWdNb3ZlLmJpbmQodGhpcylcbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwdWJsaWMgZHJhZ1N0b3AoZXZlbnQpIHtcbiAgICAgICAgdGhpcy5fY2FuY2VsTW91c2V1cCgpO1xuICAgICAgICB0aGlzLl9jYW5jZWxNb3VzZW1vdmUoKTtcbiAgICAgICAgdGhpcy5faGlkZU1hc2tzKCk7XG5cbiAgICAgICAgaWYgKHRoaXMuZHJhZ0VsKSB7XG4gICAgICAgICAgICBjb25zdCBkcmFnZ2VkSWQgPSBOdW1iZXIucGFyc2VJbnQodGhpcy5kcmFnRWwuZmlyc3RFbGVtZW50Q2hpbGQuaWQpO1xuICAgICAgICAgICAgbGV0IHBsYWNlaG9sZGVyQ29udGFpbmVyID0gaGVscGVyLl9jbG9zZXN0KFxuICAgICAgICAgICAgICAgIHRoaXMuX3BsYWNlaG9sZGVyLFxuICAgICAgICAgICAgICAgIHRoaXMub3B0aW9ucy5pdGVtTm9kZU5hbWVcbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIGxldCBjaGFuZ2VkRWxlbWVudFBvc2l0aW9uID1cbiAgICAgICAgICAgICAgICB0aGlzLl9kcmFnSW5kZXggIT09XG4gICAgICAgICAgICAgICAgQXJyYXkucHJvdG90eXBlLmluZGV4T2YuY2FsbChcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcGxhY2Vob2xkZXIucGFyZW50RWxlbWVudC5jaGlsZHJlbixcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcGxhY2Vob2xkZXJcbiAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICBjb25zdCBpbmRleCA9IEFycmF5LnByb3RvdHlwZS5pbmRleE9mLmNhbGwodGhpcy5fcGxhY2Vob2xkZXIucGFyZW50RWxlbWVudC5jaGlsZHJlbiwgdGhpcy5fcGxhY2Vob2xkZXIpO1xuXG4gICAgICAgICAgICBpZiAoKHRoaXMuX2RyYWdJbmRleCA9PT0gaW5kZXgpICYmICh0aGlzLl9vbGRMaXN0TGVuZ3RoID09PSB0aGlzLmxpc3QubGVuZ3RoKSkge1xuICAgICAgICAgICAgICAgIGNoYW5nZWRFbGVtZW50UG9zaXRpb24gPSB0cnVlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBwbGFjZWhvbGRlciBpbiByb290XG4gICAgICAgICAgICBpZiAocGxhY2Vob2xkZXJDb250YWluZXIgPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmxpc3Quc3BsaWNlKFxuICAgICAgICAgICAgICAgICAgICBBcnJheS5wcm90b3R5cGUuaW5kZXhPZi5jYWxsKFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fcGxhY2Vob2xkZXIucGFyZW50RWxlbWVudC5jaGlsZHJlbixcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3BsYWNlaG9sZGVyXG4gICAgICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgICAgIDAsXG4gICAgICAgICAgICAgICAgICAgIHsgLi4udGhpcy5kcmFnTW9kZWwgfVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIHBhbGNlaG9sZGVyIG5lc3RlZFxuICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyQ29udGFpbmVyID0gaGVscGVyLl9maW5kT2JqZWN0SW5UcmVlKFxuICAgICAgICAgICAgICAgICAgICB0aGlzLmxpc3QsXG4gICAgICAgICAgICAgICAgICAgIE51bWJlci5wYXJzZUludChwbGFjZWhvbGRlckNvbnRhaW5lci5pZClcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIGlmICghcGxhY2Vob2xkZXJDb250YWluZXIuY2hpbGRyZW4pIHtcbiAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXJDb250YWluZXIuY2hpbGRyZW4gPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXJDb250YWluZXIuY2hpbGRyZW4ucHVzaCh7IC4uLnRoaXMuZHJhZ01vZGVsIH0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyQ29udGFpbmVyLmNoaWxkcmVuLnNwbGljZShcbiAgICAgICAgICAgICAgICAgICAgICAgIEFycmF5LnByb3RvdHlwZS5pbmRleE9mLmNhbGwoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fcGxhY2Vob2xkZXIucGFyZW50RWxlbWVudC5jaGlsZHJlbixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9wbGFjZWhvbGRlclxuICAgICAgICAgICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIDAsXG4gICAgICAgICAgICAgICAgICAgICAgICB7IC4uLnRoaXMuZHJhZ01vZGVsIH1cbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGluZGV4ID09PSB0aGlzLl9kcmFnSW5kZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgY2hhbmdlZEVsZW1lbnRQb3NpdGlvbiA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoIWNoYW5nZWRFbGVtZW50UG9zaXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgY2hhbmdlZEVsZW1lbnRQb3NpdGlvbiA9XG4gICAgICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlckNvbnRhaW5lclsnJCRpZCddICE9PSB0aGlzLl9wYXJlbnREcmFnSWQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLl9wbGFjZWhvbGRlci5wYXJlbnRFbGVtZW50LnJlbW92ZUNoaWxkKHRoaXMuX3BsYWNlaG9sZGVyKTtcbiAgICAgICAgICAgIHRoaXMuZHJhZ0VsLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGhpcy5kcmFnRWwpO1xuICAgICAgICAgICAgdGhpcy5kcmFnRWwucmVtb3ZlKCk7XG4gICAgICAgICAgICB0aGlzLnJlc2V0KCk7XG5cbiAgICAgICAgICAgIHRoaXMubGlzdENoYW5nZS5lbWl0KHRoaXMubGlzdCk7XG4gICAgICAgICAgICB0aGlzLmRyb3AuZW1pdCh7XG4gICAgICAgICAgICAgICAgb3JpZ2luYWxFdmVudDogZXZlbnQsXG4gICAgICAgICAgICAgICAgZGVzdGluYXRpb246IHBsYWNlaG9sZGVyQ29udGFpbmVyLFxuICAgICAgICAgICAgICAgIGl0ZW06IHRoaXMuZHJhZ01vZGVsLFxuICAgICAgICAgICAgICAgIGNoYW5nZWRFbGVtZW50UG9zaXRpb25cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5yZWYucmVhdHRhY2goKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHB1YmxpYyBkcmFnTW92ZShldmVudCkge1xuICAgICAgICBpZiAodGhpcy5kcmFnRWwpIHtcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgICAgICAgIGlmIChldmVudC5vcmlnaW5hbEV2ZW50KSB7XG4gICAgICAgICAgICAgICAgZXZlbnQgPSBldmVudC5vcmlnaW5hbEV2ZW50O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5fbW92ZShldmVudC50eXBlLmluZGV4T2YoJ21vdXNlJykgPT09IDAgPyBldmVudCA6IGV2ZW50LnRvdWNoZXNbMF0pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIGV4cGFuZEFsbCgpIHtcbiAgICAgICAgaGVscGVyLl90cmF2ZXJzZUNoaWxkcmVuKHRoaXMuX2xpc3QsIGl0ZW0gPT4ge1xuICAgICAgICAgICAgaXRlbVsnJCRleHBhbmRlZCddID0gdHJ1ZTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMucmVmLm1hcmtGb3JDaGVjaygpO1xuICAgIH1cblxuICAgIHB1YmxpYyBjb2xsYXBzZUFsbCgpIHtcbiAgICAgICAgaGVscGVyLl90cmF2ZXJzZUNoaWxkcmVuKHRoaXMuX2xpc3QsIGl0ZW0gPT4ge1xuICAgICAgICAgICAgaXRlbVsnJCRleHBhbmRlZCddID0gZmFsc2U7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnJlZi5tYXJrRm9yQ2hlY2soKTtcbiAgICB9XG59XG4iXX0=