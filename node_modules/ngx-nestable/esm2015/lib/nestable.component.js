/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { ChangeDetectionStrategy, ChangeDetectorRef, Component, ElementRef, EventEmitter, Input, NgZone, Output, Renderer2, ViewContainerRef, ViewEncapsulation } from '@angular/core';
import * as helper from './nestable.helper';
import { defaultSettings, DRAG_START, EXPAND_COLLAPSE, mouse, REGISTER_HANDLE } from './nestable.constant';
/** @type {?} */
import * as ɵngcc0 from '@angular/core';
import * as ɵngcc1 from '@angular/common';

function NestableComponent_ng_container_0_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainer(0);
} }
function NestableComponent_ng_template_1_li_1_ng_container_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainer(0);
} }
function NestableComponent_ng_template_1_li_1_ng_container_2_ng_container_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainer(0);
} }
const _c0 = function (a0, a1) { return { nestable: a0, depth: a1 }; };
function NestableComponent_ng_template_1_li_1_ng_container_2_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵtemplate(1, NestableComponent_ng_template_1_li_1_ng_container_2_ng_container_1_Template, 1, 0, "ng-container", 0);
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const item_r8 = ɵngcc0.ɵɵnextContext().$implicit;
    const depth_r6 = ɵngcc0.ɵɵnextContext().depth;
    ɵngcc0.ɵɵnextContext();
    const _r1 = ɵngcc0.ɵɵreference(2);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngTemplateOutlet", _r1)("ngTemplateOutletContext", ɵngcc0.ɵɵpureFunction2(2, _c0, item_r8.children, depth_r6 + 1));
} }
const _c1 = function (a0, a1, a2) { return { nestable: a0, item: a1, depth: a2 }; };
function NestableComponent_ng_template_1_li_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "li", 4);
    ɵngcc0.ɵɵtemplate(1, NestableComponent_ng_template_1_li_1_ng_container_1_Template, 1, 0, "ng-container", 0);
    ɵngcc0.ɵɵtemplate(2, NestableComponent_ng_template_1_li_1_ng_container_2_Template, 2, 5, "ng-container", 5);
    ɵngcc0.ɵɵelement(3, "ul");
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const item_r8 = ctx.$implicit;
    const ctx_r14 = ɵngcc0.ɵɵnextContext();
    const nestable_r5 = ctx_r14.nestable;
    const depth_r6 = ctx_r14.depth;
    const ctx_r7 = ɵngcc0.ɵɵnextContext();
    const _r3 = ɵngcc0.ɵɵreference(4);
    ɵngcc0.ɵɵclassMap(ctx_r7.options.itemClass);
    ɵngcc0.ɵɵproperty("id", item_r8.$$id);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngTemplateOutlet", _r3)("ngTemplateOutletContext", ɵngcc0.ɵɵpureFunction3(10, _c1, nestable_r5, item_r8, depth_r6));
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", item_r8.children && item_r8.$$expanded);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵclassMap(ctx_r7.options.listClass);
    ɵngcc0.ɵɵstyleProp("padding-left", ctx_r7.options.threshold, "px");
} }
function NestableComponent_ng_template_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "ul");
    ɵngcc0.ɵɵtemplate(1, NestableComponent_ng_template_1_li_1_Template, 4, 14, "li", 3);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const nestable_r5 = ctx.nestable;
    const depth_r6 = ctx.depth;
    const ctx_r2 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵclassMap(ctx_r2.options.listClass);
    ɵngcc0.ɵɵstyleProp("padding-left", depth_r6 ? ctx_r2.options.threshold : 0, "px");
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngForOf", nestable_r5);
} }
function NestableComponent_ng_template_3_ng_container_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainer(0);
} }
const _c2 = function (a0, a1) { return { item: a0, parentList: a1 }; };
const _c3 = function (a0, a1) { return { $implicit: a0, depth: a1 }; };
function NestableComponent_ng_template_3_Template(rf, ctx) { if (rf & 1) {
    const _r20 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementStart(0, "div", 6);
    ɵngcc0.ɵɵlistener("mousedown", function NestableComponent_ng_template_3_Template_div_mousedown_0_listener($event) { ɵngcc0.ɵɵrestoreView(_r20); const item_r16 = ctx.item; const parentList_r15 = ctx.nestable; const ctx_r19 = ɵngcc0.ɵɵnextContext(); return ctx_r19.dragStartFromItem($event, item_r16, parentList_r15); });
    ɵngcc0.ɵɵtemplate(1, NestableComponent_ng_template_3_ng_container_1_Template, 1, 0, "ng-container", 0);
    ɵngcc0.ɵɵelement(2, "div", 7);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const parentList_r15 = ctx.nestable;
    const item_r16 = ctx.item;
    const depth_r17 = ctx.depth;
    const ctx_r4 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngTemplateOutlet", ctx_r4.template)("ngTemplateOutletContext", ɵngcc0.ɵɵpureFunction2(5, _c3, ɵngcc0.ɵɵpureFunction2(2, _c2, item_r16, parentList_r15), depth_r17));
} }
const _c4 = function (a0) { return { nestable: a0, depth: 0 }; };
const PX = 'px';
const ɵ0 = /**
 * @return {?}
 */
function () {
    /** @type {?} */
    const el = document.createElement('div');
    /** @type {?} */
    const docEl = document.documentElement;
    if (!('pointerEvents' in el.style)) {
        return false;
    }
    el.style.pointerEvents = 'auto';
    el.style.pointerEvents = 'x';
    docEl.appendChild(el);
    /** @type {?} */
    const supports = window.getComputedStyle &&
        window.getComputedStyle(el, '').pointerEvents === 'auto';
    docEl.removeChild(el);
    return !!supports;
};
/** @type {?} */
const hasPointerEvents = ((ɵ0))();
export class NestableComponent {
    /**
     * @param {?} ref
     * @param {?} renderer
     * @param {?} el
     * @param {?} zone
     */
    constructor(ref, renderer, el, zone) {
        this.ref = ref;
        this.renderer = renderer;
        this.el = el;
        this.zone = zone;
        this.listChange = new EventEmitter();
        this.drop = new EventEmitter();
        this.drag = new EventEmitter();
        this.disclosure = new EventEmitter();
        this.options = defaultSettings;
        this.disableDrag = false;
        this.dragRootEl = null;
        this.dragEl = null;
        this.dragModel = null;
        this.moving = false;
        /**
         * Dragged element contains children, and those children contain other children and so on...
         * This property gives you the number of generations contained within the dragging item.
         */
        this.dragDepth = 0;
        /**
         * The depth of dragging item relative to element root (ngx-nestable)
         */
        this.relativeDepth = 0;
        this.hasNewRoot = false;
        this.pointEl = null;
        this.items = [];
        this._componentActive = false;
        this._mouse = Object.assign({}, mouse);
        this._list = [];
        this._itemId = 0;
        this._registerHandleDirective = false;
    }
    /**
     * @return {?}
     */
    get list() {
        return this._list;
    }
    /**
     * @param {?} list
     * @return {?}
     */
    set list(list) {
        this._list = list;
        this._generateItemIds();
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        // set/extend default options
        this._componentActive = true;
        /** @type {?} */
        const optionKeys = Object.keys(defaultSettings);
        for (const key of optionKeys) {
            if (typeof this.options[key] === 'undefined') {
                this.options[key] = defaultSettings[key];
            }
        }
        this._generateItemIds();
        this._generateItemExpanded();
        this._createHandleListener();
    }
    /**
     * @return {?}
     */
    ngOnDestroy() { }
    /**
     * @private
     * @return {?}
     */
    _generateItemIds() {
        helper._traverseChildren(this._list, (/**
         * @param {?} item
         * @return {?}
         */
        item => {
            item['$$id'] = this._itemId++;
        }));
    }
    /**
     * @private
     * @return {?}
     */
    _generateItemExpanded() {
        helper._traverseChildren(this._list, (/**
         * @param {?} item
         * @return {?}
         */
        item => {
            if (typeof item.expanded === 'undefined') {
                item['$$expanded'] = true;
            }
            else {
                item['$$expanded'] = item.expanded;
            }
        }));
    }
    /**
     * @private
     * @return {?}
     */
    _createHandleListener() {
        this.renderer.listen(this.el.nativeElement, REGISTER_HANDLE, (/**
         * @return {?}
         */
        () => {
            this._registerHandleDirective = true;
        }));
        this.renderer.listen(this.el.nativeElement, DRAG_START, (/**
         * @param {?} data
         * @return {?}
         */
        data => {
            this.dragStart(data.detail.event, data.detail.param.item, data.detail.param.parentList);
        }));
        this.renderer.listen(this.el.nativeElement, EXPAND_COLLAPSE, (/**
         * @param {?} data
         * @return {?}
         */
        data => {
            this.disclosure.emit({
                item: data.detail.item,
                expanded: data.detail.item['$$expanded']
            });
        }));
    }
    /**
     * @private
     * @param {?} event
     * @param {?} dragItem
     * @return {?}
     */
    _createDragClone(event, dragItem) {
        this._mouseStart(event, dragItem);
        if (!this._registerHandleDirective) {
            this._mouse.offsetY = dragItem.nextElementSibling
                ? dragItem.nextElementSibling.clientHeight / 2
                : dragItem.clientHeight / 2;
        }
        // create drag clone
        this.dragEl = document.createElement(this.options.listNodeName);
        document.body.appendChild(this.dragEl);
        this.renderer.addClass(this.dragEl, this.options.dragClass);
        // add drag clone to body and set css
        this.renderer.setStyle(this.dragEl, 'left', event.pageX - this._mouse.offsetX + PX);
        this.renderer.setStyle(this.dragEl, 'top', event.pageY - this._mouse.offsetY + PX);
        this.renderer.setStyle(this.dragEl, 'position', 'absolute');
        this.renderer.setStyle(this.dragEl, 'z-index', 9999);
        this.renderer.setStyle(this.dragEl, 'pointer-events', 'none');
    }
    /**
     * @private
     * @param {?} event
     * @param {?} dragItem
     * @return {?}
     */
    _createPlaceholder(event, dragItem) {
        this._placeholder = document.createElement('div');
        this._placeholder.classList.add(this.options.placeClass);
        helper._insertAfter(this._placeholder, dragItem);
        dragItem.parentNode.removeChild(dragItem);
        this.dragEl.appendChild(dragItem);
        this.dragRootEl = dragItem;
    }
    /**
     * Sets depth proerties (relative and drag)
     * @private
     * @return {?}
     */
    _calculateDepth() {
        // total depth of dragging item
        /** @type {?} */
        let depth;
        /** @type {?} */
        const items = this.dragEl.querySelectorAll(this.options.itemNodeName);
        for (let i = 0; i < items.length; i++) {
            depth = helper._getParents(items[i], this.dragEl).length;
            if (depth > this.dragDepth) {
                this.dragDepth = depth;
            }
        }
        // depth relative to root
        this.relativeDepth = helper._getParents(this._placeholder, this.el.nativeElement.querySelector(this.options.listNodeName)).length;
    }
    /**
     * @private
     * @param {?} event
     * @param {?} dragItem
     * @return {?}
     */
    _mouseStart(event, dragItem) {
        this._mouse.offsetX = event.pageX - helper._offset(dragItem).left;
        this._mouse.offsetY = event.pageY - helper._offset(dragItem).top;
        this._mouse.startX = this._mouse.lastX = event.pageX;
        this._mouse.startY = this._mouse.lastY = event.pageY;
    }
    /**
     * @private
     * @param {?} event
     * @return {?}
     */
    _mouseUpdate(event) {
        // mouse position last events
        this._mouse.lastX = this._mouse.nowX;
        this._mouse.lastY = this._mouse.nowY;
        // mouse position this events
        this._mouse.nowX = event.pageX;
        this._mouse.nowY = event.pageY;
        // distance mouse moved between events
        this._mouse.distX = this._mouse.nowX - this._mouse.lastX;
        this._mouse.distY = this._mouse.nowY - this._mouse.lastY;
        // direction mouse was moving
        this._mouse.lastDirX = this._mouse.dirX;
        this._mouse.lastDirY = this._mouse.dirY;
        // direction mouse is now moving (on both axis)
        this._mouse.dirX =
            this._mouse.distX === 0 ? 0 : this._mouse.distX > 0 ? 1 : -1;
        this._mouse.dirY =
            this._mouse.distY === 0 ? 0 : this._mouse.distY > 0 ? 1 : -1;
    }
    /**
     * @private
     * @return {?}
     */
    _showMasks() {
        /** @type {?} */
        const masks = this.el.nativeElement.getElementsByClassName('nestable-item-mask');
        for (let i = 0; i < masks.length; i++) {
            masks[i].style.display = 'block';
        }
    }
    /**
     * @private
     * @return {?}
     */
    _hideMasks() {
        /** @type {?} */
        const masks = this.el.nativeElement.getElementsByClassName('nestable-item-mask');
        for (let i = 0; i < masks.length; i++) {
            masks[i].style.display = 'none';
        }
    }
    /**
     * calc mouse traverse distance on axis
     * @private
     * @param {?} m - mouse
     * @return {?}
     */
    _calcMouseDistance(m) {
        m.distAxX += Math.abs(m.distX);
        if (m.dirX !== 0 && m.dirX !== m.lastDirX) {
            m.distAxX = 0;
        }
        m.distAxY += Math.abs(m.distY);
        if (m.dirY !== 0 && m.dirY !== m.lastDirY) {
            m.distAxY = 0;
        }
    }
    /**
     * @private
     * @param {?} event
     * @return {?}
     */
    _move(event) {
        /** @type {?} */
        let depth;
        /** @type {?} */
        let list;
        /** @type {?} */
        const dragRect = this.dragEl.getBoundingClientRect();
        this.renderer.setStyle(this.dragEl, 'left', event.pageX - this._mouse.offsetX + PX);
        this.renderer.setStyle(this.dragEl, 'top', event.pageY - this._mouse.offsetY + PX);
        this._mouseUpdate(event);
        // axis mouse is now moving on
        /** @type {?} */
        const newAx = Math.abs(this._mouse.distX) > Math.abs(this._mouse.distY) ? 1 : 0;
        // do nothing on first move
        if (!this._mouse.moving) {
            this._mouse.dirAx = newAx;
            this._mouse.moving = 1;
            return;
        }
        // calc distance moved on this axis (and direction)
        if (this._mouse.dirAx !== newAx) {
            this._mouse.distAxX = 0;
            this._mouse.distAxY = 0;
        }
        else {
            this._calcMouseDistance(this._mouse);
        }
        this._mouse.dirAx = newAx;
        // find list item under cursor
        if (!hasPointerEvents) {
            this.dragEl.style.visibility = 'hidden';
        }
        /** @type {?} */
        const pointEl = document.elementFromPoint(event.pageX - document.body.scrollLeft, event.pageY - (window.pageYOffset || document.documentElement.scrollTop));
        if (!hasPointerEvents) {
            this.dragEl.style.visibility = 'visible';
        }
        if (pointEl &&
            (pointEl.classList.contains('nestable-item-mask') ||
                pointEl.classList.contains(this.options.placeClass))) {
            this.pointEl = pointEl.parentElement.parentElement;
        }
        else {
            return;
        }
        /**
         * move horizontal
         */
        if (!this.options.fixedDepth &&
            this._mouse.dirAx &&
            this._mouse.distAxX >= this.options.threshold) {
            // reset move distance on x-axis for new phase
            this._mouse.distAxX = 0;
            /** @type {?} */
            const previous = this._placeholder.previousElementSibling;
            // increase horizontal level if previous sibling exists, is not collapsed, and can have children
            if (this._mouse.distX > 0 && previous) {
                list = previous.querySelectorAll(this.options.listNodeName);
                list = list[list.length - 1];
                // check if depth limit has reached
                depth = helper._getParents(this._placeholder, this.el.nativeElement.querySelector(this.options.listNodeName)).length;
                if (depth + this.dragDepth <= this.options.maxDepth) {
                    // create new sub-level if one doesn't exist
                    if (!list) {
                        list = document.createElement(this.options.listNodeName);
                        list.style.paddingLeft = this.options.threshold + PX;
                        list.appendChild(this._placeholder);
                        previous.appendChild(list);
                        // this.setParent(previous);
                    }
                    else {
                        // else append to next level up
                        list = previous.querySelector(`:scope > ${this.options.listNodeName}`);
                        list.appendChild(this._placeholder);
                    }
                }
            }
            // decrease horizontal level
            if (this._mouse.distX < 0) {
                // we can't decrease a level if an item preceeds the current one
                /** @type {?} */
                const next = document.querySelector(`.${this.options.placeClass} + ${this.options.itemNodeName}`);
                /** @type {?} */
                const parentElement = this._placeholder.parentElement;
                if (!next && parentElement) {
                    /** @type {?} */
                    const closestItem = helper._closest(this._placeholder, this.options.itemNodeName);
                    if (closestItem) {
                        parentElement.removeChild(this._placeholder);
                        helper._insertAfter(this._placeholder, closestItem);
                    }
                }
            }
        }
        if (!pointEl.classList.contains('nestable-item-mask')) {
            return;
        }
        // find root list of item under cursor
        /** @type {?} */
        const pointElRoot = helper._closest(this.pointEl, `.${this.options.rootClass}`);
        /** @type {?} */
        const isNewRoot = pointElRoot
            ? this.dragRootEl.dataset['nestable-id'] !==
                pointElRoot.dataset['nestable-id']
            : false;
        /**
         * move vertical
         */
        if (!this._mouse.dirAx || isNewRoot) {
            // check if groups match if dragging over new root
            if (isNewRoot &&
                this.options.group !== pointElRoot.dataset['nestable-group']) {
                return;
            }
            // check depth limit
            depth =
                this.dragDepth -
                    1 +
                    helper._getParents(this.pointEl, this.el.nativeElement.querySelector(this.options.listNodeName)).length;
            if (depth > this.options.maxDepth) {
                return;
            }
            /** @type {?} */
            const before = event.pageY <
                helper._offset(this.pointEl).top + this.pointEl.clientHeight / 2;
            /** @type {?} */
            const placeholderParent = this._placeholder.parentNode;
            // get point element depth
            /** @type {?} */
            let pointRelativeDepth;
            pointRelativeDepth = helper._getParents(this.pointEl, this.el.nativeElement.querySelector(this.options.listNodeName)).length;
            if (this.options.fixedDepth) {
                if (pointRelativeDepth === this.relativeDepth - 1) {
                    /** @type {?} */
                    const childList = this.pointEl.querySelector(this.options.listNodeName);
                    if (!childList.children.length) {
                        childList.appendChild(this._placeholder);
                    }
                }
                else if (pointRelativeDepth === this.relativeDepth) {
                    if (before) {
                        this.pointEl.parentElement.insertBefore(this._placeholder, this.pointEl);
                    }
                    else {
                        helper._insertAfter(this._placeholder, this.pointEl);
                    }
                    if (Array.prototype.indexOf.call(this.pointEl.parentElement.children, this.pointEl) ===
                        this.pointEl.parentElement.children.length - 1) {
                        helper._insertAfter(this._placeholder, this.pointEl);
                    }
                }
            }
            else if (before) {
                this.pointEl.parentElement.insertBefore(this._placeholder, this.pointEl);
            }
            else {
                helper._insertAfter(this._placeholder, this.pointEl);
            }
        }
    }
    /**
     * @return {?}
     */
    reset() {
        /** @type {?} */
        const keys = Object.keys(this._mouse);
        for (const key of keys) {
            this._mouse[key] = 0;
        }
        this._itemId = 0;
        this.moving = false;
        this.dragEl = null;
        this.dragRootEl = null;
        this.dragDepth = 0;
        this.relativeDepth = 0;
        this.hasNewRoot = false;
        this.pointEl = null;
    }
    /**
     * @param {?} event
     * @param {?} item
     * @param {?} parentList
     * @return {?}
     */
    dragStartFromItem(event, item, parentList) {
        if (!this._registerHandleDirective) {
            this.dragStart(event, item, parentList);
        }
    }
    /**
     * @private
     * @param {?} event
     * @param {?} item
     * @param {?} parentList
     * @return {?}
     */
    dragStart(event, item, parentList) {
        this._oldListLength = this.list.length;
        if (!this.options.disableDrag) {
            event.stopPropagation();
            event.preventDefault();
            if (event.originalEvent) {
                event = event.originalEvent;
            }
            // allow only first mouse button
            if (event.type.indexOf('mouse') === 0) {
                if (event.button !== 0) {
                    return;
                }
            }
            else {
                if (event.touches.length !== 1) {
                    return;
                }
            }
            this.ref.detach();
            this._dragIndex = parentList.indexOf(item);
            this.dragModel = parentList.splice(parentList.indexOf(item), 1)[0];
            /** @type {?} */
            const dragItem = helper._closest(event.target, this.options.itemNodeName);
            if (dragItem === null) {
                return;
            }
            this._parentDragId = Number.parseInt(dragItem.parentElement.parentElement.id);
            /** @type {?} */
            const dragRect = dragItem.getBoundingClientRect();
            this._showMasks();
            this._createDragClone(event, dragItem);
            this.renderer.setStyle(this.dragEl, 'width', dragRect.width + PX);
            this._createPlaceholder(event, dragItem);
            this.renderer.setStyle(this._placeholder, 'height', dragRect.height + PX);
            this._calculateDepth();
            this.drag.emit({
                originalEvent: event,
                item
            });
            this._cancelMouseup = this.renderer.listen(document, 'mouseup', this.dragStop.bind(this));
            this._cancelMousemove = this.renderer.listen(document, 'mousemove', this.dragMove.bind(this));
        }
    }
    /**
     * @param {?} event
     * @return {?}
     */
    dragStop(event) {
        this._cancelMouseup();
        this._cancelMousemove();
        this._hideMasks();
        if (this.dragEl) {
            /** @type {?} */
            const draggedId = Number.parseInt(this.dragEl.firstElementChild.id);
            /** @type {?} */
            let placeholderContainer = helper._closest(this._placeholder, this.options.itemNodeName);
            /** @type {?} */
            let changedElementPosition = this._dragIndex !==
                Array.prototype.indexOf.call(this._placeholder.parentElement.children, this._placeholder);
            /** @type {?} */
            const index = Array.prototype.indexOf.call(this._placeholder.parentElement.children, this._placeholder);
            if ((this._dragIndex === index) && (this._oldListLength === this.list.length)) {
                changedElementPosition = true;
            }
            // placeholder in root
            if (placeholderContainer === null) {
                this.list.splice(Array.prototype.indexOf.call(this._placeholder.parentElement.children, this._placeholder), 0, Object.assign({}, this.dragModel));
            }
            else {
                // palceholder nested
                placeholderContainer = helper._findObjectInTree(this.list, Number.parseInt(placeholderContainer.id));
                if (!placeholderContainer.children) {
                    placeholderContainer.children = [];
                    placeholderContainer.children.push(Object.assign({}, this.dragModel));
                }
                else {
                    placeholderContainer.children.splice(Array.prototype.indexOf.call(this._placeholder.parentElement.children, this._placeholder), 0, Object.assign({}, this.dragModel));
                }
                if (index === this._dragIndex) {
                    changedElementPosition = false;
                }
                if (!changedElementPosition) {
                    changedElementPosition =
                        placeholderContainer['$$id'] !== this._parentDragId;
                }
            }
            this._placeholder.parentElement.removeChild(this._placeholder);
            this.dragEl.parentNode.removeChild(this.dragEl);
            this.dragEl.remove();
            this.reset();
            this.listChange.emit(this.list);
            this.drop.emit({
                originalEvent: event,
                destination: placeholderContainer,
                item: this.dragModel,
                changedElementPosition
            });
            this.ref.reattach();
        }
    }
    /**
     * @param {?} event
     * @return {?}
     */
    dragMove(event) {
        if (this.dragEl) {
            event.preventDefault();
            if (event.originalEvent) {
                event = event.originalEvent;
            }
            this._move(event.type.indexOf('mouse') === 0 ? event : event.touches[0]);
        }
    }
    /**
     * @return {?}
     */
    expandAll() {
        helper._traverseChildren(this._list, (/**
         * @param {?} item
         * @return {?}
         */
        item => {
            item['$$expanded'] = true;
        }));
        this.ref.markForCheck();
    }
    /**
     * @return {?}
     */
    collapseAll() {
        helper._traverseChildren(this._list, (/**
         * @param {?} item
         * @return {?}
         */
        item => {
            item['$$expanded'] = false;
        }));
        this.ref.markForCheck();
    }
}
NestableComponent.ɵfac = function NestableComponent_Factory(t) { return new (t || NestableComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ChangeDetectorRef), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.Renderer2), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ElementRef), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.NgZone)); };
NestableComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: NestableComponent, selectors: [["ngx-nestable"]], inputs: { options: "options", disableDrag: "disableDrag", list: "list", template: "template" }, outputs: { listChange: "listChange", drop: "drop", drag: "drag", disclosure: "disclosure" }, decls: 5, vars: 4, consts: [[4, "ngTemplateOutlet", "ngTemplateOutletContext"], ["nestableList", ""], ["nestableItem", ""], [3, "class", "id", 4, "ngFor", "ngForOf"], [3, "id"], [4, "ngIf"], [1, "nestable-item-container", "mat-list-item", 3, "mousedown"], [1, "nestable-item-mask"]], template: function NestableComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵtemplate(0, NestableComponent_ng_container_0_Template, 1, 0, "ng-container", 0);
        ɵngcc0.ɵɵtemplate(1, NestableComponent_ng_template_1_Template, 2, 5, "ng-template", null, 1, ɵngcc0.ɵɵtemplateRefExtractor);
        ɵngcc0.ɵɵtemplate(3, NestableComponent_ng_template_3_Template, 3, 8, "ng-template", null, 2, ɵngcc0.ɵɵtemplateRefExtractor);
    } if (rf & 2) {
        const _r1 = ɵngcc0.ɵɵreference(2);
        ɵngcc0.ɵɵproperty("ngTemplateOutlet", _r1)("ngTemplateOutletContext", ɵngcc0.ɵɵpureFunction1(2, _c4, ctx.list));
    } }, directives: [ɵngcc1.NgTemplateOutlet, ɵngcc1.NgForOf, ɵngcc1.NgIf], styles: ["@import url(https://fonts.googleapis.com/css?family=Roboto);ul .dd-placeholder{margin:5px 0;padding:0;min-height:30px;background:#f2fbff;border:1px dashed #b6bcbf;box-sizing:border-box}ul li .nestable-item-mask{display:none;position:absolute;top:0;bottom:0;right:0;left:0;z-index:9998}ul li .nestable-expand-button{display:block;position:relative;cursor:pointer;float:left;width:25px;height:14px;padding:0;white-space:nowrap;overflow:hidden;border:0;background:0 0;font-size:18px;line-height:1;text-align:center;font-weight:700;outline:0}ul li .nestable-item-container{position:relative;display:flex;flex-direction:row;align-items:center;color:rgba(0,0,0,.87);min-height:32px;font-size:16px;font-family:Roboto,sans-serif;cursor:pointer;outline:0;margin-bottom:2px;padding-left:8px}ul li .nestable-item-container:hover{background:rgba(0,0,0,.04)}ol,ul{list-style:none}"], encapsulation: 2, changeDetection: 0 });
/** @nocollapse */
NestableComponent.ctorParameters = () => [
    { type: ChangeDetectorRef },
    { type: Renderer2 },
    { type: ElementRef },
    { type: NgZone }
];
NestableComponent.propDecorators = {
    listChange: [{ type: Output }],
    drop: [{ type: Output }],
    drag: [{ type: Output }],
    disclosure: [{ type: Output }],
    template: [{ type: Input }],
    options: [{ type: Input }],
    disableDrag: [{ type: Input }],
    list: [{ type: Input }]
};
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(NestableComponent, [{
        type: Component,
        args: [{
                selector: 'ngx-nestable',
                template: "<ng-container *ngTemplateOutlet=\"nestableList; context:{nestable: list, depth: 0}\">\n</ng-container>\n\n<ng-template #nestableList let-nestable=\"nestable\" let-depth=\"depth\">\n    <ul [style.padding-left.px]=\"depth ? options.threshold : 0\"\n        [class]=\"options.listClass\">\n        <li [class]=\"options.itemClass\" [id]=\"item.$$id\" *ngFor=\"let item of nestable\">\n\n            <ng-container *ngTemplateOutlet=\"nestableItem; context:{nestable: nestable, item: item, depth: depth}\">\n            </ng-container>\n\n            <ng-container *ngIf=\"item.children && item.$$expanded\">\n                <ng-container *ngTemplateOutlet=\"nestableList; context:{nestable: item.children, depth: depth + 1}\">\n                </ng-container>\n            </ng-container>\n\n            <ul [class]=\"options.listClass\" [style.padding-left.px]=\"options.threshold\"></ul>\n        </li>\n    </ul>\n</ng-template>\n\n<ng-template #nestableItem let-parentList=\"nestable\" let-item=\"item\" let-depth=\"depth\">\n    <div class=\"nestable-item-container mat-list-item\" (mousedown)=\"dragStartFromItem($event, item, parentList)\">\n        <ng-container\n            *ngTemplateOutlet=\"template; context:{$implicit: {item: item, parentList: parentList}, depth: depth}\">\n        </ng-container>\n\n        <div class=\"nestable-item-mask\"></div>\n    </div>\n</ng-template>\n",
                encapsulation: ViewEncapsulation.None,
                changeDetection: ChangeDetectionStrategy.OnPush,
                styles: ["@import url(https://fonts.googleapis.com/css?family=Roboto);ul .dd-placeholder{margin:5px 0;padding:0;min-height:30px;background:#f2fbff;border:1px dashed #b6bcbf;box-sizing:border-box}ul li .nestable-item-mask{display:none;position:absolute;top:0;bottom:0;right:0;left:0;z-index:9998}ul li .nestable-expand-button{display:block;position:relative;cursor:pointer;float:left;width:25px;height:14px;padding:0;white-space:nowrap;overflow:hidden;border:0;background:0 0;font-size:18px;line-height:1;text-align:center;font-weight:700;outline:0}ul li .nestable-item-container{position:relative;display:flex;flex-direction:row;align-items:center;color:rgba(0,0,0,.87);min-height:32px;font-size:16px;font-family:Roboto,sans-serif;cursor:pointer;outline:0;margin-bottom:2px;padding-left:8px}ul li .nestable-item-container:hover{background:rgba(0,0,0,.04)}ol,ul{list-style:none}"]
            }]
    }], function () { return [{ type: ɵngcc0.ChangeDetectorRef }, { type: ɵngcc0.Renderer2 }, { type: ɵngcc0.ElementRef }, { type: ɵngcc0.NgZone }]; }, { listChange: [{
            type: Output
        }], drop: [{
            type: Output
        }], drag: [{
            type: Output
        }], disclosure: [{
            type: Output
        }], options: [{
            type: Input
        }], disableDrag: [{
            type: Input
        }], list: [{
            type: Input
        }], template: [{
            type: Input
        }] }); })();
if (false) {
    /** @type {?} */
    NestableComponent.prototype.listChange;
    /** @type {?} */
    NestableComponent.prototype.drop;
    /** @type {?} */
    NestableComponent.prototype.drag;
    /** @type {?} */
    NestableComponent.prototype.disclosure;
    /** @type {?} */
    NestableComponent.prototype.template;
    /** @type {?} */
    NestableComponent.prototype.options;
    /** @type {?} */
    NestableComponent.prototype.disableDrag;
    /** @type {?} */
    NestableComponent.prototype.dragRootEl;
    /** @type {?} */
    NestableComponent.prototype.dragEl;
    /** @type {?} */
    NestableComponent.prototype.dragModel;
    /** @type {?} */
    NestableComponent.prototype.moving;
    /**
     * Dragged element contains children, and those children contain other children and so on...
     * This property gives you the number of generations contained within the dragging item.
     * @type {?}
     */
    NestableComponent.prototype.dragDepth;
    /**
     * The depth of dragging item relative to element root (ngx-nestable)
     * @type {?}
     */
    NestableComponent.prototype.relativeDepth;
    /** @type {?} */
    NestableComponent.prototype.hasNewRoot;
    /** @type {?} */
    NestableComponent.prototype.pointEl;
    /** @type {?} */
    NestableComponent.prototype.items;
    /**
     * @type {?}
     * @private
     */
    NestableComponent.prototype._componentActive;
    /**
     * @type {?}
     * @private
     */
    NestableComponent.prototype._mouse;
    /**
     * @type {?}
     * @private
     */
    NestableComponent.prototype._list;
    /**
     * @type {?}
     * @private
     */
    NestableComponent.prototype._cancelMousemove;
    /**
     * @type {?}
     * @private
     */
    NestableComponent.prototype._cancelMouseup;
    /**
     * @type {?}
     * @private
     */
    NestableComponent.prototype._placeholder;
    /**
     * @type {?}
     * @private
     */
    NestableComponent.prototype._itemId;
    /**
     * @type {?}
     * @private
     */
    NestableComponent.prototype._registerHandleDirective;
    /**
     * @type {?}
     * @private
     */
    NestableComponent.prototype._dragIndex;
    /**
     * @type {?}
     * @private
     */
    NestableComponent.prototype._parentDragId;
    /**
     * @type {?}
     * @private
     */
    NestableComponent.prototype._oldListLength;
    /**
     * @type {?}
     * @private
     */
    NestableComponent.prototype.ref;
    /**
     * @type {?}
     * @private
     */
    NestableComponent.prototype.renderer;
    /**
     * @type {?}
     * @private
     */
    NestableComponent.prototype.el;
    /**
     * @type {?}
     * @private
     */
    NestableComponent.prototype.zone;
}
export { ɵ0 };

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmVzdGFibGUuY29tcG9uZW50LmpzIiwic291cmNlcyI6WyJuZ3gtbmVzdGFibGUvbGliL25lc3RhYmxlLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUNILHVCQUF1QixFQUN2QixpQkFBaUIsRUFDakIsU0FBUyxFQUNULFVBQVUsRUFDVixZQUFZLEVBQ1osS0FBSyxFQUNMLE1BQU0sRUFHTixNQUFNLEVBQ04sU0FBUyxFQUNULGdCQUFnQixFQUNoQixpQkFBaUIsRUFDcEIsTUFBTSxlQUFlLENBQUM7QUFFdkIsT0FBTyxLQUFLLE1BQU0sTUFBTSxtQkFBbUIsQ0FBQztBQUU1QyxPQUFPLEVBQUUsZUFBZSxFQUFFLFVBQVUsRUFBRSxlQUFlLEVBQUUsS0FBSyxFQUFFLGVBQWUsRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBQzNHOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFDZ0IsTUFBVixFQUFFLEdBQUcsSUFBSTtBQUNmO0FBQWU7QUFBZTtBQUFKO0FBQzFCO0FBQXFCLFVBQVgsRUFBRSxHQUFHLFFBQVEsQ0FBQyxhQUFhLENBQUMsS0FBSyxDQUFDO0FBQzVDO0FBQXFCLFVBQWIsS0FBSyxHQUFHLFFBQVEsQ0FBQyxlQUFlO0FBQ3hDLElBQ0ksSUFBSSxDQUFDLENBQUMsZUFBZSxJQUFJLEVBQUUsQ0FBQyxLQUFLLENBQUMsRUFBRTtBQUN4QyxRQUFRLE9BQU8sS0FBSyxDQUFDO0FBQ3JCLEtBQUs7QUFDTCxJQUNJLEVBQUUsQ0FBQyxLQUFLLENBQUMsYUFBYSxHQUFHLE1BQU0sQ0FBQztBQUNwQyxJQUFJLEVBQUUsQ0FBQyxLQUFLLENBQUMsYUFBYSxHQUFHLEdBQUcsQ0FBQztBQUNqQyxJQUFJLEtBQUssQ0FBQyxXQUFXLENBQUMsRUFBRSxDQUFDLENBQUM7QUFDMUI7QUFDQSxVQURVLFFBQVEsR0FD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QjtBQUMxQjtBQUFxQixJQUFqQixrQ0FBa0I7QUFDdEI7QUFDTztBQUFpQjtBQUN0QjtBQUFRLElBRE4sNkNBQWlDO0FBQ3JDO0FBQVE7QUFBaUI7QUFBZ0I7QUFDdkMsSUFERSxtQ0FBMEM7QUFDOUM7QUFBUTtBQUNQO0FBQWdCO0FBQVEsSUFEckIsa0NBQW1CO0FBQ3ZCO0FBQVE7QUFBaUI7QUFBZ0I7QUFBUSxJQUM3Qyw2Q0FBbUM7QUFDdkM7QUFBUTtBQUFpQjtBQUN0QjtBQUFRLElBRFAsMkNBQWlDO0FBQ3JDO0FBQVE7QUFBaUI7QUFDVjtBQUFRLElBRG5CLHlDQUFxQjtBQUN6QjtBQUFRO0FBQ1I7QUFBZ0I7QUFBUSxJQURwQixvQ0FBb0I7QUFDeEI7QUFBUTtBQUFpQjtBQUFnQjtBQUN0QyxJQURDLHFEQUF5QztBQUM3QztBQUFRO0FBQ1A7QUFBZ0I7QUFBUSxJQURyQix1Q0FBbUI7QUFDdkI7QUFBUTtBQUFpQjtBQUNYO0FBQVEsSUFEbEIsMENBQXNCO0FBQzFCO0FBQVE7QUFBaUI7QUFFbEI7QUFBUSxJQUZYLDJDQUE0QjtBQUNoQztBQUNPO0FBQ0E7QUFBZ0I7QUFBUSxJQUF2QixnQ0FBOEI7QUFBQztBQUNoQztBQUFpQjtBQUNyQjtBQUFRLElBREgscUNBQTJCO0FBQUM7QUFDN0I7QUFBaUI7QUFDaEI7QUFBUSxJQURSLCtCQUFzQjtBQUFDO0FBQ3hCO0FBQWlCO0FBR3ZCO0FBQVEsSUFIRCxpQ0FBb0I7QUFDNUI7QUFBRTtBQUVLIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgICBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneSxcbiAgICBDaGFuZ2VEZXRlY3RvclJlZixcbiAgICBDb21wb25lbnQsXG4gICAgRWxlbWVudFJlZixcbiAgICBFdmVudEVtaXR0ZXIsXG4gICAgSW5wdXQsXG4gICAgTmdab25lLFxuICAgIE9uRGVzdHJveSxcbiAgICBPbkluaXQsXG4gICAgT3V0cHV0LFxuICAgIFJlbmRlcmVyMixcbiAgICBWaWV3Q29udGFpbmVyUmVmLFxuICAgIFZpZXdFbmNhcHN1bGF0aW9uXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuXG5pbXBvcnQgKiBhcyBoZWxwZXIgZnJvbSAnLi9uZXN0YWJsZS5oZWxwZXInO1xuXG5pbXBvcnQgeyBkZWZhdWx0U2V0dGluZ3MsIERSQUdfU1RBUlQsIEVYUEFORF9DT0xMQVBTRSwgbW91c2UsIFJFR0lTVEVSX0hBTkRMRSB9IGZyb20gJy4vbmVzdGFibGUuY29uc3RhbnQnO1xuXG5jb25zdCBQWCA9ICdweCc7XG5jb25zdCBoYXNQb2ludGVyRXZlbnRzID0gKGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpLFxuICAgICAgICBkb2NFbCA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudDtcblxuICAgIGlmICghKCdwb2ludGVyRXZlbnRzJyBpbiBlbC5zdHlsZSkpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIGVsLnN0eWxlLnBvaW50ZXJFdmVudHMgPSAnYXV0byc7XG4gICAgZWwuc3R5bGUucG9pbnRlckV2ZW50cyA9ICd4JztcbiAgICBkb2NFbC5hcHBlbmRDaGlsZChlbCk7XG4gICAgY29uc3Qgc3VwcG9ydHMgPVxuICAgICAgICB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSAmJlxuICAgICAgICB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShlbCwgJycpLnBvaW50ZXJFdmVudHMgPT09ICdhdXRvJztcbiAgICBkb2NFbC5yZW1vdmVDaGlsZChlbCk7XG4gICAgcmV0dXJuICEhc3VwcG9ydHM7XG59KSgpO1xuXG5AQ29tcG9uZW50KHtcbiAgICBzZWxlY3RvcjogJ25neC1uZXN0YWJsZScsXG4gICAgdGVtcGxhdGVVcmw6ICcuL25lc3RhYmxlLmNvbXBvbmVudC5odG1sJyxcbiAgICBzdHlsZVVybHM6IFsnLi9uZXN0YWJsZS5jb21wb25lbnQuc2NzcyddLFxuICAgIGVuY2Fwc3VsYXRpb246IFZpZXdFbmNhcHN1bGF0aW9uLk5vbmUsXG4gICAgY2hhbmdlRGV0ZWN0aW9uOiBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneS5PblB1c2hcbn0pXG5leHBvcnQgY2xhc3MgTmVzdGFibGVDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQsIE9uRGVzdHJveSB7XG4gICAgQE91dHB1dCgpIHB1YmxpYyBsaXN0Q2hhbmdlID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICAgIEBPdXRwdXQoKSBwdWJsaWMgZHJvcCA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcbiAgICBAT3V0cHV0KCkgcHVibGljIGRyYWcgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gICAgQE91dHB1dCgpIHB1YmxpYyBkaXNjbG9zdXJlID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuXG4gICAgQElucHV0KCkgcHVibGljIHRlbXBsYXRlOiBWaWV3Q29udGFpbmVyUmVmO1xuICAgIEBJbnB1dCgpIHB1YmxpYyBvcHRpb25zID0gZGVmYXVsdFNldHRpbmdzO1xuICAgIEBJbnB1dCgpIHB1YmxpYyBkaXNhYmxlRHJhZyA9IGZhbHNlO1xuXG4gICAgQElucHV0KClcbiAgICBwdWJsaWMgZ2V0IGxpc3QoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9saXN0O1xuICAgIH1cblxuICAgIHB1YmxpYyBzZXQgbGlzdChsaXN0KSB7XG4gICAgICAgIHRoaXMuX2xpc3QgPSBsaXN0O1xuICAgICAgICB0aGlzLl9nZW5lcmF0ZUl0ZW1JZHMoKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgZHJhZ1Jvb3RFbCA9IG51bGw7XG4gICAgcHVibGljIGRyYWdFbCA9IG51bGw7XG4gICAgcHVibGljIGRyYWdNb2RlbCA9IG51bGw7XG4gICAgcHVibGljIG1vdmluZyA9IGZhbHNlO1xuXG4gICAgLyoqXG4gICAgICogRHJhZ2dlZCBlbGVtZW50IGNvbnRhaW5zIGNoaWxkcmVuLCBhbmQgdGhvc2UgY2hpbGRyZW4gY29udGFpbiBvdGhlciBjaGlsZHJlbiBhbmQgc28gb24uLi5cbiAgICAgKiBUaGlzIHByb3BlcnR5IGdpdmVzIHlvdSB0aGUgbnVtYmVyIG9mIGdlbmVyYXRpb25zIGNvbnRhaW5lZCB3aXRoaW4gdGhlIGRyYWdnaW5nIGl0ZW0uXG4gICAgICovXG4gICAgcHVibGljIGRyYWdEZXB0aCA9IDA7XG5cbiAgICAvKipcbiAgICAgKiBUaGUgZGVwdGggb2YgZHJhZ2dpbmcgaXRlbSByZWxhdGl2ZSB0byBlbGVtZW50IHJvb3QgKG5neC1uZXN0YWJsZSlcbiAgICAgKi9cbiAgICBwdWJsaWMgcmVsYXRpdmVEZXB0aCA9IDA7XG5cbiAgICBwdWJsaWMgaGFzTmV3Um9vdCA9IGZhbHNlO1xuICAgIHB1YmxpYyBwb2ludEVsID0gbnVsbDtcbiAgICBwdWJsaWMgaXRlbXMgPSBbXTtcblxuICAgIHByaXZhdGUgX2NvbXBvbmVudEFjdGl2ZSA9IGZhbHNlO1xuICAgIHByaXZhdGUgX21vdXNlID0gT2JqZWN0LmFzc2lnbih7fSwgbW91c2UpO1xuICAgIHByaXZhdGUgX2xpc3QgPSBbXTtcbiAgICAvLyBwcml2YXRlIF9vcHRpb25zID0gT2JqZWN0LmFzc2lnbih7fSwgZGVmYXVsdFNldHRpbmdzKSBhcyBOZXN0YWJsZVNldHRpbmdzO1xuICAgIHByaXZhdGUgX2NhbmNlbE1vdXNlbW92ZTogRnVuY3Rpb247XG4gICAgcHJpdmF0ZSBfY2FuY2VsTW91c2V1cDogRnVuY3Rpb247XG4gICAgcHJpdmF0ZSBfcGxhY2Vob2xkZXI7XG4gICAgcHJpdmF0ZSBfaXRlbUlkID0gMDtcbiAgICBwcml2YXRlIF9yZWdpc3RlckhhbmRsZURpcmVjdGl2ZSA9IGZhbHNlO1xuICAgIHByaXZhdGUgX2RyYWdJbmRleDtcbiAgICBwcml2YXRlIF9wYXJlbnREcmFnSWQ7XG4gICAgcHJpdmF0ZSBfb2xkTGlzdExlbmd0aDogYW55O1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgcmVmOiBDaGFuZ2VEZXRlY3RvclJlZixcbiAgICAgICAgcHJpdmF0ZSByZW5kZXJlcjogUmVuZGVyZXIyLFxuICAgICAgICBwcml2YXRlIGVsOiBFbGVtZW50UmVmLFxuICAgICAgICBwcml2YXRlIHpvbmU6IE5nWm9uZVxuICAgICkge31cblxuICAgIG5nT25Jbml0KCk6IHZvaWQge1xuICAgICAgICAvLyBzZXQvZXh0ZW5kIGRlZmF1bHQgb3B0aW9uc1xuICAgICAgICB0aGlzLl9jb21wb25lbnRBY3RpdmUgPSB0cnVlO1xuICAgICAgICBjb25zdCBvcHRpb25LZXlzID0gT2JqZWN0LmtleXMoZGVmYXVsdFNldHRpbmdzKTtcbiAgICAgICAgZm9yIChjb25zdCBrZXkgb2Ygb3B0aW9uS2V5cykge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiB0aGlzLm9wdGlvbnNba2V5XSA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbnNba2V5XSA9IGRlZmF1bHRTZXR0aW5nc1trZXldO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5fZ2VuZXJhdGVJdGVtSWRzKCk7XG4gICAgICAgIHRoaXMuX2dlbmVyYXRlSXRlbUV4cGFuZGVkKCk7XG4gICAgICAgIHRoaXMuX2NyZWF0ZUhhbmRsZUxpc3RlbmVyKCk7XG4gICAgfVxuXG4gICAgbmdPbkRlc3Ryb3koKTogdm9pZCB7fVxuXG4gICAgcHJpdmF0ZSBfZ2VuZXJhdGVJdGVtSWRzKCkge1xuICAgICAgICBoZWxwZXIuX3RyYXZlcnNlQ2hpbGRyZW4odGhpcy5fbGlzdCwgaXRlbSA9PiB7XG4gICAgICAgICAgICBpdGVtWyckJGlkJ10gPSB0aGlzLl9pdGVtSWQrKztcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBfZ2VuZXJhdGVJdGVtRXhwYW5kZWQoKSB7XG4gICAgICAgIGhlbHBlci5fdHJhdmVyc2VDaGlsZHJlbih0aGlzLl9saXN0LCBpdGVtID0+IHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgaXRlbS5leHBhbmRlZCA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICBpdGVtWyckJGV4cGFuZGVkJ10gPSB0cnVlO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpdGVtWyckJGV4cGFuZGVkJ10gPSBpdGVtLmV4cGFuZGVkO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBwcml2YXRlIF9jcmVhdGVIYW5kbGVMaXN0ZW5lcigpIHtcbiAgICAgICAgdGhpcy5yZW5kZXJlci5saXN0ZW4odGhpcy5lbC5uYXRpdmVFbGVtZW50LCBSRUdJU1RFUl9IQU5ETEUsICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuX3JlZ2lzdGVySGFuZGxlRGlyZWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5yZW5kZXJlci5saXN0ZW4odGhpcy5lbC5uYXRpdmVFbGVtZW50LCBEUkFHX1NUQVJULCBkYXRhID0+IHtcbiAgICAgICAgICAgIHRoaXMuZHJhZ1N0YXJ0KFxuICAgICAgICAgICAgICAgIGRhdGEuZGV0YWlsLmV2ZW50LFxuICAgICAgICAgICAgICAgIGRhdGEuZGV0YWlsLnBhcmFtLml0ZW0sXG4gICAgICAgICAgICAgICAgZGF0YS5kZXRhaWwucGFyYW0ucGFyZW50TGlzdFxuICAgICAgICAgICAgKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5yZW5kZXJlci5saXN0ZW4odGhpcy5lbC5uYXRpdmVFbGVtZW50LCBFWFBBTkRfQ09MTEFQU0UsIGRhdGEgPT4ge1xuICAgICAgICAgICAgdGhpcy5kaXNjbG9zdXJlLmVtaXQoe1xuICAgICAgICAgICAgICAgIGl0ZW06IGRhdGEuZGV0YWlsLml0ZW0sXG4gICAgICAgICAgICAgICAgZXhwYW5kZWQ6IGRhdGEuZGV0YWlsLml0ZW1bJyQkZXhwYW5kZWQnXVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHByaXZhdGUgX2NyZWF0ZURyYWdDbG9uZShldmVudCwgZHJhZ0l0ZW0pIHtcbiAgICAgICAgdGhpcy5fbW91c2VTdGFydChldmVudCwgZHJhZ0l0ZW0pO1xuXG4gICAgICAgIGlmICghdGhpcy5fcmVnaXN0ZXJIYW5kbGVEaXJlY3RpdmUpIHtcbiAgICAgICAgICAgIHRoaXMuX21vdXNlLm9mZnNldFkgPSBkcmFnSXRlbS5uZXh0RWxlbWVudFNpYmxpbmdcbiAgICAgICAgICAgICAgICA/IGRyYWdJdGVtLm5leHRFbGVtZW50U2libGluZy5jbGllbnRIZWlnaHQgLyAyXG4gICAgICAgICAgICAgICAgOiBkcmFnSXRlbS5jbGllbnRIZWlnaHQgLyAyO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gY3JlYXRlIGRyYWcgY2xvbmVcbiAgICAgICAgdGhpcy5kcmFnRWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KHRoaXMub3B0aW9ucy5saXN0Tm9kZU5hbWUpO1xuICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHRoaXMuZHJhZ0VsKTtcblxuICAgICAgICB0aGlzLnJlbmRlcmVyLmFkZENsYXNzKHRoaXMuZHJhZ0VsLCB0aGlzLm9wdGlvbnMuZHJhZ0NsYXNzKTtcblxuICAgICAgICAvLyBhZGQgZHJhZyBjbG9uZSB0byBib2R5IGFuZCBzZXQgY3NzXG4gICAgICAgIHRoaXMucmVuZGVyZXIuc2V0U3R5bGUoXG4gICAgICAgICAgICB0aGlzLmRyYWdFbCxcbiAgICAgICAgICAgICdsZWZ0JyxcbiAgICAgICAgICAgIGV2ZW50LnBhZ2VYIC0gdGhpcy5fbW91c2Uub2Zmc2V0WCArIFBYXG4gICAgICAgICk7XG4gICAgICAgIHRoaXMucmVuZGVyZXIuc2V0U3R5bGUoXG4gICAgICAgICAgICB0aGlzLmRyYWdFbCxcbiAgICAgICAgICAgICd0b3AnLFxuICAgICAgICAgICAgZXZlbnQucGFnZVkgLSB0aGlzLl9tb3VzZS5vZmZzZXRZICsgUFhcbiAgICAgICAgKTtcbiAgICAgICAgdGhpcy5yZW5kZXJlci5zZXRTdHlsZSh0aGlzLmRyYWdFbCwgJ3Bvc2l0aW9uJywgJ2Fic29sdXRlJyk7XG4gICAgICAgIHRoaXMucmVuZGVyZXIuc2V0U3R5bGUodGhpcy5kcmFnRWwsICd6LWluZGV4JywgOTk5OSk7XG4gICAgICAgIHRoaXMucmVuZGVyZXIuc2V0U3R5bGUodGhpcy5kcmFnRWwsICdwb2ludGVyLWV2ZW50cycsICdub25lJyk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBfY3JlYXRlUGxhY2Vob2xkZXIoZXZlbnQsIGRyYWdJdGVtKSB7XG4gICAgICAgIHRoaXMuX3BsYWNlaG9sZGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIHRoaXMuX3BsYWNlaG9sZGVyLmNsYXNzTGlzdC5hZGQodGhpcy5vcHRpb25zLnBsYWNlQ2xhc3MpO1xuICAgICAgICBoZWxwZXIuX2luc2VydEFmdGVyKHRoaXMuX3BsYWNlaG9sZGVyLCBkcmFnSXRlbSk7XG4gICAgICAgIGRyYWdJdGVtLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoZHJhZ0l0ZW0pO1xuICAgICAgICB0aGlzLmRyYWdFbC5hcHBlbmRDaGlsZChkcmFnSXRlbSk7XG4gICAgICAgIHRoaXMuZHJhZ1Jvb3RFbCA9IGRyYWdJdGVtO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNldHMgZGVwdGggcHJvZXJ0aWVzIChyZWxhdGl2ZSBhbmQgZHJhZylcbiAgICAgKi9cbiAgICBwcml2YXRlIF9jYWxjdWxhdGVEZXB0aCgpIHtcbiAgICAgICAgLy8gdG90YWwgZGVwdGggb2YgZHJhZ2dpbmcgaXRlbVxuICAgICAgICBsZXQgZGVwdGg7XG4gICAgICAgIGNvbnN0IGl0ZW1zID0gdGhpcy5kcmFnRWwucXVlcnlTZWxlY3RvckFsbCh0aGlzLm9wdGlvbnMuaXRlbU5vZGVOYW1lKTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpdGVtcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgZGVwdGggPSBoZWxwZXIuX2dldFBhcmVudHMoaXRlbXNbaV0sIHRoaXMuZHJhZ0VsKS5sZW5ndGg7XG4gICAgICAgICAgICBpZiAoZGVwdGggPiB0aGlzLmRyYWdEZXB0aCkge1xuICAgICAgICAgICAgICAgIHRoaXMuZHJhZ0RlcHRoID0gZGVwdGg7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBkZXB0aCByZWxhdGl2ZSB0byByb290XG4gICAgICAgIHRoaXMucmVsYXRpdmVEZXB0aCA9IGhlbHBlci5fZ2V0UGFyZW50cyhcbiAgICAgICAgICAgIHRoaXMuX3BsYWNlaG9sZGVyLFxuICAgICAgICAgICAgdGhpcy5lbC5uYXRpdmVFbGVtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5vcHRpb25zLmxpc3ROb2RlTmFtZSlcbiAgICAgICAgKS5sZW5ndGg7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBfbW91c2VTdGFydChldmVudCwgZHJhZ0l0ZW0pIHtcbiAgICAgICAgdGhpcy5fbW91c2Uub2Zmc2V0WCA9IGV2ZW50LnBhZ2VYIC0gaGVscGVyLl9vZmZzZXQoZHJhZ0l0ZW0pLmxlZnQ7XG4gICAgICAgIHRoaXMuX21vdXNlLm9mZnNldFkgPSBldmVudC5wYWdlWSAtIGhlbHBlci5fb2Zmc2V0KGRyYWdJdGVtKS50b3A7XG4gICAgICAgIHRoaXMuX21vdXNlLnN0YXJ0WCA9IHRoaXMuX21vdXNlLmxhc3RYID0gZXZlbnQucGFnZVg7XG4gICAgICAgIHRoaXMuX21vdXNlLnN0YXJ0WSA9IHRoaXMuX21vdXNlLmxhc3RZID0gZXZlbnQucGFnZVk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBfbW91c2VVcGRhdGUoZXZlbnQpIHtcbiAgICAgICAgLy8gbW91c2UgcG9zaXRpb24gbGFzdCBldmVudHNcbiAgICAgICAgdGhpcy5fbW91c2UubGFzdFggPSB0aGlzLl9tb3VzZS5ub3dYO1xuICAgICAgICB0aGlzLl9tb3VzZS5sYXN0WSA9IHRoaXMuX21vdXNlLm5vd1k7XG4gICAgICAgIC8vIG1vdXNlIHBvc2l0aW9uIHRoaXMgZXZlbnRzXG4gICAgICAgIHRoaXMuX21vdXNlLm5vd1ggPSBldmVudC5wYWdlWDtcbiAgICAgICAgdGhpcy5fbW91c2Uubm93WSA9IGV2ZW50LnBhZ2VZO1xuICAgICAgICAvLyBkaXN0YW5jZSBtb3VzZSBtb3ZlZCBiZXR3ZWVuIGV2ZW50c1xuICAgICAgICB0aGlzLl9tb3VzZS5kaXN0WCA9IHRoaXMuX21vdXNlLm5vd1ggLSB0aGlzLl9tb3VzZS5sYXN0WDtcbiAgICAgICAgdGhpcy5fbW91c2UuZGlzdFkgPSB0aGlzLl9tb3VzZS5ub3dZIC0gdGhpcy5fbW91c2UubGFzdFk7XG4gICAgICAgIC8vIGRpcmVjdGlvbiBtb3VzZSB3YXMgbW92aW5nXG4gICAgICAgIHRoaXMuX21vdXNlLmxhc3REaXJYID0gdGhpcy5fbW91c2UuZGlyWDtcbiAgICAgICAgdGhpcy5fbW91c2UubGFzdERpclkgPSB0aGlzLl9tb3VzZS5kaXJZO1xuICAgICAgICAvLyBkaXJlY3Rpb24gbW91c2UgaXMgbm93IG1vdmluZyAob24gYm90aCBheGlzKVxuICAgICAgICB0aGlzLl9tb3VzZS5kaXJYID1cbiAgICAgICAgICAgIHRoaXMuX21vdXNlLmRpc3RYID09PSAwID8gMCA6IHRoaXMuX21vdXNlLmRpc3RYID4gMCA/IDEgOiAtMTtcbiAgICAgICAgdGhpcy5fbW91c2UuZGlyWSA9XG4gICAgICAgICAgICB0aGlzLl9tb3VzZS5kaXN0WSA9PT0gMCA/IDAgOiB0aGlzLl9tb3VzZS5kaXN0WSA+IDAgPyAxIDogLTE7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBfc2hvd01hc2tzKCkge1xuICAgICAgICBjb25zdCBtYXNrcyA9IHRoaXMuZWwubmF0aXZlRWxlbWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFxuICAgICAgICAgICAgJ25lc3RhYmxlLWl0ZW0tbWFzaydcbiAgICAgICAgKTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBtYXNrcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgbWFza3NbaV0uc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIF9oaWRlTWFza3MoKSB7XG4gICAgICAgIGNvbnN0IG1hc2tzID0gdGhpcy5lbC5uYXRpdmVFbGVtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXG4gICAgICAgICAgICAnbmVzdGFibGUtaXRlbS1tYXNrJ1xuICAgICAgICApO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG1hc2tzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBtYXNrc1tpXS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogY2FsYyBtb3VzZSB0cmF2ZXJzZSBkaXN0YW5jZSBvbiBheGlzXG4gICAgICogQHBhcmFtIG0gLSBtb3VzZVxuICAgICAqL1xuICAgIHByaXZhdGUgX2NhbGNNb3VzZURpc3RhbmNlKG0pIHtcbiAgICAgICAgbS5kaXN0QXhYICs9IE1hdGguYWJzKG0uZGlzdFgpO1xuICAgICAgICBpZiAobS5kaXJYICE9PSAwICYmIG0uZGlyWCAhPT0gbS5sYXN0RGlyWCkge1xuICAgICAgICAgICAgbS5kaXN0QXhYID0gMDtcbiAgICAgICAgfVxuXG4gICAgICAgIG0uZGlzdEF4WSArPSBNYXRoLmFicyhtLmRpc3RZKTtcbiAgICAgICAgaWYgKG0uZGlyWSAhPT0gMCAmJiBtLmRpclkgIT09IG0ubGFzdERpclkpIHtcbiAgICAgICAgICAgIG0uZGlzdEF4WSA9IDA7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIF9tb3ZlKGV2ZW50KSB7XG4gICAgICAgIGxldCBkZXB0aCwgbGlzdDtcblxuICAgICAgICBjb25zdCBkcmFnUmVjdCA9IHRoaXMuZHJhZ0VsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgICAgICB0aGlzLnJlbmRlcmVyLnNldFN0eWxlKFxuICAgICAgICAgICAgdGhpcy5kcmFnRWwsXG4gICAgICAgICAgICAnbGVmdCcsXG4gICAgICAgICAgICBldmVudC5wYWdlWCAtIHRoaXMuX21vdXNlLm9mZnNldFggKyBQWFxuICAgICAgICApO1xuICAgICAgICB0aGlzLnJlbmRlcmVyLnNldFN0eWxlKFxuICAgICAgICAgICAgdGhpcy5kcmFnRWwsXG4gICAgICAgICAgICAndG9wJyxcbiAgICAgICAgICAgIGV2ZW50LnBhZ2VZIC0gdGhpcy5fbW91c2Uub2Zmc2V0WSArIFBYXG4gICAgICAgICk7XG5cbiAgICAgICAgdGhpcy5fbW91c2VVcGRhdGUoZXZlbnQpO1xuXG4gICAgICAgIC8vIGF4aXMgbW91c2UgaXMgbm93IG1vdmluZyBvblxuICAgICAgICBjb25zdCBuZXdBeCA9XG4gICAgICAgICAgICBNYXRoLmFicyh0aGlzLl9tb3VzZS5kaXN0WCkgPiBNYXRoLmFicyh0aGlzLl9tb3VzZS5kaXN0WSkgPyAxIDogMDtcblxuICAgICAgICAvLyBkbyBub3RoaW5nIG9uIGZpcnN0IG1vdmVcbiAgICAgICAgaWYgKCF0aGlzLl9tb3VzZS5tb3ZpbmcpIHtcbiAgICAgICAgICAgIHRoaXMuX21vdXNlLmRpckF4ID0gbmV3QXg7XG4gICAgICAgICAgICB0aGlzLl9tb3VzZS5tb3ZpbmcgPSAxO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gY2FsYyBkaXN0YW5jZSBtb3ZlZCBvbiB0aGlzIGF4aXMgKGFuZCBkaXJlY3Rpb24pXG4gICAgICAgIGlmICh0aGlzLl9tb3VzZS5kaXJBeCAhPT0gbmV3QXgpIHtcbiAgICAgICAgICAgIHRoaXMuX21vdXNlLmRpc3RBeFggPSAwO1xuICAgICAgICAgICAgdGhpcy5fbW91c2UuZGlzdEF4WSA9IDA7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9jYWxjTW91c2VEaXN0YW5jZSh0aGlzLl9tb3VzZSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fbW91c2UuZGlyQXggPSBuZXdBeDtcblxuICAgICAgICAvLyBmaW5kIGxpc3QgaXRlbSB1bmRlciBjdXJzb3JcbiAgICAgICAgaWYgKCFoYXNQb2ludGVyRXZlbnRzKSB7XG4gICAgICAgICAgICB0aGlzLmRyYWdFbC5zdHlsZS52aXNpYmlsaXR5ID0gJ2hpZGRlbic7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBwb2ludEVsID0gZG9jdW1lbnQuZWxlbWVudEZyb21Qb2ludChcbiAgICAgICAgICAgIGV2ZW50LnBhZ2VYIC0gZG9jdW1lbnQuYm9keS5zY3JvbGxMZWZ0LFxuICAgICAgICAgICAgZXZlbnQucGFnZVkgLSAod2luZG93LnBhZ2VZT2Zmc2V0IHx8IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxUb3ApXG4gICAgICAgICk7XG5cbiAgICAgICAgaWYgKCFoYXNQb2ludGVyRXZlbnRzKSB7XG4gICAgICAgICAgICB0aGlzLmRyYWdFbC5zdHlsZS52aXNpYmlsaXR5ID0gJ3Zpc2libGUnO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKFxuICAgICAgICAgICAgcG9pbnRFbCAmJlxuICAgICAgICAgICAgKHBvaW50RWwuY2xhc3NMaXN0LmNvbnRhaW5zKCduZXN0YWJsZS1pdGVtLW1hc2snKSB8fFxuICAgICAgICAgICAgICAgIHBvaW50RWwuY2xhc3NMaXN0LmNvbnRhaW5zKHRoaXMub3B0aW9ucy5wbGFjZUNsYXNzKSlcbiAgICAgICAgKSB7XG4gICAgICAgICAgICB0aGlzLnBvaW50RWwgPSBwb2ludEVsLnBhcmVudEVsZW1lbnQucGFyZW50RWxlbWVudDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBtb3ZlIGhvcml6b250YWxcbiAgICAgICAgICovXG4gICAgICAgIGlmIChcbiAgICAgICAgICAgICF0aGlzLm9wdGlvbnMuZml4ZWREZXB0aCAmJlxuICAgICAgICAgICAgdGhpcy5fbW91c2UuZGlyQXggJiZcbiAgICAgICAgICAgIHRoaXMuX21vdXNlLmRpc3RBeFggPj0gdGhpcy5vcHRpb25zLnRocmVzaG9sZFxuICAgICAgICApIHtcbiAgICAgICAgICAgIC8vIHJlc2V0IG1vdmUgZGlzdGFuY2Ugb24geC1heGlzIGZvciBuZXcgcGhhc2VcbiAgICAgICAgICAgIHRoaXMuX21vdXNlLmRpc3RBeFggPSAwO1xuICAgICAgICAgICAgY29uc3QgcHJldmlvdXMgPSB0aGlzLl9wbGFjZWhvbGRlci5wcmV2aW91c0VsZW1lbnRTaWJsaW5nO1xuXG4gICAgICAgICAgICAvLyBpbmNyZWFzZSBob3Jpem9udGFsIGxldmVsIGlmIHByZXZpb3VzIHNpYmxpbmcgZXhpc3RzLCBpcyBub3QgY29sbGFwc2VkLCBhbmQgY2FuIGhhdmUgY2hpbGRyZW5cbiAgICAgICAgICAgIGlmICh0aGlzLl9tb3VzZS5kaXN0WCA+IDAgJiYgcHJldmlvdXMpIHtcbiAgICAgICAgICAgICAgICBsaXN0ID0gcHJldmlvdXMucXVlcnlTZWxlY3RvckFsbCh0aGlzLm9wdGlvbnMubGlzdE5vZGVOYW1lKTtcbiAgICAgICAgICAgICAgICBsaXN0ID0gbGlzdFtsaXN0Lmxlbmd0aCAtIDFdO1xuXG4gICAgICAgICAgICAgICAgLy8gY2hlY2sgaWYgZGVwdGggbGltaXQgaGFzIHJlYWNoZWRcbiAgICAgICAgICAgICAgICBkZXB0aCA9IGhlbHBlci5fZ2V0UGFyZW50cyhcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcGxhY2Vob2xkZXIsXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZWwubmF0aXZlRWxlbWVudC5xdWVyeVNlbGVjdG9yKHRoaXMub3B0aW9ucy5saXN0Tm9kZU5hbWUpXG4gICAgICAgICAgICAgICAgKS5sZW5ndGg7XG5cbiAgICAgICAgICAgICAgICBpZiAoZGVwdGggKyB0aGlzLmRyYWdEZXB0aCA8PSB0aGlzLm9wdGlvbnMubWF4RGVwdGgpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gY3JlYXRlIG5ldyBzdWItbGV2ZWwgaWYgb25lIGRvZXNuJ3QgZXhpc3RcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFsaXN0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsaXN0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCh0aGlzLm9wdGlvbnMubGlzdE5vZGVOYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpc3Quc3R5bGUucGFkZGluZ0xlZnQgPSB0aGlzLm9wdGlvbnMudGhyZXNob2xkICsgUFg7XG4gICAgICAgICAgICAgICAgICAgICAgICBsaXN0LmFwcGVuZENoaWxkKHRoaXMuX3BsYWNlaG9sZGVyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByZXZpb3VzLmFwcGVuZENoaWxkKGxpc3QpO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhpcy5zZXRQYXJlbnQocHJldmlvdXMpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gZWxzZSBhcHBlbmQgdG8gbmV4dCBsZXZlbCB1cFxuICAgICAgICAgICAgICAgICAgICAgICAgbGlzdCA9IHByZXZpb3VzLnF1ZXJ5U2VsZWN0b3IoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYDpzY29wZSA+ICR7IHRoaXMub3B0aW9ucy5saXN0Tm9kZU5hbWUgfWBcbiAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgICAgICBsaXN0LmFwcGVuZENoaWxkKHRoaXMuX3BsYWNlaG9sZGVyKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIGRlY3JlYXNlIGhvcml6b250YWwgbGV2ZWxcbiAgICAgICAgICAgIGlmICh0aGlzLl9tb3VzZS5kaXN0WCA8IDApIHtcbiAgICAgICAgICAgICAgICAvLyB3ZSBjYW4ndCBkZWNyZWFzZSBhIGxldmVsIGlmIGFuIGl0ZW0gcHJlY2VlZHMgdGhlIGN1cnJlbnQgb25lXG4gICAgICAgICAgICAgICAgY29uc3QgbmV4dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICAgICAgICAgICAgICAgIGAuJHsgdGhpcy5vcHRpb25zLnBsYWNlQ2xhc3MgfSArICR7IHRoaXMub3B0aW9ucy5pdGVtTm9kZU5hbWUgfWBcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIGNvbnN0IHBhcmVudEVsZW1lbnQgPSB0aGlzLl9wbGFjZWhvbGRlci5wYXJlbnRFbGVtZW50O1xuICAgICAgICAgICAgICAgIGlmICghbmV4dCAmJiBwYXJlbnRFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNsb3Nlc3RJdGVtID0gaGVscGVyLl9jbG9zZXN0KFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fcGxhY2Vob2xkZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbnMuaXRlbU5vZGVOYW1lXG4gICAgICAgICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGNsb3Nlc3RJdGVtKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnRFbGVtZW50LnJlbW92ZUNoaWxkKHRoaXMuX3BsYWNlaG9sZGVyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGhlbHBlci5faW5zZXJ0QWZ0ZXIodGhpcy5fcGxhY2Vob2xkZXIsIGNsb3Nlc3RJdGVtKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghcG9pbnRFbC5jbGFzc0xpc3QuY29udGFpbnMoJ25lc3RhYmxlLWl0ZW0tbWFzaycpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICAvLyBmaW5kIHJvb3QgbGlzdCBvZiBpdGVtIHVuZGVyIGN1cnNvclxuICAgICAgICBjb25zdCBwb2ludEVsUm9vdCA9IGhlbHBlci5fY2xvc2VzdChcbiAgICAgICAgICAgIHRoaXMucG9pbnRFbCxcbiAgICAgICAgICAgIGAuJHsgdGhpcy5vcHRpb25zLnJvb3RDbGFzcyB9YFxuICAgICAgICAgICAgKSxcbiAgICAgICAgICAgIGlzTmV3Um9vdCA9IHBvaW50RWxSb290XG4gICAgICAgICAgICAgICAgPyB0aGlzLmRyYWdSb290RWwuZGF0YXNldFsnbmVzdGFibGUtaWQnXSAhPT1cbiAgICAgICAgICAgICAgICBwb2ludEVsUm9vdC5kYXRhc2V0WyduZXN0YWJsZS1pZCddXG4gICAgICAgICAgICAgICAgOiBmYWxzZTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogbW92ZSB2ZXJ0aWNhbFxuICAgICAgICAgKi9cbiAgICAgICAgaWYgKCF0aGlzLl9tb3VzZS5kaXJBeCB8fCBpc05ld1Jvb3QpIHtcbiAgICAgICAgICAgIC8vIGNoZWNrIGlmIGdyb3VwcyBtYXRjaCBpZiBkcmFnZ2luZyBvdmVyIG5ldyByb290XG4gICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgICAgaXNOZXdSb290ICYmXG4gICAgICAgICAgICAgICAgdGhpcy5vcHRpb25zLmdyb3VwICE9PSBwb2ludEVsUm9vdC5kYXRhc2V0WyduZXN0YWJsZS1ncm91cCddXG4gICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIGNoZWNrIGRlcHRoIGxpbWl0XG4gICAgICAgICAgICBkZXB0aCA9XG4gICAgICAgICAgICAgICAgdGhpcy5kcmFnRGVwdGggLVxuICAgICAgICAgICAgICAgIDEgK1xuICAgICAgICAgICAgICAgIGhlbHBlci5fZ2V0UGFyZW50cyhcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wb2ludEVsLFxuICAgICAgICAgICAgICAgICAgICB0aGlzLmVsLm5hdGl2ZUVsZW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLm9wdGlvbnMubGlzdE5vZGVOYW1lKVxuICAgICAgICAgICAgICAgICkubGVuZ3RoO1xuXG4gICAgICAgICAgICBpZiAoZGVwdGggPiB0aGlzLm9wdGlvbnMubWF4RGVwdGgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IGJlZm9yZSA9XG4gICAgICAgICAgICAgICAgZXZlbnQucGFnZVkgPFxuICAgICAgICAgICAgICAgIGhlbHBlci5fb2Zmc2V0KHRoaXMucG9pbnRFbCkudG9wICsgdGhpcy5wb2ludEVsLmNsaWVudEhlaWdodCAvIDI7XG4gICAgICAgICAgICBjb25zdCBwbGFjZWhvbGRlclBhcmVudCA9IHRoaXMuX3BsYWNlaG9sZGVyLnBhcmVudE5vZGU7XG5cbiAgICAgICAgICAgIC8vIGdldCBwb2ludCBlbGVtZW50IGRlcHRoXG4gICAgICAgICAgICBsZXQgcG9pbnRSZWxhdGl2ZURlcHRoO1xuICAgICAgICAgICAgcG9pbnRSZWxhdGl2ZURlcHRoID0gaGVscGVyLl9nZXRQYXJlbnRzKFxuICAgICAgICAgICAgICAgIHRoaXMucG9pbnRFbCxcbiAgICAgICAgICAgICAgICB0aGlzLmVsLm5hdGl2ZUVsZW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLm9wdGlvbnMubGlzdE5vZGVOYW1lKVxuICAgICAgICAgICAgKS5sZW5ndGg7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMuZml4ZWREZXB0aCkge1xuICAgICAgICAgICAgICAgIGlmIChwb2ludFJlbGF0aXZlRGVwdGggPT09IHRoaXMucmVsYXRpdmVEZXB0aCAtIDEpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY2hpbGRMaXN0ID0gdGhpcy5wb2ludEVsLnF1ZXJ5U2VsZWN0b3IoXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbnMubGlzdE5vZGVOYW1lXG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghY2hpbGRMaXN0LmNoaWxkcmVuLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGRMaXN0LmFwcGVuZENoaWxkKHRoaXMuX3BsYWNlaG9sZGVyKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocG9pbnRSZWxhdGl2ZURlcHRoID09PSB0aGlzLnJlbGF0aXZlRGVwdGgpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGJlZm9yZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wb2ludEVsLnBhcmVudEVsZW1lbnQuaW5zZXJ0QmVmb3JlKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3BsYWNlaG9sZGVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucG9pbnRFbFxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGhlbHBlci5faW5zZXJ0QWZ0ZXIodGhpcy5fcGxhY2Vob2xkZXIsIHRoaXMucG9pbnRFbCk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgICAgICAgICAgICBBcnJheS5wcm90b3R5cGUuaW5kZXhPZi5jYWxsKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucG9pbnRFbC5wYXJlbnRFbGVtZW50LmNoaWxkcmVuLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucG9pbnRFbFxuICAgICAgICAgICAgICAgICAgICAgICAgKSA9PT1cbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucG9pbnRFbC5wYXJlbnRFbGVtZW50LmNoaWxkcmVuLmxlbmd0aCAtIDFcbiAgICAgICAgICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBoZWxwZXIuX2luc2VydEFmdGVyKHRoaXMuX3BsYWNlaG9sZGVyLCB0aGlzLnBvaW50RWwpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIGlmIChiZWZvcmUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnBvaW50RWwucGFyZW50RWxlbWVudC5pbnNlcnRCZWZvcmUoXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3BsYWNlaG9sZGVyLFxuICAgICAgICAgICAgICAgICAgICB0aGlzLnBvaW50RWxcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBoZWxwZXIuX2luc2VydEFmdGVyKHRoaXMuX3BsYWNlaG9sZGVyLCB0aGlzLnBvaW50RWwpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIHJlc2V0KCkge1xuICAgICAgICBjb25zdCBrZXlzID0gT2JqZWN0LmtleXModGhpcy5fbW91c2UpO1xuICAgICAgICBmb3IgKGNvbnN0IGtleSBvZiBrZXlzKSB7XG4gICAgICAgICAgICB0aGlzLl9tb3VzZVtrZXldID0gMDtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuX2l0ZW1JZCA9IDA7XG4gICAgICAgIHRoaXMubW92aW5nID0gZmFsc2U7XG4gICAgICAgIHRoaXMuZHJhZ0VsID0gbnVsbDtcbiAgICAgICAgdGhpcy5kcmFnUm9vdEVsID0gbnVsbDtcbiAgICAgICAgdGhpcy5kcmFnRGVwdGggPSAwO1xuICAgICAgICB0aGlzLnJlbGF0aXZlRGVwdGggPSAwO1xuICAgICAgICB0aGlzLmhhc05ld1Jvb3QgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5wb2ludEVsID0gbnVsbDtcbiAgICB9XG5cbiAgICBwdWJsaWMgZHJhZ1N0YXJ0RnJvbUl0ZW0oZXZlbnQsIGl0ZW0sIHBhcmVudExpc3QpIHtcbiAgICAgICAgaWYgKCF0aGlzLl9yZWdpc3RlckhhbmRsZURpcmVjdGl2ZSkge1xuICAgICAgICAgICAgdGhpcy5kcmFnU3RhcnQoZXZlbnQsIGl0ZW0sIHBhcmVudExpc3QpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBkcmFnU3RhcnQoZXZlbnQsIGl0ZW0sIHBhcmVudExpc3QpIHtcblxuICAgICAgICB0aGlzLl9vbGRMaXN0TGVuZ3RoID0gdGhpcy5saXN0Lmxlbmd0aDtcblxuICAgICAgICBpZiAoIXRoaXMub3B0aW9ucy5kaXNhYmxlRHJhZykge1xuICAgICAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICAgICAgICBpZiAoZXZlbnQub3JpZ2luYWxFdmVudCkge1xuICAgICAgICAgICAgICAgIGV2ZW50ID0gZXZlbnQub3JpZ2luYWxFdmVudDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gYWxsb3cgb25seSBmaXJzdCBtb3VzZSBidXR0b25cbiAgICAgICAgICAgIGlmIChldmVudC50eXBlLmluZGV4T2YoJ21vdXNlJykgPT09IDApIHtcbiAgICAgICAgICAgICAgICBpZiAoZXZlbnQuYnV0dG9uICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmIChldmVudC50b3VjaGVzLmxlbmd0aCAhPT0gMSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLnJlZi5kZXRhY2goKTtcbiAgICAgICAgICAgIHRoaXMuX2RyYWdJbmRleCA9IHBhcmVudExpc3QuaW5kZXhPZihpdGVtKTtcbiAgICAgICAgICAgIHRoaXMuZHJhZ01vZGVsID0gcGFyZW50TGlzdC5zcGxpY2UocGFyZW50TGlzdC5pbmRleE9mKGl0ZW0pLCAxKVswXTtcblxuICAgICAgICAgICAgY29uc3QgZHJhZ0l0ZW0gPSBoZWxwZXIuX2Nsb3Nlc3QoZXZlbnQudGFyZ2V0LCB0aGlzLm9wdGlvbnMuaXRlbU5vZGVOYW1lKTtcbiAgICAgICAgICAgIGlmIChkcmFnSXRlbSA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX3BhcmVudERyYWdJZCA9IE51bWJlci5wYXJzZUludChcbiAgICAgICAgICAgICAgICBkcmFnSXRlbS5wYXJlbnRFbGVtZW50LnBhcmVudEVsZW1lbnQuaWRcbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIGNvbnN0IGRyYWdSZWN0ID0gZHJhZ0l0ZW0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG5cbiAgICAgICAgICAgIHRoaXMuX3Nob3dNYXNrcygpO1xuICAgICAgICAgICAgdGhpcy5fY3JlYXRlRHJhZ0Nsb25lKGV2ZW50LCBkcmFnSXRlbSk7XG4gICAgICAgICAgICB0aGlzLnJlbmRlcmVyLnNldFN0eWxlKHRoaXMuZHJhZ0VsLCAnd2lkdGgnLCBkcmFnUmVjdC53aWR0aCArIFBYKTtcblxuICAgICAgICAgICAgdGhpcy5fY3JlYXRlUGxhY2Vob2xkZXIoZXZlbnQsIGRyYWdJdGVtKTtcbiAgICAgICAgICAgIHRoaXMucmVuZGVyZXIuc2V0U3R5bGUodGhpcy5fcGxhY2Vob2xkZXIsICdoZWlnaHQnLCBkcmFnUmVjdC5oZWlnaHQgKyBQWCk7XG5cbiAgICAgICAgICAgIHRoaXMuX2NhbGN1bGF0ZURlcHRoKCk7XG4gICAgICAgICAgICB0aGlzLmRyYWcuZW1pdCh7XG4gICAgICAgICAgICAgICAgb3JpZ2luYWxFdmVudDogZXZlbnQsXG4gICAgICAgICAgICAgICAgaXRlbVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHRoaXMuX2NhbmNlbE1vdXNldXAgPSB0aGlzLnJlbmRlcmVyLmxpc3RlbihcbiAgICAgICAgICAgICAgICBkb2N1bWVudCxcbiAgICAgICAgICAgICAgICAnbW91c2V1cCcsXG4gICAgICAgICAgICAgICAgdGhpcy5kcmFnU3RvcC5iaW5kKHRoaXMpXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgdGhpcy5fY2FuY2VsTW91c2Vtb3ZlID0gdGhpcy5yZW5kZXJlci5saXN0ZW4oXG4gICAgICAgICAgICAgICAgZG9jdW1lbnQsXG4gICAgICAgICAgICAgICAgJ21vdXNlbW92ZScsXG4gICAgICAgICAgICAgICAgdGhpcy5kcmFnTW92ZS5iaW5kKHRoaXMpXG4gICAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIGRyYWdTdG9wKGV2ZW50KSB7XG4gICAgICAgIHRoaXMuX2NhbmNlbE1vdXNldXAoKTtcbiAgICAgICAgdGhpcy5fY2FuY2VsTW91c2Vtb3ZlKCk7XG4gICAgICAgIHRoaXMuX2hpZGVNYXNrcygpO1xuXG4gICAgICAgIGlmICh0aGlzLmRyYWdFbCkge1xuICAgICAgICAgICAgY29uc3QgZHJhZ2dlZElkID0gTnVtYmVyLnBhcnNlSW50KHRoaXMuZHJhZ0VsLmZpcnN0RWxlbWVudENoaWxkLmlkKTtcbiAgICAgICAgICAgIGxldCBwbGFjZWhvbGRlckNvbnRhaW5lciA9IGhlbHBlci5fY2xvc2VzdChcbiAgICAgICAgICAgICAgICB0aGlzLl9wbGFjZWhvbGRlcixcbiAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbnMuaXRlbU5vZGVOYW1lXG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICBsZXQgY2hhbmdlZEVsZW1lbnRQb3NpdGlvbiA9XG4gICAgICAgICAgICAgICAgdGhpcy5fZHJhZ0luZGV4ICE9PVxuICAgICAgICAgICAgICAgIEFycmF5LnByb3RvdHlwZS5pbmRleE9mLmNhbGwoXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3BsYWNlaG9sZGVyLnBhcmVudEVsZW1lbnQuY2hpbGRyZW4sXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3BsYWNlaG9sZGVyXG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgY29uc3QgaW5kZXggPSBBcnJheS5wcm90b3R5cGUuaW5kZXhPZi5jYWxsKHRoaXMuX3BsYWNlaG9sZGVyLnBhcmVudEVsZW1lbnQuY2hpbGRyZW4sIHRoaXMuX3BsYWNlaG9sZGVyKTtcblxuICAgICAgICAgICAgaWYgKCh0aGlzLl9kcmFnSW5kZXggPT09IGluZGV4KSAmJiAodGhpcy5fb2xkTGlzdExlbmd0aCA9PT0gdGhpcy5saXN0Lmxlbmd0aCkpIHtcbiAgICAgICAgICAgICAgICBjaGFuZ2VkRWxlbWVudFBvc2l0aW9uID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gcGxhY2Vob2xkZXIgaW4gcm9vdFxuICAgICAgICAgICAgaWYgKHBsYWNlaG9sZGVyQ29udGFpbmVyID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5saXN0LnNwbGljZShcbiAgICAgICAgICAgICAgICAgICAgQXJyYXkucHJvdG90eXBlLmluZGV4T2YuY2FsbChcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3BsYWNlaG9sZGVyLnBhcmVudEVsZW1lbnQuY2hpbGRyZW4sXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9wbGFjZWhvbGRlclxuICAgICAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgICAgICAwLFxuICAgICAgICAgICAgICAgICAgICB7IC4uLnRoaXMuZHJhZ01vZGVsIH1cbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBwYWxjZWhvbGRlciBuZXN0ZWRcbiAgICAgICAgICAgICAgICBwbGFjZWhvbGRlckNvbnRhaW5lciA9IGhlbHBlci5fZmluZE9iamVjdEluVHJlZShcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5saXN0LFxuICAgICAgICAgICAgICAgICAgICBOdW1iZXIucGFyc2VJbnQocGxhY2Vob2xkZXJDb250YWluZXIuaWQpXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBpZiAoIXBsYWNlaG9sZGVyQ29udGFpbmVyLmNoaWxkcmVuKSB7XG4gICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyQ29udGFpbmVyLmNoaWxkcmVuID0gW107XG4gICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyQ29udGFpbmVyLmNoaWxkcmVuLnB1c2goeyAuLi50aGlzLmRyYWdNb2RlbCB9KTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlckNvbnRhaW5lci5jaGlsZHJlbi5zcGxpY2UoXG4gICAgICAgICAgICAgICAgICAgICAgICBBcnJheS5wcm90b3R5cGUuaW5kZXhPZi5jYWxsKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3BsYWNlaG9sZGVyLnBhcmVudEVsZW1lbnQuY2hpbGRyZW4sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fcGxhY2Vob2xkZXJcbiAgICAgICAgICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgICAgICAgICAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgeyAuLi50aGlzLmRyYWdNb2RlbCB9XG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChpbmRleCA9PT0gdGhpcy5fZHJhZ0luZGV4KSB7XG4gICAgICAgICAgICAgICAgICAgIGNoYW5nZWRFbGVtZW50UG9zaXRpb24gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKCFjaGFuZ2VkRWxlbWVudFBvc2l0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIGNoYW5nZWRFbGVtZW50UG9zaXRpb24gPVxuICAgICAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXJDb250YWluZXJbJyQkaWQnXSAhPT0gdGhpcy5fcGFyZW50RHJhZ0lkO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5fcGxhY2Vob2xkZXIucGFyZW50RWxlbWVudC5yZW1vdmVDaGlsZCh0aGlzLl9wbGFjZWhvbGRlcik7XG4gICAgICAgICAgICB0aGlzLmRyYWdFbC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRoaXMuZHJhZ0VsKTtcbiAgICAgICAgICAgIHRoaXMuZHJhZ0VsLnJlbW92ZSgpO1xuICAgICAgICAgICAgdGhpcy5yZXNldCgpO1xuXG4gICAgICAgICAgICB0aGlzLmxpc3RDaGFuZ2UuZW1pdCh0aGlzLmxpc3QpO1xuICAgICAgICAgICAgdGhpcy5kcm9wLmVtaXQoe1xuICAgICAgICAgICAgICAgIG9yaWdpbmFsRXZlbnQ6IGV2ZW50LFxuICAgICAgICAgICAgICAgIGRlc3RpbmF0aW9uOiBwbGFjZWhvbGRlckNvbnRhaW5lcixcbiAgICAgICAgICAgICAgICBpdGVtOiB0aGlzLmRyYWdNb2RlbCxcbiAgICAgICAgICAgICAgICBjaGFuZ2VkRWxlbWVudFBvc2l0aW9uXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMucmVmLnJlYXR0YWNoKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwdWJsaWMgZHJhZ01vdmUoZXZlbnQpIHtcbiAgICAgICAgaWYgKHRoaXMuZHJhZ0VsKSB7XG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICAgICAgICBpZiAoZXZlbnQub3JpZ2luYWxFdmVudCkge1xuICAgICAgICAgICAgICAgIGV2ZW50ID0gZXZlbnQub3JpZ2luYWxFdmVudDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX21vdmUoZXZlbnQudHlwZS5pbmRleE9mKCdtb3VzZScpID09PSAwID8gZXZlbnQgOiBldmVudC50b3VjaGVzWzBdKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHB1YmxpYyBleHBhbmRBbGwoKSB7XG4gICAgICAgIGhlbHBlci5fdHJhdmVyc2VDaGlsZHJlbih0aGlzLl9saXN0LCBpdGVtID0+IHtcbiAgICAgICAgICAgIGl0ZW1bJyQkZXhwYW5kZWQnXSA9IHRydWU7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnJlZi5tYXJrRm9yQ2hlY2soKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgY29sbGFwc2VBbGwoKSB7XG4gICAgICAgIGhlbHBlci5fdHJhdmVyc2VDaGlsZHJlbih0aGlzLl9saXN0LCBpdGVtID0+IHtcbiAgICAgICAgICAgIGl0ZW1bJyQkZXhwYW5kZWQnXSA9IGZhbHNlO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5yZWYubWFya0ZvckNoZWNrKCk7XG4gICAgfVxufVxuIl19