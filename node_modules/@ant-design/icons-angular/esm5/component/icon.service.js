import { __assign, __decorate, __param, __read } from "tslib";
import { DOCUMENT } from '@angular/common';
import { HttpBackend, HttpClient } from '@angular/common/http';
import { Inject, Injectable, Optional, Renderer2, RendererFactory2, SecurityContext } from '@angular/core';
import { DomSanitizer } from '@angular/platform-browser';
import { of as rxof, Observable, Subject } from 'rxjs';
import { catchError, filter, finalize, map, share, take, tap } from 'rxjs/operators';
import { cloneSVG, getIconDefinitionFromAbbr, getNameAndNamespace, getSecondaryColor, hasNamespace, isIconDefinition, replaceFillColor, warn, withSuffix, withSuffixAndColor } from '../utils';
import { DynamicLoadingTimeoutError, HttpModuleNotImport, IconNotFoundError, NameSpaceIsNotSpecifyError, SVGTagNotFoundError, UrlNotSafeError } from './icon.error';
import * as ɵngcc0 from '@angular/core';
import * as ɵngcc1 from '@angular/common/http';
import * as ɵngcc2 from '@angular/platform-browser';
var JSONP_HANDLER_NAME = '__ant_icon_load';
var IconService = /** @class */ (function () {
    function IconService(_rendererFactory, _handler, 
    // tslint:disable-next-line:no-any
    _document, sanitizer) {
        this._rendererFactory = _rendererFactory;
        this._handler = _handler;
        this._document = _document;
        this.sanitizer = sanitizer;
        this.defaultTheme = 'outline';
        /**
         * All icon definitions would be registered here.
         */
        this._svgDefinitions = new Map();
        /**
         * Cache all rendered icons. Icons are identified by name, theme,
         * and for twotone icons, primary color and secondary color.
         */
        this._svgRenderedDefinitions = new Map();
        this._inProgressFetches = new Map();
        /**
         * Url prefix for fetching inline SVG by dynamic importing.
         */
        this._assetsUrlRoot = '';
        this._twoToneColorPalette = {
            primaryColor: '#333333',
            secondaryColor: '#E6E6E6'
        };
        /** A flag indicates whether jsonp loading is enabled. */
        this._enableJsonpLoading = false;
        this._jsonpIconLoad$ = new Subject();
        this._renderer = this._rendererFactory.createRenderer(null, null);
        if (this._handler) {
            this._http = new HttpClient(this._handler);
        }
    }
    Object.defineProperty(IconService.prototype, "twoToneColor", {
        get: function () {
            // Make a copy to avoid unexpected changes.
            return __assign({}, this._twoToneColorPalette);
        },
        set: function (_a) {
            var primaryColor = _a.primaryColor, secondaryColor = _a.secondaryColor;
            this._twoToneColorPalette.primaryColor = primaryColor;
            this._twoToneColorPalette.secondaryColor =
                secondaryColor || getSecondaryColor(primaryColor);
        },
        enumerable: true,
        configurable: true
    });
    /**
     * Call this method to switch to jsonp like loading.
     */
    IconService.prototype.useJsonpLoading = function () {
        var _this = this;
        if (!this._enableJsonpLoading) {
            this._enableJsonpLoading = true;
            window[JSONP_HANDLER_NAME] = function (icon) {
                _this._jsonpIconLoad$.next(icon);
            };
        }
        else {
            warn('You are already using jsonp loading.');
        }
    };
    /**
     * Change the prefix of the inline svg resources, so they could be deployed elsewhere, like CDN.
     * @param prefix
     */
    IconService.prototype.changeAssetsSource = function (prefix) {
        this._assetsUrlRoot = prefix.endsWith('/') ? prefix : prefix + '/';
    };
    /**
     * Add icons provided by ant design.
     * @param icons
     */
    IconService.prototype.addIcon = function () {
        var _this = this;
        var icons = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            icons[_i] = arguments[_i];
        }
        icons.forEach(function (icon) {
            _this._svgDefinitions.set(withSuffix(icon.name, icon.theme), icon);
        });
    };
    /**
     * Register an icon. Namespace is required.
     * @param type
     * @param literal
     */
    IconService.prototype.addIconLiteral = function (type, literal) {
        var _a = __read(getNameAndNamespace(type), 2), _ = _a[0], namespace = _a[1];
        if (!namespace) {
            throw NameSpaceIsNotSpecifyError();
        }
        this.addIcon({ name: type, icon: literal });
    };
    /**
     * Remove all cache.
     */
    IconService.prototype.clear = function () {
        this._svgDefinitions.clear();
        this._svgRenderedDefinitions.clear();
    };
    /**
     * Get a rendered `SVGElement`.
     * @param icon
     * @param twoToneColor
     */
    IconService.prototype.getRenderedContent = function (icon, twoToneColor) {
        var _this = this;
        // If `icon` is a `IconDefinition`, go to the next step. If not, try to fetch it from cache.
        var definitionOrNull = isIconDefinition(icon)
            ? icon
            : this._svgDefinitions.get(icon) || null;
        // If `icon` is a `IconDefinition` of successfully fetch, wrap it in an `Observable`.
        // Otherwise try to fetch it from remote.
        var $iconDefinition = definitionOrNull
            ? rxof(definitionOrNull)
            : this._loadIconDynamically(icon);
        // If finally get an `IconDefinition`, render and return it. Otherwise throw an error.
        return $iconDefinition.pipe(map(function (i) {
            if (!i) {
                throw IconNotFoundError(icon);
            }
            return _this._loadSVGFromCacheOrCreateNew(i, twoToneColor);
        }));
    };
    IconService.prototype.getCachedIcons = function () {
        return this._svgDefinitions;
    };
    /**
     * Get raw svg and assemble a `IconDefinition` object.
     * @param type
     */
    IconService.prototype._loadIconDynamically = function (type) {
        var _this = this;
        // If developer doesn't provide HTTP module nor enable jsonp loading, just throw an error.
        if (!this._http && !this._enableJsonpLoading) {
            return rxof(HttpModuleNotImport());
        }
        // If multi directive ask for the same icon at the same time,
        // request should only be fired once.
        var inProgress = this._inProgressFetches.get(type);
        if (!inProgress) {
            var _a = __read(getNameAndNamespace(type), 2), name_1 = _a[0], namespace = _a[1];
            // If the string has a namespace within, create a simple `IconDefinition`.
            var icon_1 = namespace
                ? { name: type, icon: '' }
                : getIconDefinitionFromAbbr(name_1);
            var suffix = this._enableJsonpLoading ? '.js' : '.svg';
            var url = (namespace
                ? this._assetsUrlRoot + "assets/" + namespace + "/" + name_1
                : this._assetsUrlRoot + "assets/" + icon_1.theme + "/" + icon_1.name) + suffix;
            var safeUrl = this.sanitizer.sanitize(SecurityContext.URL, url);
            if (!safeUrl) {
                throw UrlNotSafeError(url);
            }
            var source = !this._enableJsonpLoading
                ? this._http
                    .get(safeUrl, { responseType: 'text' })
                    .pipe(map(function (literal) { return (__assign(__assign({}, icon_1), { icon: literal })); }))
                : this._loadIconDynamicallyWithJsonp(icon_1, safeUrl);
            inProgress = source.pipe(tap(function (definition) { return _this.addIcon(definition); }), finalize(function () { return _this._inProgressFetches.delete(type); }), catchError(function () { return rxof(null); }), share());
            this._inProgressFetches.set(type, inProgress);
        }
        return inProgress;
    };
    IconService.prototype._loadIconDynamicallyWithJsonp = function (icon, url) {
        var _this = this;
        return new Observable(function (subscriber) {
            var loader = _this._document.createElement('script');
            var timer = setTimeout(function () {
                clean();
                subscriber.error(DynamicLoadingTimeoutError());
            }, 6000);
            loader.src = url;
            function clean() {
                loader.parentNode.removeChild(loader);
                clearTimeout(timer);
            }
            _this._document.body.appendChild(loader);
            _this._jsonpIconLoad$
                .pipe(filter(function (i) { return i.name === icon.name && i.theme === icon.theme; }), take(1))
                .subscribe(function (i) {
                subscriber.next(i);
                clean();
            });
        });
    };
    /**
     * Render a new `SVGElement` for a given `IconDefinition`, or make a copy from cache.
     * @param icon
     * @param twoToneColor
     */
    IconService.prototype._loadSVGFromCacheOrCreateNew = function (icon, twoToneColor) {
        var svg;
        var pri = twoToneColor || this._twoToneColorPalette.primaryColor;
        var sec = getSecondaryColor(pri) || this._twoToneColorPalette.secondaryColor;
        var key = icon.theme === 'twotone'
            ? withSuffixAndColor(icon.name, icon.theme, pri, sec)
            : icon.theme === undefined
                ? icon.name
                : withSuffix(icon.name, icon.theme);
        // Try to make a copy from cache.
        var cached = this._svgRenderedDefinitions.get(key);
        if (cached) {
            svg = cached.icon;
        }
        else {
            svg = this._setSVGAttribute(this._colorizeSVGIcon(
            // Icons provided by ant design should be refined to remove preset colors.
            this._createSVGElementFromString(hasNamespace(icon.name) ? icon.icon : replaceFillColor(icon.icon)), icon.theme === 'twotone', pri, sec));
            // Cache it.
            this._svgRenderedDefinitions.set(key, __assign(__assign({}, icon), { icon: svg }));
        }
        return cloneSVG(svg);
    };
    IconService.prototype._createSVGElementFromString = function (str) {
        var div = this._document.createElement('div');
        div.innerHTML = str;
        var svg = div.querySelector('svg');
        if (!svg) {
            throw SVGTagNotFoundError;
        }
        return svg;
    };
    IconService.prototype._setSVGAttribute = function (svg) {
        this._renderer.setAttribute(svg, 'width', '1em');
        this._renderer.setAttribute(svg, 'height', '1em');
        return svg;
    };
    IconService.prototype._colorizeSVGIcon = function (svg, twotone, pri, sec) {
        if (twotone) {
            var children = svg.childNodes;
            var length_1 = children.length;
            for (var i = 0; i < length_1; i++) {
                var child = children[i];
                if (child.getAttribute('fill') === 'secondaryColor') {
                    this._renderer.setAttribute(child, 'fill', sec);
                }
                else {
                    this._renderer.setAttribute(child, 'fill', pri);
                }
            }
        }
        this._renderer.setAttribute(svg, 'fill', 'currentColor');
        return svg;
    };
    IconService.ctorParameters = function () { return [
        { type: RendererFactory2 },
        { type: HttpBackend, decorators: [{ type: Optional }] },
        { type: undefined, decorators: [{ type: Optional }, { type: Inject, args: [DOCUMENT,] }] },
        { type: DomSanitizer }
    ]; };
    IconService = __decorate([ __param(1, Optional()),
        __param(2, Optional()), __param(2, Inject(DOCUMENT))
    ], IconService);
IconService.ɵfac = function IconService_Factory(t) { return new (t || IconService)(ɵngcc0.ɵɵinject(ɵngcc0.RendererFactory2), ɵngcc0.ɵɵinject(ɵngcc1.HttpBackend, 8), ɵngcc0.ɵɵinject(DOCUMENT, 8), ɵngcc0.ɵɵinject(ɵngcc2.DomSanitizer)); };
IconService.ɵprov = ɵngcc0.ɵɵdefineInjectable({ token: IconService, factory: function (t) { return IconService.ɵfac(t); } });
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(IconService, [{
        type: Injectable
    }], function () { return [{ type: ɵngcc0.RendererFactory2 }, { type: ɵngcc1.HttpBackend, decorators: [{
                type: Optional
            }] }, { type: undefined, decorators: [{
                type: Optional
            }, {
                type: Inject,
                args: [DOCUMENT]
            }] }, { type: ɵngcc2.DomSanitizer }]; }, null); })();
    return IconService;
}());
export { IconService };

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaWNvbi5zZXJ2aWNlLmpzIiwic291cmNlcyI6WyJAYW50LWRlc2lnbi9pY29ucy1hbmd1bGFyL2NvbXBvbmVudC9pY29uLnNlcnZpY2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLE9BQU8sRUFBRSxRQUFRLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQztBQUMzQyxPQUFPLEVBQUUsV0FBVyxFQUFFLFVBQVUsRUFBRSxNQUFNLHNCQUFzQixDQUFDO0FBQy9ELE9BQU8sRUFBRSxNQUFNLEVBQUUsVUFBVSxFQUFFLFFBQVEsRUFBRSxTQUFTLEVBQUUsZ0JBQWdCLEVBQUUsZUFBZSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQzNHLE9BQU8sRUFBRSxZQUFZLEVBQUUsTUFBTSwyQkFBMkIsQ0FBQztBQUN6RCxPQUFPLEVBQUUsRUFBRSxJQUFJLElBQUksRUFBRSxVQUFVLEVBQUUsT0FBTyxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBQ3ZELE9BQU8sRUFDTCxVQUFVLEVBQ1YsTUFBTSxFQUNOLFFBQVEsRUFDUixHQUFHLEVBQ0gsS0FBSyxFQUNMLElBQUksRUFDSixHQUFHLEVBQ0osTUFBTSxnQkFBZ0IsQ0FBQztBQVF4QixPQUFPLEVBQ0wsUUFBUSxFQUNSLHlCQUF5QixFQUN6QixtQkFBbUIsRUFDbkIsaUJBQWlCLEVBQ2pCLFlBQVksRUFDWixnQkFBZ0IsRUFDaEIsZ0JBQWdCLEVBQ2hCLElBQUksRUFDSixVQUFVLEVBQ1Ysa0JBQWtCLEVBQ25CLE1BQU0sVUFBVSxDQUFDO0FBQ2xCLE9BQU8sRUFDTCwwQkFBMEIsRUFDMUIsbUJBQW1CLEVBQ25CLGlCQUFpQixFQUNqQiwwQkFBMEIsRUFDMUIsbUJBQW1CLEVBQ25CLGVBQWUsRUFDaEIsTUFBTSxjQUFjLENBQUM7Ozs7QUFFdEIsSUFBTSxrQkFBa0IsR0FBRyxpQkFBaUIsQ0FBQztBQUc3QztBQUNvQixJQWlEbEIscUJBQ1ksZ0JBQWtDLEVBQ3RCLFFBQXFCO0FBQzlDLElBQUcsa0NBQWtDO0FBQ3RDLElBQTRD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QUksS0FBSyxDQUFDLFlBQVksQ0FBQyxNQUFNLENBQUMsS0FBSyxnQkFBZ0IsRUFBRTtBQUM3RCxvQkFBVSxJQUFJLENBQUMsU0FBUyxDQUFDLFlBQVksQ0FBQyxLQUFLLEVBQUUsTUFBTSxFQUFFLEdBQUcsQ0FBQyxDQUFDO0FBQzFELGlCQUFTO0FBQUMscUJBQUs7QUFDZixvQkFBVSxJQUFJLENBQUMsU0FBUyxDQUFDLFlBQVksQ0FBQyxLQUFLLEVBQUUsTUFBTSxFQUFFLEdBQUcsQ0FBQyxDQUFDO0FBQzFELGlCQUFTO0FBQ1QsYUFBTztBQUNQLFNBQUs7QUFDTCxRQUFJLElBQUksQ0FBQyxTQUFTLENBQUMsWUFBWSxDQUFDLEdBQUcsRUFBRSxNQUFNLEVBQUUsY0FBYyxDQUFDLENBQUM7QUFDN0QsUUFBSSxPQUFPLEdBQUcsQ0FBQztBQUNmLElBQUUsQ0FBQztBQUNGO0FBQ3NELGdCQTlRdkIsZ0JBQWdCO0FBQzlDLGdCQUFrQyxXQUFXLHVCQUExQyxRQUFRO0FBQU8sZ0RBRWYsUUFBUSxZQUFJLE1BQU0sU0FBQyxRQUFRO0FBQVMsZ0JBQ2hCLFlBQVk7QUFDbkM7QUFDSSxJQXpETyxXQUFXLHdCQUR2QixVQUFVLEVBQUUsckJBQ0wsQ0FvREgsV0FBQSxRQUFRLEVBQUUsQ0FBQTtBQUFFLFFBRVosV0FBQSxRQUFRLEVBQUUsQ0FBQSxFQUFFLFdBQUEsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFBO0FBQUMsT0F0RHJCLFdBQVcsQ0FnVXZCOzs7Ozs7Ozs7Ozs7aUVBQ0Q7QUFBQyxJQURELGtCQUFDO0FBQ0EsQ0FEQSxBQWhVRCxJQWdVQztBQUNELFNBalVhLFdBQVc7QUFDdkIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBET0NVTUVOVCB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbic7XG5pbXBvcnQgeyBIdHRwQmFja2VuZCwgSHR0cENsaWVudCB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbi9odHRwJztcbmltcG9ydCB7IEluamVjdCwgSW5qZWN0YWJsZSwgT3B0aW9uYWwsIFJlbmRlcmVyMiwgUmVuZGVyZXJGYWN0b3J5MiwgU2VjdXJpdHlDb250ZXh0IH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBEb21TYW5pdGl6ZXIgfSBmcm9tICdAYW5ndWxhci9wbGF0Zm9ybS1icm93c2VyJztcbmltcG9ydCB7IG9mIGFzIHJ4b2YsIE9ic2VydmFibGUsIFN1YmplY3QgfSBmcm9tICdyeGpzJztcbmltcG9ydCB7XG4gIGNhdGNoRXJyb3IsXG4gIGZpbHRlcixcbiAgZmluYWxpemUsXG4gIG1hcCxcbiAgc2hhcmUsXG4gIHRha2UsXG4gIHRhcFxufSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XG5pbXBvcnQge1xuICBDYWNoZWRJY29uRGVmaW5pdGlvbixcbiAgSWNvbkRlZmluaXRpb24sXG4gIFRoZW1lVHlwZSxcbiAgVHdvVG9uZUNvbG9yUGFsZXR0ZSxcbiAgVHdvVG9uZUNvbG9yUGFsZXR0ZVNldHRlclxufSBmcm9tICcuLi90eXBlcyc7XG5pbXBvcnQge1xuICBjbG9uZVNWRyxcbiAgZ2V0SWNvbkRlZmluaXRpb25Gcm9tQWJicixcbiAgZ2V0TmFtZUFuZE5hbWVzcGFjZSxcbiAgZ2V0U2Vjb25kYXJ5Q29sb3IsXG4gIGhhc05hbWVzcGFjZSxcbiAgaXNJY29uRGVmaW5pdGlvbixcbiAgcmVwbGFjZUZpbGxDb2xvcixcbiAgd2FybixcbiAgd2l0aFN1ZmZpeCxcbiAgd2l0aFN1ZmZpeEFuZENvbG9yXG59IGZyb20gJy4uL3V0aWxzJztcbmltcG9ydCB7XG4gIER5bmFtaWNMb2FkaW5nVGltZW91dEVycm9yLFxuICBIdHRwTW9kdWxlTm90SW1wb3J0LFxuICBJY29uTm90Rm91bmRFcnJvcixcbiAgTmFtZVNwYWNlSXNOb3RTcGVjaWZ5RXJyb3IsXG4gIFNWR1RhZ05vdEZvdW5kRXJyb3IsXG4gIFVybE5vdFNhZmVFcnJvclxufSBmcm9tICcuL2ljb24uZXJyb3InO1xuXG5jb25zdCBKU09OUF9IQU5ETEVSX05BTUUgPSAnX19hbnRfaWNvbl9sb2FkJztcblxuQEluamVjdGFibGUoKVxuZXhwb3J0IGNsYXNzIEljb25TZXJ2aWNlIHtcbiAgZGVmYXVsdFRoZW1lOiBUaGVtZVR5cGUgPSAnb3V0bGluZSc7XG5cbiAgc2V0IHR3b1RvbmVDb2xvcih7XG4gICAgcHJpbWFyeUNvbG9yLFxuICAgIHNlY29uZGFyeUNvbG9yXG4gIH06IFR3b1RvbmVDb2xvclBhbGV0dGVTZXR0ZXIpIHtcbiAgICB0aGlzLl90d29Ub25lQ29sb3JQYWxldHRlLnByaW1hcnlDb2xvciA9IHByaW1hcnlDb2xvcjtcbiAgICB0aGlzLl90d29Ub25lQ29sb3JQYWxldHRlLnNlY29uZGFyeUNvbG9yID1cbiAgICAgIHNlY29uZGFyeUNvbG9yIHx8IGdldFNlY29uZGFyeUNvbG9yKHByaW1hcnlDb2xvcik7XG4gIH1cblxuICBnZXQgdHdvVG9uZUNvbG9yKCk6IFR3b1RvbmVDb2xvclBhbGV0dGVTZXR0ZXIge1xuICAgIC8vIE1ha2UgYSBjb3B5IHRvIGF2b2lkIHVuZXhwZWN0ZWQgY2hhbmdlcy5cbiAgICByZXR1cm4geyAuLi50aGlzLl90d29Ub25lQ29sb3JQYWxldHRlIH0gYXMgVHdvVG9uZUNvbG9yUGFsZXR0ZTtcbiAgfVxuXG4gIHByb3RlY3RlZCBfcmVuZGVyZXI6IFJlbmRlcmVyMjtcbiAgcHJvdGVjdGVkIF9odHRwOiBIdHRwQ2xpZW50O1xuXG4gIC8qKlxuICAgKiBBbGwgaWNvbiBkZWZpbml0aW9ucyB3b3VsZCBiZSByZWdpc3RlcmVkIGhlcmUuXG4gICAqL1xuICBwcm90ZWN0ZWQgcmVhZG9ubHkgX3N2Z0RlZmluaXRpb25zID0gbmV3IE1hcDxzdHJpbmcsIEljb25EZWZpbml0aW9uPigpO1xuXG4gIC8qKlxuICAgKiBDYWNoZSBhbGwgcmVuZGVyZWQgaWNvbnMuIEljb25zIGFyZSBpZGVudGlmaWVkIGJ5IG5hbWUsIHRoZW1lLFxuICAgKiBhbmQgZm9yIHR3b3RvbmUgaWNvbnMsIHByaW1hcnkgY29sb3IgYW5kIHNlY29uZGFyeSBjb2xvci5cbiAgICovXG4gIHByb3RlY3RlZCByZWFkb25seSBfc3ZnUmVuZGVyZWREZWZpbml0aW9ucyA9IG5ldyBNYXA8c3RyaW5nLCBDYWNoZWRJY29uRGVmaW5pdGlvbj4oKTtcblxuICBwcm90ZWN0ZWQgX2luUHJvZ3Jlc3NGZXRjaGVzID0gbmV3IE1hcDxcbiAgICBzdHJpbmcsXG4gICAgT2JzZXJ2YWJsZTxJY29uRGVmaW5pdGlvbiB8IG51bGw+XG4gID4oKTtcblxuICAvKipcbiAgICogVXJsIHByZWZpeCBmb3IgZmV0Y2hpbmcgaW5saW5lIFNWRyBieSBkeW5hbWljIGltcG9ydGluZy5cbiAgICovXG4gIHByb3RlY3RlZCBfYXNzZXRzVXJsUm9vdCA9ICcnO1xuXG4gIHByb3RlY3RlZCBfdHdvVG9uZUNvbG9yUGFsZXR0ZTogVHdvVG9uZUNvbG9yUGFsZXR0ZSA9IHtcbiAgICBwcmltYXJ5Q29sb3I6ICcjMzMzMzMzJyxcbiAgICBzZWNvbmRhcnlDb2xvcjogJyNFNkU2RTYnXG4gIH07XG5cbiAgLyoqIEEgZmxhZyBpbmRpY2F0ZXMgd2hldGhlciBqc29ucCBsb2FkaW5nIGlzIGVuYWJsZWQuICovXG4gIHByaXZhdGUgX2VuYWJsZUpzb25wTG9hZGluZyA9IGZhbHNlO1xuICBwcml2YXRlIHJlYWRvbmx5IF9qc29ucEljb25Mb2FkJCA9IG5ldyBTdWJqZWN0PEljb25EZWZpbml0aW9uPigpO1xuXG4gIGNvbnN0cnVjdG9yKFxuICAgIHByb3RlY3RlZCBfcmVuZGVyZXJGYWN0b3J5OiBSZW5kZXJlckZhY3RvcnkyLFxuICAgIEBPcHRpb25hbCgpIHByb3RlY3RlZCBfaGFuZGxlcjogSHR0cEJhY2tlbmQsXG4gICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm5vLWFueVxuICAgIEBPcHRpb25hbCgpIEBJbmplY3QoRE9DVU1FTlQpIHByb3RlY3RlZCBfZG9jdW1lbnQ6IGFueSxcbiAgICBwcm90ZWN0ZWQgc2FuaXRpemVyOiBEb21TYW5pdGl6ZXJcbiAgKSB7XG4gICAgdGhpcy5fcmVuZGVyZXIgPSB0aGlzLl9yZW5kZXJlckZhY3RvcnkuY3JlYXRlUmVuZGVyZXIobnVsbCwgbnVsbCk7XG4gICAgaWYgKHRoaXMuX2hhbmRsZXIpIHtcbiAgICAgIHRoaXMuX2h0dHAgPSBuZXcgSHR0cENsaWVudCh0aGlzLl9oYW5kbGVyKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQ2FsbCB0aGlzIG1ldGhvZCB0byBzd2l0Y2ggdG8ganNvbnAgbGlrZSBsb2FkaW5nLlxuICAgKi9cbiAgdXNlSnNvbnBMb2FkaW5nKCk6IHZvaWQge1xuICAgIGlmICghdGhpcy5fZW5hYmxlSnNvbnBMb2FkaW5nKSB7XG4gICAgICB0aGlzLl9lbmFibGVKc29ucExvYWRpbmcgPSB0cnVlO1xuXG4gICAgICB3aW5kb3dbSlNPTlBfSEFORExFUl9OQU1FXSA9IChpY29uOiBJY29uRGVmaW5pdGlvbikgPT4ge1xuICAgICAgICB0aGlzLl9qc29ucEljb25Mb2FkJC5uZXh0KGljb24pO1xuICAgICAgfTtcbiAgICB9IGVsc2Uge1xuICAgICAgd2FybignWW91IGFyZSBhbHJlYWR5IHVzaW5nIGpzb25wIGxvYWRpbmcuJyk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIENoYW5nZSB0aGUgcHJlZml4IG9mIHRoZSBpbmxpbmUgc3ZnIHJlc291cmNlcywgc28gdGhleSBjb3VsZCBiZSBkZXBsb3llZCBlbHNld2hlcmUsIGxpa2UgQ0ROLlxuICAgKiBAcGFyYW0gcHJlZml4XG4gICAqL1xuICBjaGFuZ2VBc3NldHNTb3VyY2UocHJlZml4OiBzdHJpbmcpOiB2b2lkIHtcbiAgICB0aGlzLl9hc3NldHNVcmxSb290ID0gcHJlZml4LmVuZHNXaXRoKCcvJykgPyBwcmVmaXggOiBwcmVmaXggKyAnLyc7XG4gIH1cblxuICAvKipcbiAgICogQWRkIGljb25zIHByb3ZpZGVkIGJ5IGFudCBkZXNpZ24uXG4gICAqIEBwYXJhbSBpY29uc1xuICAgKi9cbiAgYWRkSWNvbiguLi5pY29uczogSWNvbkRlZmluaXRpb25bXSk6IHZvaWQge1xuICAgIGljb25zLmZvckVhY2goaWNvbiA9PiB7XG4gICAgICB0aGlzLl9zdmdEZWZpbml0aW9ucy5zZXQod2l0aFN1ZmZpeChpY29uLm5hbWUsIGljb24udGhlbWUpLCBpY29uKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZWdpc3RlciBhbiBpY29uLiBOYW1lc3BhY2UgaXMgcmVxdWlyZWQuXG4gICAqIEBwYXJhbSB0eXBlXG4gICAqIEBwYXJhbSBsaXRlcmFsXG4gICAqL1xuICBhZGRJY29uTGl0ZXJhbCh0eXBlOiBzdHJpbmcsIGxpdGVyYWw6IHN0cmluZyk6IHZvaWQge1xuICAgIGNvbnN0IFtfLCBuYW1lc3BhY2VdID0gZ2V0TmFtZUFuZE5hbWVzcGFjZSh0eXBlKTtcbiAgICBpZiAoIW5hbWVzcGFjZSkge1xuICAgICAgdGhyb3cgTmFtZVNwYWNlSXNOb3RTcGVjaWZ5RXJyb3IoKTtcbiAgICB9XG4gICAgdGhpcy5hZGRJY29uKHsgbmFtZTogdHlwZSwgaWNvbjogbGl0ZXJhbCB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZW1vdmUgYWxsIGNhY2hlLlxuICAgKi9cbiAgY2xlYXIoKTogdm9pZCB7XG4gICAgdGhpcy5fc3ZnRGVmaW5pdGlvbnMuY2xlYXIoKTtcbiAgICB0aGlzLl9zdmdSZW5kZXJlZERlZmluaXRpb25zLmNsZWFyKCk7XG4gIH1cblxuICAvKipcbiAgICogR2V0IGEgcmVuZGVyZWQgYFNWR0VsZW1lbnRgLlxuICAgKiBAcGFyYW0gaWNvblxuICAgKiBAcGFyYW0gdHdvVG9uZUNvbG9yXG4gICAqL1xuICBnZXRSZW5kZXJlZENvbnRlbnQoXG4gICAgaWNvbjogSWNvbkRlZmluaXRpb24gfCBzdHJpbmcsXG4gICAgdHdvVG9uZUNvbG9yPzogc3RyaW5nXG4gICk6IE9ic2VydmFibGU8U1ZHRWxlbWVudD4ge1xuICAgIC8vIElmIGBpY29uYCBpcyBhIGBJY29uRGVmaW5pdGlvbmAsIGdvIHRvIHRoZSBuZXh0IHN0ZXAuIElmIG5vdCwgdHJ5IHRvIGZldGNoIGl0IGZyb20gY2FjaGUuXG4gICAgY29uc3QgZGVmaW5pdGlvbk9yTnVsbDogSWNvbkRlZmluaXRpb24gfCBudWxsID0gaXNJY29uRGVmaW5pdGlvbihpY29uKVxuICAgICAgPyAoaWNvbiBhcyBJY29uRGVmaW5pdGlvbilcbiAgICAgIDogdGhpcy5fc3ZnRGVmaW5pdGlvbnMuZ2V0KGljb24pIHx8IG51bGw7XG5cbiAgICAvLyBJZiBgaWNvbmAgaXMgYSBgSWNvbkRlZmluaXRpb25gIG9mIHN1Y2Nlc3NmdWxseSBmZXRjaCwgd3JhcCBpdCBpbiBhbiBgT2JzZXJ2YWJsZWAuXG4gICAgLy8gT3RoZXJ3aXNlIHRyeSB0byBmZXRjaCBpdCBmcm9tIHJlbW90ZS5cbiAgICBjb25zdCAkaWNvbkRlZmluaXRpb24gPSBkZWZpbml0aW9uT3JOdWxsXG4gICAgICA/IHJ4b2YoZGVmaW5pdGlvbk9yTnVsbClcbiAgICAgIDogdGhpcy5fbG9hZEljb25EeW5hbWljYWxseShpY29uIGFzIHN0cmluZyk7XG5cbiAgICAvLyBJZiBmaW5hbGx5IGdldCBhbiBgSWNvbkRlZmluaXRpb25gLCByZW5kZXIgYW5kIHJldHVybiBpdC4gT3RoZXJ3aXNlIHRocm93IGFuIGVycm9yLlxuICAgIHJldHVybiAkaWNvbkRlZmluaXRpb24ucGlwZShcbiAgICAgIG1hcChpID0+IHtcbiAgICAgICAgaWYgKCFpKSB7XG4gICAgICAgICAgdGhyb3cgSWNvbk5vdEZvdW5kRXJyb3IoaWNvbiBhcyBzdHJpbmcpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLl9sb2FkU1ZHRnJvbUNhY2hlT3JDcmVhdGVOZXcoaSwgdHdvVG9uZUNvbG9yKTtcbiAgICAgIH0pXG4gICAgKTtcbiAgfVxuXG4gIGdldENhY2hlZEljb25zKCk6IE1hcDxzdHJpbmcsIEljb25EZWZpbml0aW9uPiB7XG4gICAgcmV0dXJuIHRoaXMuX3N2Z0RlZmluaXRpb25zO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCByYXcgc3ZnIGFuZCBhc3NlbWJsZSBhIGBJY29uRGVmaW5pdGlvbmAgb2JqZWN0LlxuICAgKiBAcGFyYW0gdHlwZVxuICAgKi9cbiAgcHJvdGVjdGVkIF9sb2FkSWNvbkR5bmFtaWNhbGx5KFxuICAgIHR5cGU6IHN0cmluZ1xuICApOiBPYnNlcnZhYmxlPEljb25EZWZpbml0aW9uIHwgbnVsbD4ge1xuICAgIC8vIElmIGRldmVsb3BlciBkb2Vzbid0IHByb3ZpZGUgSFRUUCBtb2R1bGUgbm9yIGVuYWJsZSBqc29ucCBsb2FkaW5nLCBqdXN0IHRocm93IGFuIGVycm9yLlxuICAgIGlmICghdGhpcy5faHR0cCAmJiAhdGhpcy5fZW5hYmxlSnNvbnBMb2FkaW5nKSB7XG4gICAgICByZXR1cm4gcnhvZihIdHRwTW9kdWxlTm90SW1wb3J0KCkpO1xuICAgIH1cblxuICAgIC8vIElmIG11bHRpIGRpcmVjdGl2ZSBhc2sgZm9yIHRoZSBzYW1lIGljb24gYXQgdGhlIHNhbWUgdGltZSxcbiAgICAvLyByZXF1ZXN0IHNob3VsZCBvbmx5IGJlIGZpcmVkIG9uY2UuXG4gICAgbGV0IGluUHJvZ3Jlc3MgPSB0aGlzLl9pblByb2dyZXNzRmV0Y2hlcy5nZXQodHlwZSk7XG5cbiAgICBpZiAoIWluUHJvZ3Jlc3MpIHtcbiAgICAgIGNvbnN0IFtuYW1lLCBuYW1lc3BhY2VdID0gZ2V0TmFtZUFuZE5hbWVzcGFjZSh0eXBlKTtcblxuICAgICAgLy8gSWYgdGhlIHN0cmluZyBoYXMgYSBuYW1lc3BhY2Ugd2l0aGluLCBjcmVhdGUgYSBzaW1wbGUgYEljb25EZWZpbml0aW9uYC5cbiAgICAgIGNvbnN0IGljb246IEljb25EZWZpbml0aW9uID0gbmFtZXNwYWNlXG4gICAgICAgID8geyBuYW1lOiB0eXBlLCBpY29uOiAnJyB9XG4gICAgICAgIDogZ2V0SWNvbkRlZmluaXRpb25Gcm9tQWJicihuYW1lKTtcblxuICAgICAgY29uc3Qgc3VmZml4ID0gdGhpcy5fZW5hYmxlSnNvbnBMb2FkaW5nID8gJy5qcycgOiAnLnN2Zyc7XG4gICAgICBjb25zdCB1cmwgPVxuICAgICAgICAobmFtZXNwYWNlXG4gICAgICAgICAgPyBgJHt0aGlzLl9hc3NldHNVcmxSb290fWFzc2V0cy8ke25hbWVzcGFjZX0vJHtuYW1lfWBcbiAgICAgICAgICA6IGAke3RoaXMuX2Fzc2V0c1VybFJvb3R9YXNzZXRzLyR7aWNvbi50aGVtZX0vJHtpY29uLm5hbWV9YCkgKyBzdWZmaXg7XG5cbiAgICAgIGNvbnN0IHNhZmVVcmwgPSB0aGlzLnNhbml0aXplci5zYW5pdGl6ZShTZWN1cml0eUNvbnRleHQuVVJMLCB1cmwpO1xuXG4gICAgICBpZiAoIXNhZmVVcmwpIHtcbiAgICAgICAgdGhyb3cgVXJsTm90U2FmZUVycm9yKHVybCk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHNvdXJjZSA9ICF0aGlzLl9lbmFibGVKc29ucExvYWRpbmdcbiAgICAgICAgPyB0aGlzLl9odHRwXG4gICAgICAgICAgICAuZ2V0KHNhZmVVcmwsIHsgcmVzcG9uc2VUeXBlOiAndGV4dCcgfSlcbiAgICAgICAgICAgIC5waXBlKG1hcChsaXRlcmFsID0+ICh7IC4uLmljb24sIGljb246IGxpdGVyYWwgfSkpKVxuICAgICAgICA6IHRoaXMuX2xvYWRJY29uRHluYW1pY2FsbHlXaXRoSnNvbnAoaWNvbiwgc2FmZVVybCk7XG5cbiAgICAgIGluUHJvZ3Jlc3MgPSBzb3VyY2UucGlwZShcbiAgICAgICAgdGFwKGRlZmluaXRpb24gPT4gdGhpcy5hZGRJY29uKGRlZmluaXRpb24pKSxcbiAgICAgICAgZmluYWxpemUoKCkgPT4gdGhpcy5faW5Qcm9ncmVzc0ZldGNoZXMuZGVsZXRlKHR5cGUpKSxcbiAgICAgICAgY2F0Y2hFcnJvcigoKSA9PiByeG9mKG51bGwpKSxcbiAgICAgICAgc2hhcmUoKVxuICAgICAgKTtcblxuICAgICAgdGhpcy5faW5Qcm9ncmVzc0ZldGNoZXMuc2V0KHR5cGUsIGluUHJvZ3Jlc3MpO1xuICAgIH1cblxuICAgIHJldHVybiBpblByb2dyZXNzO1xuICB9XG5cbiAgcHJvdGVjdGVkIF9sb2FkSWNvbkR5bmFtaWNhbGx5V2l0aEpzb25wKGljb246IEljb25EZWZpbml0aW9uLCB1cmw6IHN0cmluZyk6IE9ic2VydmFibGU8SWNvbkRlZmluaXRpb24+IHtcbiAgICByZXR1cm4gbmV3IE9ic2VydmFibGU8SWNvbkRlZmluaXRpb24+KHN1YnNjcmliZXIgPT4ge1xuICAgICAgY29uc3QgbG9hZGVyID0gdGhpcy5fZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc2NyaXB0Jyk7XG4gICAgICBjb25zdCB0aW1lciA9IHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICBjbGVhbigpO1xuICAgICAgICBzdWJzY3JpYmVyLmVycm9yKER5bmFtaWNMb2FkaW5nVGltZW91dEVycm9yKCkpO1xuICAgICAgfSwgNjAwMCk7XG5cbiAgICAgIGxvYWRlci5zcmMgPSB1cmw7XG5cbiAgICAgIGZ1bmN0aW9uIGNsZWFuKCk6IHZvaWQge1xuICAgICAgICBsb2FkZXIucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChsb2FkZXIpO1xuICAgICAgICBjbGVhclRpbWVvdXQodGltZXIpO1xuICAgICAgfVxuXG4gICAgICB0aGlzLl9kb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGxvYWRlcik7XG4gICAgICB0aGlzLl9qc29ucEljb25Mb2FkJFxuICAgICAgICAgIC5waXBlKFxuICAgICAgICAgICAgICBmaWx0ZXIoaSA9PiBpLm5hbWUgPT09IGljb24ubmFtZSAmJiBpLnRoZW1lID09PSBpY29uLnRoZW1lKSxcbiAgICAgICAgICAgICAgdGFrZSgxKVxuICAgICAgICAgIClcbiAgICAgICAgICAuc3Vic2NyaWJlKGkgPT4ge1xuICAgICAgICAgICAgc3Vic2NyaWJlci5uZXh0KGkpO1xuICAgICAgICAgICAgY2xlYW4oKTtcbiAgICAgICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZW5kZXIgYSBuZXcgYFNWR0VsZW1lbnRgIGZvciBhIGdpdmVuIGBJY29uRGVmaW5pdGlvbmAsIG9yIG1ha2UgYSBjb3B5IGZyb20gY2FjaGUuXG4gICAqIEBwYXJhbSBpY29uXG4gICAqIEBwYXJhbSB0d29Ub25lQ29sb3JcbiAgICovXG4gIHByb3RlY3RlZCBfbG9hZFNWR0Zyb21DYWNoZU9yQ3JlYXRlTmV3KFxuICAgIGljb246IEljb25EZWZpbml0aW9uLFxuICAgIHR3b1RvbmVDb2xvcj86IHN0cmluZ1xuICApOiBTVkdFbGVtZW50IHtcbiAgICBsZXQgc3ZnOiBTVkdFbGVtZW50O1xuXG4gICAgY29uc3QgcHJpID0gdHdvVG9uZUNvbG9yIHx8IHRoaXMuX3R3b1RvbmVDb2xvclBhbGV0dGUucHJpbWFyeUNvbG9yO1xuICAgIGNvbnN0IHNlYyA9XG4gICAgICBnZXRTZWNvbmRhcnlDb2xvcihwcmkpIHx8IHRoaXMuX3R3b1RvbmVDb2xvclBhbGV0dGUuc2Vjb25kYXJ5Q29sb3I7XG4gICAgY29uc3Qga2V5ID1cbiAgICAgIGljb24udGhlbWUgPT09ICd0d290b25lJ1xuICAgICAgICA/IHdpdGhTdWZmaXhBbmRDb2xvcihpY29uLm5hbWUsIGljb24udGhlbWUsIHByaSwgc2VjKVxuICAgICAgICA6IGljb24udGhlbWUgPT09IHVuZGVmaW5lZFxuICAgICAgICA/IGljb24ubmFtZVxuICAgICAgICA6IHdpdGhTdWZmaXgoaWNvbi5uYW1lLCBpY29uLnRoZW1lKTtcblxuICAgIC8vIFRyeSB0byBtYWtlIGEgY29weSBmcm9tIGNhY2hlLlxuICAgIGNvbnN0IGNhY2hlZCA9IHRoaXMuX3N2Z1JlbmRlcmVkRGVmaW5pdGlvbnMuZ2V0KGtleSk7XG5cbiAgICBpZiAoY2FjaGVkKSB7XG4gICAgICBzdmcgPSBjYWNoZWQuaWNvbjtcbiAgICB9IGVsc2Uge1xuICAgICAgc3ZnID0gdGhpcy5fc2V0U1ZHQXR0cmlidXRlKFxuICAgICAgICB0aGlzLl9jb2xvcml6ZVNWR0ljb24oXG4gICAgICAgICAgLy8gSWNvbnMgcHJvdmlkZWQgYnkgYW50IGRlc2lnbiBzaG91bGQgYmUgcmVmaW5lZCB0byByZW1vdmUgcHJlc2V0IGNvbG9ycy5cbiAgICAgICAgICB0aGlzLl9jcmVhdGVTVkdFbGVtZW50RnJvbVN0cmluZyhcbiAgICAgICAgICAgIGhhc05hbWVzcGFjZShpY29uLm5hbWUpID8gaWNvbi5pY29uIDogcmVwbGFjZUZpbGxDb2xvcihpY29uLmljb24pXG4gICAgICAgICAgKSxcbiAgICAgICAgICBpY29uLnRoZW1lID09PSAndHdvdG9uZScsXG4gICAgICAgICAgcHJpLFxuICAgICAgICAgIHNlY1xuICAgICAgICApXG4gICAgICApO1xuICAgICAgLy8gQ2FjaGUgaXQuXG4gICAgICB0aGlzLl9zdmdSZW5kZXJlZERlZmluaXRpb25zLnNldChrZXksIHtcbiAgICAgICAgLi4uaWNvbixcbiAgICAgICAgaWNvbjogc3ZnXG4gICAgICB9IGFzIENhY2hlZEljb25EZWZpbml0aW9uKTtcbiAgICB9XG5cbiAgICByZXR1cm4gY2xvbmVTVkcoc3ZnKTtcbiAgfVxuXG4gIHByb3RlY3RlZCBfY3JlYXRlU1ZHRWxlbWVudEZyb21TdHJpbmcoc3RyOiBzdHJpbmcpOiBTVkdFbGVtZW50IHtcbiAgICBjb25zdCBkaXYgPSB0aGlzLl9kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBkaXYuaW5uZXJIVE1MID0gc3RyO1xuICAgIGNvbnN0IHN2ZzogU1ZHRWxlbWVudCA9IGRpdi5xdWVyeVNlbGVjdG9yKCdzdmcnKTtcbiAgICBpZiAoIXN2Zykge1xuICAgICAgdGhyb3cgU1ZHVGFnTm90Rm91bmRFcnJvcjtcbiAgICB9XG4gICAgcmV0dXJuIHN2ZztcbiAgfVxuXG4gIHByb3RlY3RlZCBfc2V0U1ZHQXR0cmlidXRlKHN2ZzogU1ZHRWxlbWVudCk6IFNWR0VsZW1lbnQge1xuICAgIHRoaXMuX3JlbmRlcmVyLnNldEF0dHJpYnV0ZShzdmcsICd3aWR0aCcsICcxZW0nKTtcbiAgICB0aGlzLl9yZW5kZXJlci5zZXRBdHRyaWJ1dGUoc3ZnLCAnaGVpZ2h0JywgJzFlbScpO1xuICAgIHJldHVybiBzdmc7XG4gIH1cblxuICBwcm90ZWN0ZWQgX2NvbG9yaXplU1ZHSWNvbihcbiAgICBzdmc6IFNWR0VsZW1lbnQsXG4gICAgdHdvdG9uZTogYm9vbGVhbixcbiAgICBwcmk6IHN0cmluZyxcbiAgICBzZWM6IHN0cmluZ1xuICApOiBTVkdFbGVtZW50IHtcbiAgICBpZiAodHdvdG9uZSkge1xuICAgICAgY29uc3QgY2hpbGRyZW4gPSBzdmcuY2hpbGROb2RlcztcbiAgICAgIGNvbnN0IGxlbmd0aCA9IGNoaWxkcmVuLmxlbmd0aDtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY29uc3QgY2hpbGQ6IEhUTUxFbGVtZW50ID0gY2hpbGRyZW5baV0gYXMgSFRNTEVsZW1lbnQ7XG4gICAgICAgIGlmIChjaGlsZC5nZXRBdHRyaWJ1dGUoJ2ZpbGwnKSA9PT0gJ3NlY29uZGFyeUNvbG9yJykge1xuICAgICAgICAgIHRoaXMuX3JlbmRlcmVyLnNldEF0dHJpYnV0ZShjaGlsZCwgJ2ZpbGwnLCBzZWMpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMuX3JlbmRlcmVyLnNldEF0dHJpYnV0ZShjaGlsZCwgJ2ZpbGwnLCBwcmkpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHRoaXMuX3JlbmRlcmVyLnNldEF0dHJpYnV0ZShzdmcsICdmaWxsJywgJ2N1cnJlbnRDb2xvcicpO1xuICAgIHJldHVybiBzdmc7XG4gIH1cbn1cbiJdfQ==