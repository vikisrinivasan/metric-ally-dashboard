{"version":3,"file":"ng-zorro-antd-core-outlet.js","sources":["ng-zorro-antd/core/outlet/string_template_outlet.directive.ts","ng-zorro-antd/core/outlet/outlet.module.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://github.com/NG-ZORRO/ng-zorro-antd/blob/master/LICENSE\n */\n\nimport { Directive, EmbeddedViewRef, Input, OnChanges, SimpleChange, SimpleChanges, TemplateRef, ViewContainerRef } from '@angular/core';\nimport { NzSafeAny } from 'ng-zorro-antd/core/types';\n\n@Directive({\n  selector: '[nzStringTemplateOutlet]',\n  exportAs: 'nzStringTemplateOutlet'\n})\nexport class NzStringTemplateOutletDirective<_T = unknown> implements OnChanges {\n  private embeddedViewRef: EmbeddedViewRef<NzSafeAny> | null = null;\n  private context = new NzStringTemplateOutletContext();\n  @Input() nzStringTemplateOutletContext: NzSafeAny | null = null;\n  @Input() nzStringTemplateOutlet: NzSafeAny | TemplateRef<NzSafeAny> = null;\n\n  static ngTemplateContextGuard<T>(_dir: NzStringTemplateOutletDirective<T>, _ctx: NzSafeAny): _ctx is NzStringTemplateOutletContext {\n    return true;\n  }\n\n  private recreateView(): void {\n    this.viewContainer.clear();\n    const isTemplateRef = this.nzStringTemplateOutlet instanceof TemplateRef;\n    const templateRef = (isTemplateRef ? this.nzStringTemplateOutlet : this.templateRef) as NzSafeAny;\n    this.embeddedViewRef = this.viewContainer.createEmbeddedView(\n      templateRef,\n      isTemplateRef ? this.nzStringTemplateOutletContext : this.context\n    );\n  }\n\n  private updateContext(): void {\n    const isTemplateRef = this.nzStringTemplateOutlet instanceof TemplateRef;\n    const newCtx = isTemplateRef ? this.nzStringTemplateOutletContext : this.context;\n    const oldCtx = this.embeddedViewRef!.context as NzSafeAny;\n    if (newCtx) {\n      for (const propName of Object.keys(newCtx)) {\n        oldCtx[propName] = newCtx[propName];\n      }\n    }\n  }\n\n  constructor(private viewContainer: ViewContainerRef, private templateRef: TemplateRef<NzSafeAny>) {}\n\n  ngOnChanges(changes: SimpleChanges): void {\n    const { nzStringTemplateOutletContext, nzStringTemplateOutlet } = changes;\n    const shouldRecreateView = (): boolean => {\n      let shouldOutletRecreate = false;\n      if (nzStringTemplateOutlet) {\n        if (nzStringTemplateOutlet.firstChange) {\n          shouldOutletRecreate = true;\n        } else {\n          const isPreviousOutletTemplate = nzStringTemplateOutlet.previousValue instanceof TemplateRef;\n          const isCurrentOutletTemplate = nzStringTemplateOutlet.currentValue instanceof TemplateRef;\n          shouldOutletRecreate = isPreviousOutletTemplate || isCurrentOutletTemplate;\n        }\n      }\n      const hasContextShapeChanged = (ctxChange: SimpleChange): boolean => {\n        const prevCtxKeys = Object.keys(ctxChange.previousValue || {});\n        const currCtxKeys = Object.keys(ctxChange.currentValue || {});\n        if (prevCtxKeys.length === currCtxKeys.length) {\n          for (const propName of currCtxKeys) {\n            if (prevCtxKeys.indexOf(propName) === -1) {\n              return true;\n            }\n          }\n          return false;\n        } else {\n          return true;\n        }\n      };\n      const shouldContextRecreate = nzStringTemplateOutletContext && hasContextShapeChanged(nzStringTemplateOutletContext);\n      return shouldContextRecreate || shouldOutletRecreate;\n    };\n\n    if (nzStringTemplateOutlet) {\n      this.context.$implicit = nzStringTemplateOutlet.currentValue;\n    }\n\n    const recreateView = shouldRecreateView();\n    if (recreateView) {\n      /** recreate view when context shape or outlet change **/\n      this.recreateView();\n    } else {\n      /** update context **/\n      this.updateContext();\n    }\n  }\n}\n\nexport class NzStringTemplateOutletContext {\n  public $implicit: NzSafeAny;\n}\n","/**\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://github.com/NG-ZORRO/ng-zorro-antd/blob/master/LICENSE\n */\n\nimport { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { NzStringTemplateOutletDirective } from './string_template_outlet.directive';\n\n@NgModule({\n  imports: [CommonModule],\n  exports: [NzStringTemplateOutletDirective],\n  declarations: [NzStringTemplateOutletDirective]\n})\nexport class NzOutletModule {}\n"]}